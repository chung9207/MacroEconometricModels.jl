<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hodrick-Prescott Filter (λ=1600.0)</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">Hodrick-Prescott Filter (λ=1600.0)</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">Trend-Cycle Decomposition</div>
<div id="filt_tc_61"></div>
</div>
<div class="panel">
<div class="panel-title">Cyclical Component</div>
<div id="filt_cy_62"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":1,"trend":4.038907380057364,"cycle":-0.011981928333923086,"orig":4.026925451723441,"zero":0},
{"x":2,"trend":4.0440233350454315,"cycle":-0.004002971553930479,"orig":4.040020363491501,"zero":0},
{"x":3,"trend":4.049131801328291,"cycle":-0.007664243040291119,"orig":4.041467558288,"zero":0},
{"x":4,"trend":4.054222788343514,"cycle":-0.006444115824378649,"orig":4.047778672519136,"zero":0},
{"x":5,"trend":4.059281515376773,"cycle":-0.005200076094967976,"orig":4.054081439281805,"zero":0},
{"x":6,"trend":4.064289174141348,"cycle":-0.005041705556709353,"orig":4.059247468584639,"zero":0},
{"x":7,"trend":4.069223706302961,"cycle":-0.0031791722443559323,"orig":4.066044534058605,"zero":0},
{"x":8,"trend":4.074059902461362,"cycle":-0.00053728686491894,"orig":4.073522615596443,"zero":0},
{"x":9,"trend":4.078770566233645,"cycle":-0.0013161766242957285,"orig":4.07745438960935,"zero":0},
{"x":10,"trend":4.083328165432619,"cycle":0.007359719285938482,"orig":4.090687884718557,"zero":0},
{"x":11,"trend":4.087704345260696,"cycle":0.00784948550138953,"orig":4.095553830762086,"zero":0},
{"x":12,"trend":4.091875350744847,"cycle":0.009271026596181287,"orig":4.101146377341029,"zero":0},
{"x":13,"trend":4.09582233284048,"cycle":0.005127036211491465,"orig":4.100949369051971,"zero":0},
{"x":14,"trend":4.099532236894624,"cycle":0.006416403497989442,"orig":4.105948640392613,"zero":0},
{"x":15,"trend":4.102995212651943,"cycle":0.005418250165616811,"orig":4.10841346281756,"zero":0},
{"x":16,"trend":4.106205420109285,"cycle":0.007992421720916632,"orig":4.114197841830202,"zero":0},
{"x":17,"trend":4.1091604056698525,"cycle":0.0030191630771616573,"orig":4.112179568747014,"zero":0},
{"x":18,"trend":4.111862711000424,"cycle":0.0032137851407574303,"orig":4.115076496141182,"zero":0},
{"x":19,"trend":4.114316764744701,"cycle":0.0009066428287392014,"orig":4.11522340757344,"zero":0},
{"x":20,"trend":4.116529004162098,"cycle":0.0036960826895793275,"orig":4.120225086851677,"zero":0},
{"x":21,"trend":4.118506433163798,"cycle":-0.001410979670994017,"orig":4.117095453492804,"zero":0},
{"x":22,"trend":4.1202583657126635,"cycle":0.0011386241707533884,"orig":4.121396989883417,"zero":0},
{"x":23,"trend":4.121793233909264,"cycle":0.0020195115618735215,"orig":4.123812745471137,"zero":0},
{"x":24,"trend":4.123120181494274,"cycle":0.005211873154940427,"orig":4.128332054649214,"zero":0},
{"x":25,"trend":4.124249614403096,"cycle":0.007027789378596161,"orig":4.131277403781692,"zero":0},
{"x":26,"trend":4.125195195991855,"cycle":0.00164721094790643,"orig":4.126842406939762,"zero":0},
{"x":27,"trend":4.125974981985037,"cycle":0.003365033384306493,"orig":4.129340015369343,"zero":0},
{"x":28,"trend":4.126608057613968,"cycle":0.0025822770337313727,"orig":4.129190334647699,"zero":0},
{"x":29,"trend":4.127115611255843,"cycle":-0.00362657209527395,"orig":4.123489039160569,"zero":0},
{"x":30,"trend":4.127520445211,"cycle":-0.004107492241552713,"orig":4.123412952969447,"zero":0},
{"x":31,"trend":4.12784309517222,"cycle":-0.014124101892027952,"orig":4.113718993280192,"zero":0},
{"x":32,"trend":4.12810152964963,"cycle":-0.0046319162002852465,"orig":4.123469613449345,"zero":0},
{"x":33,"trend":4.128304889589678,"cycle":-0.007974242729880565,"orig":4.120330646859798,"zero":0},
{"x":34,"trend":4.128459420991185,"cycle":-0.009477532259805521,"orig":4.11898188873138,"zero":0},
{"x":35,"trend":4.128566385951267,"cycle":-0.0062111447786721286,"orig":4.1223552411725946,"zero":0},
{"x":36,"trend":4.128621123109376,"cycle":-0.0007966536466721408,"orig":4.127824469462704,"zero":0},
{"x":37,"trend":4.12861508913948,"cycle":-0.005861252443700948,"orig":4.122753836695779,"zero":0},
{"x":38,"trend":4.1285392428070145,"cycle":0.003255234861923917,"orig":4.131794477668938,"zero":0},
{"x":39,"trend":4.12838087959464,"cycle":0.008382801066047385,"orig":4.136763680660687,"zero":0},
{"x":40,"trend":4.128129329506804,"cycle":0.006011100948001058,"orig":4.134140430454805,"zero":0},
{"x":41,"trend":4.127779161798622,"cycle":0.009398171975911751,"orig":4.137177333774534,"zero":0},
{"x":42,"trend":4.127328702663302,"cycle":0.013234466138182022,"orig":4.140563168801484,"zero":0},
{"x":43,"trend":4.126782152151537,"cycle":0.012032143494413283,"orig":4.13881429564595,"zero":0},
{"x":44,"trend":4.1261519818553545,"cycle":0.016149063787600504,"orig":4.142301045642955,"zero":0},
{"x":45,"trend":4.125458183456468,"cycle":0.01691911330050555,"orig":4.142377296756973,"zero":0},
{"x":46,"trend":4.124730841801456,"cycle":0.011786801811840775,"orig":4.136517643613296,"zero":0},
{"x":47,"trend":4.124010616182711,"cycle":-0.00029011633422104666,"orig":4.12372049984849,"zero":0},
{"x":48,"trend":4.123345532643762,"cycle":-0.00699162938340514,"orig":4.116353903260356,"zero":0},
{"x":49,"trend":4.122783435905422,"cycle":-0.009690723721629269,"orig":4.113092712183793,"zero":0},
{"x":50,"trend":4.122367800920145,"cycle":-0.016691024801380294,"orig":4.105676776118765,"zero":0},
{"x":51,"trend":4.122136045938056,"cycle":-0.022230309085583322,"orig":4.099905736852473,"zero":0},
{"x":52,"trend":4.122115157318781,"cycle":-0.01957427687219493,"orig":4.102540880446586,"zero":0},
{"x":53,"trend":4.1223182274787655,"cycle":-0.010407196430981536,"orig":4.111911031047784,"zero":0},
{"x":54,"trend":4.122746114911412,"cycle":-0.002764670614573639,"orig":4.1199814442968385,"zero":0},
{"x":55,"trend":4.123393173612354,"cycle":-0.0006150374499469535,"orig":4.122778136162407,"zero":0},
{"x":56,"trend":4.124252029658089,"cycle":-0.0014852331732946311,"orig":4.122766796484794,"zero":0},
{"x":57,"trend":4.125314924726708,"cycle":0.0053535307092085205,"orig":4.1306684554359165,"zero":0},
{"x":58,"trend":4.12657317222557,"cycle":0.003548681372051554,"orig":4.130121853597622,"zero":0},
{"x":59,"trend":4.128021431518729,"cycle":0.000516806373350498,"orig":4.128538237892079,"zero":0},
{"x":60,"trend":4.129656579896092,"cycle":-0.005992726313535535,"orig":4.123663853582556,"zero":0},
{"x":61,"trend":4.131475817651553,"cycle":-0.013063228095751889,"orig":4.118412589555801,"zero":0},
{"x":62,"trend":4.133472599625058,"cycle":-0.008025120476967018,"orig":4.125447479148091,"zero":0},
{"x":63,"trend":4.135632216138996,"cycle":-0.0016952149904057023,"orig":4.13393700114859,"zero":0},
{"x":64,"trend":4.1379349418154545,"cycle":0.00356352599993226,"orig":4.141498467815387,"zero":0},
{"x":65,"trend":4.140359991767155,"cycle":0.0044241672130151954,"orig":4.14478415898017,"zero":0},
{"x":66,"trend":4.142888808310566,"cycle":0.0024070731655871924,"orig":4.145295881476153,"zero":0},
{"x":67,"trend":4.145505598866667,"cycle":0.008955220682417497,"orig":4.154460819549085,"zero":0},
{"x":68,"trend":4.148196075277166,"cycle":0.0006571896952873857,"orig":4.148853264972454,"zero":0},
{"x":69,"trend":4.150951546396696,"cycle":0.001194833747659274,"orig":4.152146380144355,"zero":0},
{"x":70,"trend":4.153763731823449,"cycle":0.005111539005705268,"orig":4.158875270829154,"zero":0},
{"x":71,"trend":4.15662509792671,"cycle":0.006035217700738116,"orig":4.162660315627448,"zero":0},
{"x":72,"trend":4.1595313057876435,"cycle":0.004816506206204885,"orig":4.164347811993848,"zero":0},
{"x":73,"trend":4.162481788498477,"cycle":0.005698565982616088,"orig":4.168180354481093,"zero":0},
{"x":74,"trend":4.165478989467816,"cycle":0.0075057588926013,"orig":4.172984748360418,"zero":0},
{"x":75,"trend":4.168528913708006,"cycle":0.003581920920042947,"orig":4.172110834628049,"zero":0},
{"x":76,"trend":4.1716422573307,"cycle":0.0032079823009851793,"orig":4.174850239631685,"zero":0},
{"x":77,"trend":4.174831955148125,"cycle":-0.0037732958583198695,"orig":4.171058659289805,"zero":0},
{"x":78,"trend":4.178112946961448,"cycle":-0.004801640322109613,"orig":4.173311306639339,"zero":0},
{"x":79,"trend":4.181497814261924,"cycle":-0.00549339112527214,"orig":4.176004423136652,"zero":0},
{"x":80,"trend":4.184996137515605,"cycle":-0.010198182731783412,"orig":4.174797954783822,"zero":0},
{"x":81,"trend":4.188614063819093,"cycle":-0.008524620719536635,"orig":4.180089443099557,"zero":0},
{"x":82,"trend":4.192351366404782,"cycle":-0.004958270882921667,"orig":4.18739309552186,"zero":0},
{"x":83,"trend":4.196202490617113,"cycle":-0.004250389542003852,"orig":4.191952101075109,"zero":0},
{"x":84,"trend":4.200158782881228,"cycle":-0.002301410959089978,"orig":4.197857371922138,"zero":0},
{"x":85,"trend":4.204208933128807,"cycle":-0.003477881739740063,"orig":4.2007310513890666,"zero":0},
{"x":86,"trend":4.2083401929096755,"cycle":-0.0070264096903320805,"orig":4.2013137832193435,"zero":0},
{"x":87,"trend":4.212537640097576,"cycle":-0.0010739662716012788,"orig":4.211463673825975,"zero":0},
{"x":88,"trend":4.216781961060193,"cycle":0.0005778508084341993,"orig":4.2173598118686275,"zero":0},
{"x":89,"trend":4.221053170936292,"cycle":0.000897136890882777,"orig":4.221950307827175,"zero":0},
{"x":90,"trend":4.2253316460213926,"cycle":0.003347111492918664,"orig":4.228678757514311,"zero":0},
{"x":91,"trend":4.229598323321572,"cycle":0.0004099398722372527,"orig":4.23000826319381,"zero":0},
{"x":92,"trend":4.233836231787592,"cycle":0.0028538889191445094,"orig":4.2366901207067365,"zero":0},
{"x":93,"trend":4.238028656582632,"cycle":0.0018020133856566645,"orig":4.239830669968288,"zero":0},
{"x":94,"trend":4.242160666550446,"cycle":0.005682934655700578,"orig":4.247843601206147,"zero":0},
{"x":95,"trend":4.246218456793156,"cycle":0.008437767369676052,"orig":4.254656224162832,"zero":0},
{"x":96,"trend":4.2501917742470425,"cycle":0.014630875838022028,"orig":4.264822650085065,"zero":0},
{"x":97,"trend":4.254075639452993,"cycle":0.012447546830009593,"orig":4.266523186283003,"zero":0},
{"x":98,"trend":4.257874217249294,"cycle":0.007520281728696787,"orig":4.265394498977991,"zero":0},
{"x":99,"trend":4.261599452191001,"cycle":0.005455347945277467,"orig":4.267054800136278,"zero":0},
{"x":100,"trend":4.2652679890092475,"cycle":5.908533681431294e-5,"orig":4.265327074346062,"zero":0},
{"x":101,"trend":4.268899882027636,"cycle":0.0013260993035446589,"orig":4.270225981331181,"zero":0},
{"x":102,"trend":4.272515222498102,"cycle":0.0010196102652821892,"orig":4.273534832763384,"zero":0},
{"x":103,"trend":4.276134930484646,"cycle":-0.006789990461367523,"orig":4.269344940023278,"zero":0},
{"x":104,"trend":4.279780563307685,"cycle":0.0027336997080444903,"orig":4.282514263015729,"zero":0},
{"x":105,"trend":4.283469434543599,"cycle":0.0030700046596097152,"orig":4.286539439203208,"zero":0},
{"x":106,"trend":4.287220566331082,"cycle":-0.0024402345387795066,"orig":4.2847803317923026,"zero":0},
{"x":107,"trend":4.291054899561743,"cycle":-0.003642561874808159,"orig":4.287412337686935,"zero":0},
{"x":108,"trend":4.294991849980603,"cycle":-0.0041146878705839995,"orig":4.290877162110019,"zero":0},
{"x":109,"trend":4.299048556731513,"cycle":-0.01391147341286203,"orig":4.285137083318651,"zero":0},
{"x":110,"trend":4.303239587278407,"cycle":-0.0035733440332901267,"orig":4.299666243245117,"zero":0},
{"x":111,"trend":4.3075708144143325,"cycle":-0.009129613798256386,"orig":4.298441200616076,"zero":0},
{"x":112,"trend":4.312045877592318,"cycle":-0.0037034587157211973,"orig":4.308342418876597,"zero":0},
{"x":113,"trend":4.316662710256768,"cycle":-0.000874707757247073,"orig":4.315788002499521,"zero":0},
{"x":114,"trend":4.321416931190388,"cycle":0.001964449550317049,"orig":4.323381380740705,"zero":0},
{"x":115,"trend":4.3263036124835335,"cycle":-0.0027684857071186286,"orig":4.323535126776415,"zero":0},
{"x":116,"trend":4.331319054007528,"cycle":-0.0026786919465378034,"orig":4.32864036206099,"zero":0},
{"x":117,"trend":4.336457825330132,"cycle":-0.0015778311509269116,"orig":4.334879994179205,"zero":0},
{"x":118,"trend":4.341712821836636,"cycle":-0.006536733607413581,"orig":4.335176088229223,"zero":0},
{"x":119,"trend":4.347075952767867,"cycle":-0.0027550793665751527,"orig":4.3443208734012915,"zero":0},
{"x":120,"trend":4.35253504190614,"cycle":-0.001827520412392758,"orig":4.350707521493748,"zero":0},
{"x":121,"trend":4.3580761911091725,"cycle":-0.005784799241556726,"orig":4.352291391867616,"zero":0},
{"x":122,"trend":4.363684360034417,"cycle":0.0004748486327956769,"orig":4.364159208667212,"zero":0},
{"x":123,"trend":4.3693408928398005,"cycle":0.0011443959875219178,"orig":4.3704852888273225,"zero":0},
{"x":124,"trend":4.375027430463645,"cycle":-0.0033706271209545946,"orig":4.371656803342691,"zero":0},
{"x":125,"trend":4.380726329091768,"cycle":-0.003545164771510123,"orig":4.377181164320258,"zero":0},
{"x":126,"trend":4.3864178382680326,"cycle":-0.0046512374000107215,"orig":4.381766600868022,"zero":0},
{"x":127,"trend":4.392079991808324,"cycle":-0.0018074482805916503,"orig":4.3902725435277326,"zero":0},
{"x":128,"trend":4.397687916505155,"cycle":0.002539573116163041,"orig":4.400227489621318,"zero":0},
{"x":129,"trend":4.403215609495862,"cycle":0.006129455582029486,"orig":4.409345065077892,"zero":0},
{"x":130,"trend":4.408638655150981,"cycle":0.009534259908906328,"orig":4.418172915059888,"zero":0},
{"x":131,"trend":4.413936468750785,"cycle":0.012080735204130555,"orig":4.426017203954916,"zero":0},
{"x":132,"trend":4.419094424487991,"cycle":0.01117222304984189,"orig":4.430266647537833,"zero":0},
{"x":133,"trend":4.424105447014817,"cycle":0.0105349847989622,"orig":4.434640431813779,"zero":0},
{"x":134,"trend":4.428969443622888,"cycle":0.0072884778091593105,"orig":4.4362579214320474,"zero":0},
{"x":135,"trend":4.433692905969325,"cycle":0.002916606474848038,"orig":4.436609512444173,"zero":0},
{"x":136,"trend":4.438286881009879,"cycle":0.0017480146149075892,"orig":4.440034895624787,"zero":0},
{"x":137,"trend":4.4427642385793495,"cycle":0.0038403695788487013,"orig":4.446604608158198,"zero":0},
{"x":138,"trend":4.447138941021671,"cycle":-0.0065509881496179645,"orig":4.440587952872053,"zero":0},
{"x":139,"trend":4.451427350911766,"cycle":-0.01469238473322676,"orig":4.436734966178539,"zero":0},
{"x":140,"trend":4.455641736456961,"cycle":0.0015851307798557812,"orig":4.457226867236817,"zero":0},
{"x":141,"trend":4.459785183124122,"cycle":-0.00309064380226598,"orig":4.456694539321856,"zero":0},
{"x":142,"trend":4.463861767086852,"cycle":-0.000354228670144785,"orig":4.4635075384167076,"zero":0},
{"x":143,"trend":4.467873632866383,"cycle":-0.005124521614208177,"orig":4.462749111252175,"zero":0},
{"x":144,"trend":4.471822703591025,"cycle":-0.004553442745399039,"orig":4.467269260845626,"zero":0},
{"x":145,"trend":4.475707699563079,"cycle":-0.004127193612474933,"orig":4.471580505950604,"zero":0},
{"x":146,"trend":4.479524495183133,"cycle":-0.0018809095821810118,"orig":4.477643585600952,"zero":0},
{"x":147,"trend":4.483266385355767,"cycle":-0.003356747065369703,"orig":4.479909638290398,"zero":0},
{"x":148,"trend":4.486925489417073,"cycle":-0.004719865035169413,"orig":4.482205624381904,"zero":0},
{"x":149,"trend":4.4904918287362285,"cycle":-0.0019835570959392257,"orig":4.488508271640289,"zero":0},
{"x":150,"trend":4.493952474766759,"cycle":-0.00622888103847874,"orig":4.487723593728281,"zero":0},
{"x":151,"trend":4.497293259239006,"cycle":-0.0038001631927144786,"orig":4.493493096046292,"zero":0},
{"x":152,"trend":4.500496120832659,"cycle":-0.0029957816227419443,"orig":4.497500339209917,"zero":0},
{"x":153,"trend":4.503540623125412,"cycle":-0.010085544960947601,"orig":4.493455078164464,"zero":0},
{"x":154,"trend":4.506404457331447,"cycle":-0.0008004952681837096,"orig":4.5056039620632635,"zero":0},
{"x":155,"trend":4.5090590111993425,"cycle":0.0013806269653455772,"orig":4.510439638164688,"zero":0},
{"x":156,"trend":4.51147517216813,"cycle":0.00664799983170461,"orig":4.518123171999835,"zero":0},
{"x":157,"trend":4.513624690568699,"cycle":0.003129496045821689,"orig":4.516754186614521,"zero":0},
{"x":158,"trend":4.51548347173183,"cycle":0.00438914059368134,"orig":4.5198726123255115,"zero":0},
{"x":159,"trend":4.517029376923333,"cycle":0.006392647931857454,"orig":4.523422024855191,"zero":0},
{"x":160,"trend":4.51824301062189,"cycle":0.011113595644347996,"orig":4.529356606266238,"zero":0},
{"x":161,"trend":4.51910897271114,"cycle":0.01295166560850447,"orig":4.532060638319645,"zero":0},
{"x":162,"trend":4.519618809072,"cycle":0.01283228597402708,"orig":4.532451095046027,"zero":0},
{"x":163,"trend":4.519772160376389,"cycle":0.010726202216049252,"orig":4.530498362592438,"zero":0},
{"x":164,"trend":4.519576687474964,"cycle":0.00819504172471941,"orig":4.527771729199683,"zero":0},
{"x":165,"trend":4.519046755094763,"cycle":0.013329057129801036,"orig":4.532375812224564,"zero":0},
{"x":166,"trend":4.518201849863909,"cycle":0.010280577642947542,"orig":4.528482427506857,"zero":0},
{"x":167,"trend":4.51706978907123,"cycle":0.011692242910472217,"orig":4.528762031981702,"zero":0},
{"x":168,"trend":4.515684815366576,"cycle":0.009808845894818674,"orig":4.525493661261395,"zero":0},
{"x":169,"trend":4.514088479051621,"cycle":0.006634312858850855,"orig":4.5207227919104715,"zero":0},
{"x":170,"trend":4.512328460956723,"cycle":0.001859565819378517,"orig":4.514188026776101,"zero":0},
{"x":171,"trend":4.510456588357775,"cycle":0.001679026663083505,"orig":4.512135615020859,"zero":0},
{"x":172,"trend":4.508525850759307,"cycle":1.3383589212878633e-5,"orig":4.50853923434852,"zero":0},
{"x":173,"trend":4.506590287057511,"cycle":-0.0028383974946217805,"orig":4.503751889562889,"zero":0},
{"x":174,"trend":4.504703944513325,"cycle":-0.00624629886777317,"orig":4.498457645645551,"zero":0},
{"x":175,"trend":4.502919096389252,"cycle":-0.010886254015153085,"orig":4.4920328423740985,"zero":0},
{"x":176,"trend":4.501284112011004,"cycle":-0.010399709201996288,"orig":4.490884402809008,"zero":0},
{"x":177,"trend":4.499840556795536,"cycle":-0.014034029991291774,"orig":4.485806526804244,"zero":0},
{"x":178,"trend":4.498623496341548,"cycle":-0.01556218899164552,"orig":4.483061307349902,"zero":0},
{"x":179,"trend":4.497659224978996,"cycle":-0.020663377714412512,"orig":4.476995847264583,"zero":0},
{"x":180,"trend":4.49696431066972,"cycle":-0.020395973212537832,"orig":4.4765683374571825,"zero":0},
{"x":181,"trend":4.496542406764486,"cycle":-0.013341004466132844,"orig":4.483201402298353,"zero":0},
{"x":182,"trend":4.4963844191308,"cycle":-0.013067792149837665,"orig":4.483316626980963,"zero":0},
{"x":183,"trend":4.496472915508378,"cycle":-0.00594395583249252,"orig":4.490528959675886,"zero":0},
{"x":184,"trend":4.496782296266844,"cycle":-0.0013823344252790193,"orig":4.4953999618415645,"zero":0},
{"x":185,"trend":4.497283246803423,"cycle":0.002126343505501893,"orig":4.499409590308925,"zero":0},
{"x":186,"trend":4.497945588556329,"cycle":0.009679020989044496,"orig":4.507624609545373,"zero":0},
{"x":187,"trend":4.498740471928461,"cycle":0.008562166977411856,"orig":4.507302638905873,"zero":0},
{"x":188,"trend":4.49964509671084,"cycle":0.006546388671469394,"orig":4.50619148538231,"zero":0},
{"x":189,"trend":4.500642014048842,"cycle":0.0063981200300666785,"orig":4.507040134078909,"zero":0},
{"x":190,"trend":4.501717866580764,"cycle":0.0032374311612102247,"orig":4.504955297741974,"zero":0},
{"x":191,"trend":4.502863295769922,"cycle":0.00767857788937043,"orig":4.510541873659292,"zero":0},
{"x":192,"trend":4.504070966474109,"cycle":0.0008942798942639385,"orig":4.504965246368373,"zero":0},
{"x":193,"trend":4.505338342662304,"cycle":0.008112309429968434,"orig":4.513450652092272,"zero":0},
{"x":194,"trend":4.506663447228414,"cycle":0.007974625791785428,"orig":4.514638073020199,"zero":0},
{"x":195,"trend":4.50804937325974,"cycle":0.003956728412831012,"orig":4.512006101672571,"zero":0},
{"x":196,"trend":4.509504197984702,"cycle":-0.0034728116212168203,"orig":4.506031386363485,"zero":0},
{"x":197,"trend":4.511038471586978,"cycle":-0.005279864654301747,"orig":4.505758606932676,"zero":0},
{"x":198,"trend":4.512660573742977,"cycle":-0.005624852098749855,"orig":4.507035721644227,"zero":0},
{"x":199,"trend":4.514375584213702,"cycle":-0.0022147270188757062,"orig":4.512160857194826,"zero":0},
{"x":200,"trend":4.516185067227588,"cycle":-0.006208367852736707,"orig":4.509976699374851,"zero":0},
{"x":201,"trend":4.518089202808685,"cycle":-0.001685751731694829,"orig":4.51640345107699,"zero":0},
{"x":202,"trend":4.520084290751138,"cycle":-0.0024499829157296205,"orig":4.517634307835408,"zero":0},
{"x":203,"trend":4.522165577254255,"cycle":0.0021513226303495614,"orig":4.524316899884605,"zero":0},
{"x":204,"trend":4.5243267772780245,"cycle":0.00028606863599023313,"orig":4.524612845914015,"zero":0},
{"x":205,"trend":4.526562950359076,"cycle":-0.0004294782260272356,"orig":4.526133472133049,"zero":0},
{"x":206,"trend":4.528869334826937,"cycle":0.003278443415272392,"orig":4.5321477782422095,"zero":0},
{"x":207,"trend":4.531240900587244,"cycle":-0.0031018781938030315,"orig":4.528139022393441,"zero":0},
{"x":208,"trend":4.5336746665727725,"cycle":-0.0018281450035244617,"orig":4.531846521569248,"zero":0},
{"x":209,"trend":4.536165713042424,"cycle":0.0028785592335616172,"orig":4.539044272275985,"zero":0},
{"x":210,"trend":4.538707977664473,"cycle":-0.007496544194676602,"orig":4.531211433469797,"zero":0},
{"x":211,"trend":4.541297197206716,"cycle":-0.0026418840532524968,"orig":4.5386553131534635,"zero":0},
{"x":212,"trend":4.5439244230968265,"cycle":-0.004598143223994988,"orig":4.5393262798728315,"zero":0},
{"x":213,"trend":4.546579055584947,"cycle":-0.005982591353960842,"orig":4.540596464230986,"zero":0},
{"x":214,"trend":4.549247621081704,"cycle":-0.00015584411348434912,"orig":4.549091776968219,"zero":0},
{"x":215,"trend":4.551912906878131,"cycle":-0.0003407744589178918,"orig":4.5515721324192135,"zero":0},
{"x":216,"trend":4.554557602862696,"cycle":0.00495077055745341,"orig":4.559508373420149,"zero":0},
{"x":217,"trend":4.557164185939824,"cycle":0.00593426659619567,"orig":4.563098452536019,"zero":0},
{"x":218,"trend":4.559718227245542,"cycle":0.010613071353248849,"orig":4.5703312985987905,"zero":0},
{"x":219,"trend":4.562209006832499,"cycle":0.006770111986673655,"orig":4.568979118819173,"zero":0},
{"x":220,"trend":4.564632437922941,"cycle":0.006496876340054136,"orig":4.571129314262995,"zero":0},
{"x":221,"trend":4.566988665059106,"cycle":0.00504036973074129,"orig":4.572029034789847,"zero":0},
{"x":222,"trend":4.569281893330941,"cycle":0.007234670616369954,"orig":4.576516563947311,"zero":0},
{"x":223,"trend":4.571519478059477,"cycle":0.0018256195996171343,"orig":4.573345097659094,"zero":0},
{"x":224,"trend":4.573713296234877,"cycle":0.002885589770778907,"orig":4.576598886005656,"zero":0},
{"x":225,"trend":4.575876365859555,"cycle":-0.01884130862344513,"orig":4.55703505723611,"zero":0},
{"x":226,"trend":4.578023508429524,"cycle":-0.00892412178620372,"orig":4.5690993866433205,"zero":0},
{"x":227,"trend":4.580157769622908,"cycle":0.00011913364190707654,"orig":4.580276903264815,"zero":0},
{"x":228,"trend":4.582276617541716,"cycle":0.0031519792873311303,"orig":4.585428596829047,"zero":0},
{"x":229,"trend":4.584377594746481,"cycle":0.002627602283481245,"orig":4.587005197029963,"zero":0},
{"x":230,"trend":4.586460213784796,"cycle":0.0009664834255049826,"orig":4.587426697210301,"zero":0},
{"x":231,"trend":4.588525629455674,"cycle":0.0011531824143728997,"orig":4.589678811870047,"zero":0},
{"x":232,"trend":4.590575600610268,"cycle":0.0021352897030499918,"orig":4.592710890313318,"zero":0},
{"x":233,"trend":4.592612606838736,"cycle":0.00035239803099340605,"orig":4.592965004869729,"zero":0},
{"x":234,"trend":4.594640462287297,"cycle":0.0014859517988563553,"orig":4.596126414086154,"zero":0},
{"x":235,"trend":4.5966632013509425,"cycle":-0.0010495337703204655,"orig":4.595613667580622,"zero":0},
{"x":236,"trend":4.598685787144532,"cycle":0.0013070193144235631,"orig":4.599992806458956,"zero":0},
{"x":237,"trend":4.600712526824328,"cycle":-0.0023826827223114577,"orig":4.598329844102016,"zero":0},
{"x":238,"trend":4.602748544433659,"cycle":-0.005566176287769231,"orig":4.59718236814589,"zero":0},
{"x":239,"trend":4.604797474839157,"cycle":-0.008035539321603835,"orig":4.596761935517553,"zero":0},
{"x":240,"trend":4.606859474047271,"cycle":4.420856697162634e-5,"orig":4.606903682614242,"zero":0},
{"x":241,"trend":4.608929675852375,"cycle":-0.0054148592324487765,"orig":4.603514816619926,"zero":0},
{"x":242,"trend":4.611003241679193,"cycle":0.0018900442484071078,"orig":4.6128932859276,"zero":0},
{"x":243,"trend":4.613071948665431,"cycle":0.0015999527114720635,"orig":4.614671901376903,"zero":0},
{"x":244,"trend":4.615128755226451,"cycle":0.006243466052205271,"orig":4.621372221278656,"zero":0},
{"x":245,"trend":4.617167619748056,"cycle":0.005160523005410589,"orig":4.622328142753466,"zero":0},
{"x":246,"trend":4.619186402782332,"cycle":0.0037185877548422397,"orig":4.622904990537174,"zero":0},
{"x":247,"trend":4.621186190208242,"cycle":0.0005185436189396597,"orig":4.6217047338271815,"zero":0},
{"x":248,"trend":4.623170392022096,"cycle":0.0004583811899347978,"orig":4.6236287732120305,"zero":0},
{"x":249,"trend":4.625142742309964,"cycle":0.0007061576864844099,"orig":4.625848899996448,"zero":0},
{"x":250,"trend":4.627107261646163,"cycle":-0.004082422864229329,"orig":4.623024838781934,"zero":0},
{"x":251,"trend":4.629068411953562,"cycle":-0.0007228613749141743,"orig":4.628345550578648,"zero":0},
{"x":252,"trend":4.631028103640739,"cycle":-0.0023337923557784634,"orig":4.628694311284961,"zero":0}];
    const series = [{"name":"Original","color":"#1f77b4","key":"orig","dash":""},{"name":"Trend","color":"#ff7f0e","key":"trend","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#filt_tc_61');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"trend":4.038907380057364,"cycle":-0.011981928333923086,"orig":4.026925451723441,"zero":0},
{"x":2,"trend":4.0440233350454315,"cycle":-0.004002971553930479,"orig":4.040020363491501,"zero":0},
{"x":3,"trend":4.049131801328291,"cycle":-0.007664243040291119,"orig":4.041467558288,"zero":0},
{"x":4,"trend":4.054222788343514,"cycle":-0.006444115824378649,"orig":4.047778672519136,"zero":0},
{"x":5,"trend":4.059281515376773,"cycle":-0.005200076094967976,"orig":4.054081439281805,"zero":0},
{"x":6,"trend":4.064289174141348,"cycle":-0.005041705556709353,"orig":4.059247468584639,"zero":0},
{"x":7,"trend":4.069223706302961,"cycle":-0.0031791722443559323,"orig":4.066044534058605,"zero":0},
{"x":8,"trend":4.074059902461362,"cycle":-0.00053728686491894,"orig":4.073522615596443,"zero":0},
{"x":9,"trend":4.078770566233645,"cycle":-0.0013161766242957285,"orig":4.07745438960935,"zero":0},
{"x":10,"trend":4.083328165432619,"cycle":0.007359719285938482,"orig":4.090687884718557,"zero":0},
{"x":11,"trend":4.087704345260696,"cycle":0.00784948550138953,"orig":4.095553830762086,"zero":0},
{"x":12,"trend":4.091875350744847,"cycle":0.009271026596181287,"orig":4.101146377341029,"zero":0},
{"x":13,"trend":4.09582233284048,"cycle":0.005127036211491465,"orig":4.100949369051971,"zero":0},
{"x":14,"trend":4.099532236894624,"cycle":0.006416403497989442,"orig":4.105948640392613,"zero":0},
{"x":15,"trend":4.102995212651943,"cycle":0.005418250165616811,"orig":4.10841346281756,"zero":0},
{"x":16,"trend":4.106205420109285,"cycle":0.007992421720916632,"orig":4.114197841830202,"zero":0},
{"x":17,"trend":4.1091604056698525,"cycle":0.0030191630771616573,"orig":4.112179568747014,"zero":0},
{"x":18,"trend":4.111862711000424,"cycle":0.0032137851407574303,"orig":4.115076496141182,"zero":0},
{"x":19,"trend":4.114316764744701,"cycle":0.0009066428287392014,"orig":4.11522340757344,"zero":0},
{"x":20,"trend":4.116529004162098,"cycle":0.0036960826895793275,"orig":4.120225086851677,"zero":0},
{"x":21,"trend":4.118506433163798,"cycle":-0.001410979670994017,"orig":4.117095453492804,"zero":0},
{"x":22,"trend":4.1202583657126635,"cycle":0.0011386241707533884,"orig":4.121396989883417,"zero":0},
{"x":23,"trend":4.121793233909264,"cycle":0.0020195115618735215,"orig":4.123812745471137,"zero":0},
{"x":24,"trend":4.123120181494274,"cycle":0.005211873154940427,"orig":4.128332054649214,"zero":0},
{"x":25,"trend":4.124249614403096,"cycle":0.007027789378596161,"orig":4.131277403781692,"zero":0},
{"x":26,"trend":4.125195195991855,"cycle":0.00164721094790643,"orig":4.126842406939762,"zero":0},
{"x":27,"trend":4.125974981985037,"cycle":0.003365033384306493,"orig":4.129340015369343,"zero":0},
{"x":28,"trend":4.126608057613968,"cycle":0.0025822770337313727,"orig":4.129190334647699,"zero":0},
{"x":29,"trend":4.127115611255843,"cycle":-0.00362657209527395,"orig":4.123489039160569,"zero":0},
{"x":30,"trend":4.127520445211,"cycle":-0.004107492241552713,"orig":4.123412952969447,"zero":0},
{"x":31,"trend":4.12784309517222,"cycle":-0.014124101892027952,"orig":4.113718993280192,"zero":0},
{"x":32,"trend":4.12810152964963,"cycle":-0.0046319162002852465,"orig":4.123469613449345,"zero":0},
{"x":33,"trend":4.128304889589678,"cycle":-0.007974242729880565,"orig":4.120330646859798,"zero":0},
{"x":34,"trend":4.128459420991185,"cycle":-0.009477532259805521,"orig":4.11898188873138,"zero":0},
{"x":35,"trend":4.128566385951267,"cycle":-0.0062111447786721286,"orig":4.1223552411725946,"zero":0},
{"x":36,"trend":4.128621123109376,"cycle":-0.0007966536466721408,"orig":4.127824469462704,"zero":0},
{"x":37,"trend":4.12861508913948,"cycle":-0.005861252443700948,"orig":4.122753836695779,"zero":0},
{"x":38,"trend":4.1285392428070145,"cycle":0.003255234861923917,"orig":4.131794477668938,"zero":0},
{"x":39,"trend":4.12838087959464,"cycle":0.008382801066047385,"orig":4.136763680660687,"zero":0},
{"x":40,"trend":4.128129329506804,"cycle":0.006011100948001058,"orig":4.134140430454805,"zero":0},
{"x":41,"trend":4.127779161798622,"cycle":0.009398171975911751,"orig":4.137177333774534,"zero":0},
{"x":42,"trend":4.127328702663302,"cycle":0.013234466138182022,"orig":4.140563168801484,"zero":0},
{"x":43,"trend":4.126782152151537,"cycle":0.012032143494413283,"orig":4.13881429564595,"zero":0},
{"x":44,"trend":4.1261519818553545,"cycle":0.016149063787600504,"orig":4.142301045642955,"zero":0},
{"x":45,"trend":4.125458183456468,"cycle":0.01691911330050555,"orig":4.142377296756973,"zero":0},
{"x":46,"trend":4.124730841801456,"cycle":0.011786801811840775,"orig":4.136517643613296,"zero":0},
{"x":47,"trend":4.124010616182711,"cycle":-0.00029011633422104666,"orig":4.12372049984849,"zero":0},
{"x":48,"trend":4.123345532643762,"cycle":-0.00699162938340514,"orig":4.116353903260356,"zero":0},
{"x":49,"trend":4.122783435905422,"cycle":-0.009690723721629269,"orig":4.113092712183793,"zero":0},
{"x":50,"trend":4.122367800920145,"cycle":-0.016691024801380294,"orig":4.105676776118765,"zero":0},
{"x":51,"trend":4.122136045938056,"cycle":-0.022230309085583322,"orig":4.099905736852473,"zero":0},
{"x":52,"trend":4.122115157318781,"cycle":-0.01957427687219493,"orig":4.102540880446586,"zero":0},
{"x":53,"trend":4.1223182274787655,"cycle":-0.010407196430981536,"orig":4.111911031047784,"zero":0},
{"x":54,"trend":4.122746114911412,"cycle":-0.002764670614573639,"orig":4.1199814442968385,"zero":0},
{"x":55,"trend":4.123393173612354,"cycle":-0.0006150374499469535,"orig":4.122778136162407,"zero":0},
{"x":56,"trend":4.124252029658089,"cycle":-0.0014852331732946311,"orig":4.122766796484794,"zero":0},
{"x":57,"trend":4.125314924726708,"cycle":0.0053535307092085205,"orig":4.1306684554359165,"zero":0},
{"x":58,"trend":4.12657317222557,"cycle":0.003548681372051554,"orig":4.130121853597622,"zero":0},
{"x":59,"trend":4.128021431518729,"cycle":0.000516806373350498,"orig":4.128538237892079,"zero":0},
{"x":60,"trend":4.129656579896092,"cycle":-0.005992726313535535,"orig":4.123663853582556,"zero":0},
{"x":61,"trend":4.131475817651553,"cycle":-0.013063228095751889,"orig":4.118412589555801,"zero":0},
{"x":62,"trend":4.133472599625058,"cycle":-0.008025120476967018,"orig":4.125447479148091,"zero":0},
{"x":63,"trend":4.135632216138996,"cycle":-0.0016952149904057023,"orig":4.13393700114859,"zero":0},
{"x":64,"trend":4.1379349418154545,"cycle":0.00356352599993226,"orig":4.141498467815387,"zero":0},
{"x":65,"trend":4.140359991767155,"cycle":0.0044241672130151954,"orig":4.14478415898017,"zero":0},
{"x":66,"trend":4.142888808310566,"cycle":0.0024070731655871924,"orig":4.145295881476153,"zero":0},
{"x":67,"trend":4.145505598866667,"cycle":0.008955220682417497,"orig":4.154460819549085,"zero":0},
{"x":68,"trend":4.148196075277166,"cycle":0.0006571896952873857,"orig":4.148853264972454,"zero":0},
{"x":69,"trend":4.150951546396696,"cycle":0.001194833747659274,"orig":4.152146380144355,"zero":0},
{"x":70,"trend":4.153763731823449,"cycle":0.005111539005705268,"orig":4.158875270829154,"zero":0},
{"x":71,"trend":4.15662509792671,"cycle":0.006035217700738116,"orig":4.162660315627448,"zero":0},
{"x":72,"trend":4.1595313057876435,"cycle":0.004816506206204885,"orig":4.164347811993848,"zero":0},
{"x":73,"trend":4.162481788498477,"cycle":0.005698565982616088,"orig":4.168180354481093,"zero":0},
{"x":74,"trend":4.165478989467816,"cycle":0.0075057588926013,"orig":4.172984748360418,"zero":0},
{"x":75,"trend":4.168528913708006,"cycle":0.003581920920042947,"orig":4.172110834628049,"zero":0},
{"x":76,"trend":4.1716422573307,"cycle":0.0032079823009851793,"orig":4.174850239631685,"zero":0},
{"x":77,"trend":4.174831955148125,"cycle":-0.0037732958583198695,"orig":4.171058659289805,"zero":0},
{"x":78,"trend":4.178112946961448,"cycle":-0.004801640322109613,"orig":4.173311306639339,"zero":0},
{"x":79,"trend":4.181497814261924,"cycle":-0.00549339112527214,"orig":4.176004423136652,"zero":0},
{"x":80,"trend":4.184996137515605,"cycle":-0.010198182731783412,"orig":4.174797954783822,"zero":0},
{"x":81,"trend":4.188614063819093,"cycle":-0.008524620719536635,"orig":4.180089443099557,"zero":0},
{"x":82,"trend":4.192351366404782,"cycle":-0.004958270882921667,"orig":4.18739309552186,"zero":0},
{"x":83,"trend":4.196202490617113,"cycle":-0.004250389542003852,"orig":4.191952101075109,"zero":0},
{"x":84,"trend":4.200158782881228,"cycle":-0.002301410959089978,"orig":4.197857371922138,"zero":0},
{"x":85,"trend":4.204208933128807,"cycle":-0.003477881739740063,"orig":4.2007310513890666,"zero":0},
{"x":86,"trend":4.2083401929096755,"cycle":-0.0070264096903320805,"orig":4.2013137832193435,"zero":0},
{"x":87,"trend":4.212537640097576,"cycle":-0.0010739662716012788,"orig":4.211463673825975,"zero":0},
{"x":88,"trend":4.216781961060193,"cycle":0.0005778508084341993,"orig":4.2173598118686275,"zero":0},
{"x":89,"trend":4.221053170936292,"cycle":0.000897136890882777,"orig":4.221950307827175,"zero":0},
{"x":90,"trend":4.2253316460213926,"cycle":0.003347111492918664,"orig":4.228678757514311,"zero":0},
{"x":91,"trend":4.229598323321572,"cycle":0.0004099398722372527,"orig":4.23000826319381,"zero":0},
{"x":92,"trend":4.233836231787592,"cycle":0.0028538889191445094,"orig":4.2366901207067365,"zero":0},
{"x":93,"trend":4.238028656582632,"cycle":0.0018020133856566645,"orig":4.239830669968288,"zero":0},
{"x":94,"trend":4.242160666550446,"cycle":0.005682934655700578,"orig":4.247843601206147,"zero":0},
{"x":95,"trend":4.246218456793156,"cycle":0.008437767369676052,"orig":4.254656224162832,"zero":0},
{"x":96,"trend":4.2501917742470425,"cycle":0.014630875838022028,"orig":4.264822650085065,"zero":0},
{"x":97,"trend":4.254075639452993,"cycle":0.012447546830009593,"orig":4.266523186283003,"zero":0},
{"x":98,"trend":4.257874217249294,"cycle":0.007520281728696787,"orig":4.265394498977991,"zero":0},
{"x":99,"trend":4.261599452191001,"cycle":0.005455347945277467,"orig":4.267054800136278,"zero":0},
{"x":100,"trend":4.2652679890092475,"cycle":5.908533681431294e-5,"orig":4.265327074346062,"zero":0},
{"x":101,"trend":4.268899882027636,"cycle":0.0013260993035446589,"orig":4.270225981331181,"zero":0},
{"x":102,"trend":4.272515222498102,"cycle":0.0010196102652821892,"orig":4.273534832763384,"zero":0},
{"x":103,"trend":4.276134930484646,"cycle":-0.006789990461367523,"orig":4.269344940023278,"zero":0},
{"x":104,"trend":4.279780563307685,"cycle":0.0027336997080444903,"orig":4.282514263015729,"zero":0},
{"x":105,"trend":4.283469434543599,"cycle":0.0030700046596097152,"orig":4.286539439203208,"zero":0},
{"x":106,"trend":4.287220566331082,"cycle":-0.0024402345387795066,"orig":4.2847803317923026,"zero":0},
{"x":107,"trend":4.291054899561743,"cycle":-0.003642561874808159,"orig":4.287412337686935,"zero":0},
{"x":108,"trend":4.294991849980603,"cycle":-0.0041146878705839995,"orig":4.290877162110019,"zero":0},
{"x":109,"trend":4.299048556731513,"cycle":-0.01391147341286203,"orig":4.285137083318651,"zero":0},
{"x":110,"trend":4.303239587278407,"cycle":-0.0035733440332901267,"orig":4.299666243245117,"zero":0},
{"x":111,"trend":4.3075708144143325,"cycle":-0.009129613798256386,"orig":4.298441200616076,"zero":0},
{"x":112,"trend":4.312045877592318,"cycle":-0.0037034587157211973,"orig":4.308342418876597,"zero":0},
{"x":113,"trend":4.316662710256768,"cycle":-0.000874707757247073,"orig":4.315788002499521,"zero":0},
{"x":114,"trend":4.321416931190388,"cycle":0.001964449550317049,"orig":4.323381380740705,"zero":0},
{"x":115,"trend":4.3263036124835335,"cycle":-0.0027684857071186286,"orig":4.323535126776415,"zero":0},
{"x":116,"trend":4.331319054007528,"cycle":-0.0026786919465378034,"orig":4.32864036206099,"zero":0},
{"x":117,"trend":4.336457825330132,"cycle":-0.0015778311509269116,"orig":4.334879994179205,"zero":0},
{"x":118,"trend":4.341712821836636,"cycle":-0.006536733607413581,"orig":4.335176088229223,"zero":0},
{"x":119,"trend":4.347075952767867,"cycle":-0.0027550793665751527,"orig":4.3443208734012915,"zero":0},
{"x":120,"trend":4.35253504190614,"cycle":-0.001827520412392758,"orig":4.350707521493748,"zero":0},
{"x":121,"trend":4.3580761911091725,"cycle":-0.005784799241556726,"orig":4.352291391867616,"zero":0},
{"x":122,"trend":4.363684360034417,"cycle":0.0004748486327956769,"orig":4.364159208667212,"zero":0},
{"x":123,"trend":4.3693408928398005,"cycle":0.0011443959875219178,"orig":4.3704852888273225,"zero":0},
{"x":124,"trend":4.375027430463645,"cycle":-0.0033706271209545946,"orig":4.371656803342691,"zero":0},
{"x":125,"trend":4.380726329091768,"cycle":-0.003545164771510123,"orig":4.377181164320258,"zero":0},
{"x":126,"trend":4.3864178382680326,"cycle":-0.0046512374000107215,"orig":4.381766600868022,"zero":0},
{"x":127,"trend":4.392079991808324,"cycle":-0.0018074482805916503,"orig":4.3902725435277326,"zero":0},
{"x":128,"trend":4.397687916505155,"cycle":0.002539573116163041,"orig":4.400227489621318,"zero":0},
{"x":129,"trend":4.403215609495862,"cycle":0.006129455582029486,"orig":4.409345065077892,"zero":0},
{"x":130,"trend":4.408638655150981,"cycle":0.009534259908906328,"orig":4.418172915059888,"zero":0},
{"x":131,"trend":4.413936468750785,"cycle":0.012080735204130555,"orig":4.426017203954916,"zero":0},
{"x":132,"trend":4.419094424487991,"cycle":0.01117222304984189,"orig":4.430266647537833,"zero":0},
{"x":133,"trend":4.424105447014817,"cycle":0.0105349847989622,"orig":4.434640431813779,"zero":0},
{"x":134,"trend":4.428969443622888,"cycle":0.0072884778091593105,"orig":4.4362579214320474,"zero":0},
{"x":135,"trend":4.433692905969325,"cycle":0.002916606474848038,"orig":4.436609512444173,"zero":0},
{"x":136,"trend":4.438286881009879,"cycle":0.0017480146149075892,"orig":4.440034895624787,"zero":0},
{"x":137,"trend":4.4427642385793495,"cycle":0.0038403695788487013,"orig":4.446604608158198,"zero":0},
{"x":138,"trend":4.447138941021671,"cycle":-0.0065509881496179645,"orig":4.440587952872053,"zero":0},
{"x":139,"trend":4.451427350911766,"cycle":-0.01469238473322676,"orig":4.436734966178539,"zero":0},
{"x":140,"trend":4.455641736456961,"cycle":0.0015851307798557812,"orig":4.457226867236817,"zero":0},
{"x":141,"trend":4.459785183124122,"cycle":-0.00309064380226598,"orig":4.456694539321856,"zero":0},
{"x":142,"trend":4.463861767086852,"cycle":-0.000354228670144785,"orig":4.4635075384167076,"zero":0},
{"x":143,"trend":4.467873632866383,"cycle":-0.005124521614208177,"orig":4.462749111252175,"zero":0},
{"x":144,"trend":4.471822703591025,"cycle":-0.004553442745399039,"orig":4.467269260845626,"zero":0},
{"x":145,"trend":4.475707699563079,"cycle":-0.004127193612474933,"orig":4.471580505950604,"zero":0},
{"x":146,"trend":4.479524495183133,"cycle":-0.0018809095821810118,"orig":4.477643585600952,"zero":0},
{"x":147,"trend":4.483266385355767,"cycle":-0.003356747065369703,"orig":4.479909638290398,"zero":0},
{"x":148,"trend":4.486925489417073,"cycle":-0.004719865035169413,"orig":4.482205624381904,"zero":0},
{"x":149,"trend":4.4904918287362285,"cycle":-0.0019835570959392257,"orig":4.488508271640289,"zero":0},
{"x":150,"trend":4.493952474766759,"cycle":-0.00622888103847874,"orig":4.487723593728281,"zero":0},
{"x":151,"trend":4.497293259239006,"cycle":-0.0038001631927144786,"orig":4.493493096046292,"zero":0},
{"x":152,"trend":4.500496120832659,"cycle":-0.0029957816227419443,"orig":4.497500339209917,"zero":0},
{"x":153,"trend":4.503540623125412,"cycle":-0.010085544960947601,"orig":4.493455078164464,"zero":0},
{"x":154,"trend":4.506404457331447,"cycle":-0.0008004952681837096,"orig":4.5056039620632635,"zero":0},
{"x":155,"trend":4.5090590111993425,"cycle":0.0013806269653455772,"orig":4.510439638164688,"zero":0},
{"x":156,"trend":4.51147517216813,"cycle":0.00664799983170461,"orig":4.518123171999835,"zero":0},
{"x":157,"trend":4.513624690568699,"cycle":0.003129496045821689,"orig":4.516754186614521,"zero":0},
{"x":158,"trend":4.51548347173183,"cycle":0.00438914059368134,"orig":4.5198726123255115,"zero":0},
{"x":159,"trend":4.517029376923333,"cycle":0.006392647931857454,"orig":4.523422024855191,"zero":0},
{"x":160,"trend":4.51824301062189,"cycle":0.011113595644347996,"orig":4.529356606266238,"zero":0},
{"x":161,"trend":4.51910897271114,"cycle":0.01295166560850447,"orig":4.532060638319645,"zero":0},
{"x":162,"trend":4.519618809072,"cycle":0.01283228597402708,"orig":4.532451095046027,"zero":0},
{"x":163,"trend":4.519772160376389,"cycle":0.010726202216049252,"orig":4.530498362592438,"zero":0},
{"x":164,"trend":4.519576687474964,"cycle":0.00819504172471941,"orig":4.527771729199683,"zero":0},
{"x":165,"trend":4.519046755094763,"cycle":0.013329057129801036,"orig":4.532375812224564,"zero":0},
{"x":166,"trend":4.518201849863909,"cycle":0.010280577642947542,"orig":4.528482427506857,"zero":0},
{"x":167,"trend":4.51706978907123,"cycle":0.011692242910472217,"orig":4.528762031981702,"zero":0},
{"x":168,"trend":4.515684815366576,"cycle":0.009808845894818674,"orig":4.525493661261395,"zero":0},
{"x":169,"trend":4.514088479051621,"cycle":0.006634312858850855,"orig":4.5207227919104715,"zero":0},
{"x":170,"trend":4.512328460956723,"cycle":0.001859565819378517,"orig":4.514188026776101,"zero":0},
{"x":171,"trend":4.510456588357775,"cycle":0.001679026663083505,"orig":4.512135615020859,"zero":0},
{"x":172,"trend":4.508525850759307,"cycle":1.3383589212878633e-5,"orig":4.50853923434852,"zero":0},
{"x":173,"trend":4.506590287057511,"cycle":-0.0028383974946217805,"orig":4.503751889562889,"zero":0},
{"x":174,"trend":4.504703944513325,"cycle":-0.00624629886777317,"orig":4.498457645645551,"zero":0},
{"x":175,"trend":4.502919096389252,"cycle":-0.010886254015153085,"orig":4.4920328423740985,"zero":0},
{"x":176,"trend":4.501284112011004,"cycle":-0.010399709201996288,"orig":4.490884402809008,"zero":0},
{"x":177,"trend":4.499840556795536,"cycle":-0.014034029991291774,"orig":4.485806526804244,"zero":0},
{"x":178,"trend":4.498623496341548,"cycle":-0.01556218899164552,"orig":4.483061307349902,"zero":0},
{"x":179,"trend":4.497659224978996,"cycle":-0.020663377714412512,"orig":4.476995847264583,"zero":0},
{"x":180,"trend":4.49696431066972,"cycle":-0.020395973212537832,"orig":4.4765683374571825,"zero":0},
{"x":181,"trend":4.496542406764486,"cycle":-0.013341004466132844,"orig":4.483201402298353,"zero":0},
{"x":182,"trend":4.4963844191308,"cycle":-0.013067792149837665,"orig":4.483316626980963,"zero":0},
{"x":183,"trend":4.496472915508378,"cycle":-0.00594395583249252,"orig":4.490528959675886,"zero":0},
{"x":184,"trend":4.496782296266844,"cycle":-0.0013823344252790193,"orig":4.4953999618415645,"zero":0},
{"x":185,"trend":4.497283246803423,"cycle":0.002126343505501893,"orig":4.499409590308925,"zero":0},
{"x":186,"trend":4.497945588556329,"cycle":0.009679020989044496,"orig":4.507624609545373,"zero":0},
{"x":187,"trend":4.498740471928461,"cycle":0.008562166977411856,"orig":4.507302638905873,"zero":0},
{"x":188,"trend":4.49964509671084,"cycle":0.006546388671469394,"orig":4.50619148538231,"zero":0},
{"x":189,"trend":4.500642014048842,"cycle":0.0063981200300666785,"orig":4.507040134078909,"zero":0},
{"x":190,"trend":4.501717866580764,"cycle":0.0032374311612102247,"orig":4.504955297741974,"zero":0},
{"x":191,"trend":4.502863295769922,"cycle":0.00767857788937043,"orig":4.510541873659292,"zero":0},
{"x":192,"trend":4.504070966474109,"cycle":0.0008942798942639385,"orig":4.504965246368373,"zero":0},
{"x":193,"trend":4.505338342662304,"cycle":0.008112309429968434,"orig":4.513450652092272,"zero":0},
{"x":194,"trend":4.506663447228414,"cycle":0.007974625791785428,"orig":4.514638073020199,"zero":0},
{"x":195,"trend":4.50804937325974,"cycle":0.003956728412831012,"orig":4.512006101672571,"zero":0},
{"x":196,"trend":4.509504197984702,"cycle":-0.0034728116212168203,"orig":4.506031386363485,"zero":0},
{"x":197,"trend":4.511038471586978,"cycle":-0.005279864654301747,"orig":4.505758606932676,"zero":0},
{"x":198,"trend":4.512660573742977,"cycle":-0.005624852098749855,"orig":4.507035721644227,"zero":0},
{"x":199,"trend":4.514375584213702,"cycle":-0.0022147270188757062,"orig":4.512160857194826,"zero":0},
{"x":200,"trend":4.516185067227588,"cycle":-0.006208367852736707,"orig":4.509976699374851,"zero":0},
{"x":201,"trend":4.518089202808685,"cycle":-0.001685751731694829,"orig":4.51640345107699,"zero":0},
{"x":202,"trend":4.520084290751138,"cycle":-0.0024499829157296205,"orig":4.517634307835408,"zero":0},
{"x":203,"trend":4.522165577254255,"cycle":0.0021513226303495614,"orig":4.524316899884605,"zero":0},
{"x":204,"trend":4.5243267772780245,"cycle":0.00028606863599023313,"orig":4.524612845914015,"zero":0},
{"x":205,"trend":4.526562950359076,"cycle":-0.0004294782260272356,"orig":4.526133472133049,"zero":0},
{"x":206,"trend":4.528869334826937,"cycle":0.003278443415272392,"orig":4.5321477782422095,"zero":0},
{"x":207,"trend":4.531240900587244,"cycle":-0.0031018781938030315,"orig":4.528139022393441,"zero":0},
{"x":208,"trend":4.5336746665727725,"cycle":-0.0018281450035244617,"orig":4.531846521569248,"zero":0},
{"x":209,"trend":4.536165713042424,"cycle":0.0028785592335616172,"orig":4.539044272275985,"zero":0},
{"x":210,"trend":4.538707977664473,"cycle":-0.007496544194676602,"orig":4.531211433469797,"zero":0},
{"x":211,"trend":4.541297197206716,"cycle":-0.0026418840532524968,"orig":4.5386553131534635,"zero":0},
{"x":212,"trend":4.5439244230968265,"cycle":-0.004598143223994988,"orig":4.5393262798728315,"zero":0},
{"x":213,"trend":4.546579055584947,"cycle":-0.005982591353960842,"orig":4.540596464230986,"zero":0},
{"x":214,"trend":4.549247621081704,"cycle":-0.00015584411348434912,"orig":4.549091776968219,"zero":0},
{"x":215,"trend":4.551912906878131,"cycle":-0.0003407744589178918,"orig":4.5515721324192135,"zero":0},
{"x":216,"trend":4.554557602862696,"cycle":0.00495077055745341,"orig":4.559508373420149,"zero":0},
{"x":217,"trend":4.557164185939824,"cycle":0.00593426659619567,"orig":4.563098452536019,"zero":0},
{"x":218,"trend":4.559718227245542,"cycle":0.010613071353248849,"orig":4.5703312985987905,"zero":0},
{"x":219,"trend":4.562209006832499,"cycle":0.006770111986673655,"orig":4.568979118819173,"zero":0},
{"x":220,"trend":4.564632437922941,"cycle":0.006496876340054136,"orig":4.571129314262995,"zero":0},
{"x":221,"trend":4.566988665059106,"cycle":0.00504036973074129,"orig":4.572029034789847,"zero":0},
{"x":222,"trend":4.569281893330941,"cycle":0.007234670616369954,"orig":4.576516563947311,"zero":0},
{"x":223,"trend":4.571519478059477,"cycle":0.0018256195996171343,"orig":4.573345097659094,"zero":0},
{"x":224,"trend":4.573713296234877,"cycle":0.002885589770778907,"orig":4.576598886005656,"zero":0},
{"x":225,"trend":4.575876365859555,"cycle":-0.01884130862344513,"orig":4.55703505723611,"zero":0},
{"x":226,"trend":4.578023508429524,"cycle":-0.00892412178620372,"orig":4.5690993866433205,"zero":0},
{"x":227,"trend":4.580157769622908,"cycle":0.00011913364190707654,"orig":4.580276903264815,"zero":0},
{"x":228,"trend":4.582276617541716,"cycle":0.0031519792873311303,"orig":4.585428596829047,"zero":0},
{"x":229,"trend":4.584377594746481,"cycle":0.002627602283481245,"orig":4.587005197029963,"zero":0},
{"x":230,"trend":4.586460213784796,"cycle":0.0009664834255049826,"orig":4.587426697210301,"zero":0},
{"x":231,"trend":4.588525629455674,"cycle":0.0011531824143728997,"orig":4.589678811870047,"zero":0},
{"x":232,"trend":4.590575600610268,"cycle":0.0021352897030499918,"orig":4.592710890313318,"zero":0},
{"x":233,"trend":4.592612606838736,"cycle":0.00035239803099340605,"orig":4.592965004869729,"zero":0},
{"x":234,"trend":4.594640462287297,"cycle":0.0014859517988563553,"orig":4.596126414086154,"zero":0},
{"x":235,"trend":4.5966632013509425,"cycle":-0.0010495337703204655,"orig":4.595613667580622,"zero":0},
{"x":236,"trend":4.598685787144532,"cycle":0.0013070193144235631,"orig":4.599992806458956,"zero":0},
{"x":237,"trend":4.600712526824328,"cycle":-0.0023826827223114577,"orig":4.598329844102016,"zero":0},
{"x":238,"trend":4.602748544433659,"cycle":-0.005566176287769231,"orig":4.59718236814589,"zero":0},
{"x":239,"trend":4.604797474839157,"cycle":-0.008035539321603835,"orig":4.596761935517553,"zero":0},
{"x":240,"trend":4.606859474047271,"cycle":4.420856697162634e-5,"orig":4.606903682614242,"zero":0},
{"x":241,"trend":4.608929675852375,"cycle":-0.0054148592324487765,"orig":4.603514816619926,"zero":0},
{"x":242,"trend":4.611003241679193,"cycle":0.0018900442484071078,"orig":4.6128932859276,"zero":0},
{"x":243,"trend":4.613071948665431,"cycle":0.0015999527114720635,"orig":4.614671901376903,"zero":0},
{"x":244,"trend":4.615128755226451,"cycle":0.006243466052205271,"orig":4.621372221278656,"zero":0},
{"x":245,"trend":4.617167619748056,"cycle":0.005160523005410589,"orig":4.622328142753466,"zero":0},
{"x":246,"trend":4.619186402782332,"cycle":0.0037185877548422397,"orig":4.622904990537174,"zero":0},
{"x":247,"trend":4.621186190208242,"cycle":0.0005185436189396597,"orig":4.6217047338271815,"zero":0},
{"x":248,"trend":4.623170392022096,"cycle":0.0004583811899347978,"orig":4.6236287732120305,"zero":0},
{"x":249,"trend":4.625142742309964,"cycle":0.0007061576864844099,"orig":4.625848899996448,"zero":0},
{"x":250,"trend":4.627107261646163,"cycle":-0.004082422864229329,"orig":4.623024838781934,"zero":0},
{"x":251,"trend":4.629068411953562,"cycle":-0.0007228613749141743,"orig":4.628345550578648,"zero":0},
{"x":252,"trend":4.631028103640739,"cycle":-0.0023337923557784634,"orig":4.628694311284961,"zero":0}];
    const series = [{"name":"Cycle","color":"#2ca02c","key":"cycle","dash":""}];
    const bands = [];
    const refLines = [{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#filt_cy_62');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Cycle') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Cycle');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>