<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GARCH(1,1) — Diagnostic Plots</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">GARCH(1,1) — Diagnostic Plots</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">Returns</div>
<div id="vol_ret_81"></div>
</div>
<div class="panel">
<div class="panel-title">Conditional Volatility</div>
<div id="vol_sig_82"></div>
</div>
<div class="panel">
<div class="panel-title">Standardized Residuals</div>
<div id="vol_zr_83"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":1,"ret":0.2088332105422406,"vol":0.963670484654648,"std_resid":0.21670603579508868},
{"x":2,"ret":0.4384722422321556,"vol":0.9638706015875961,"std_resid":0.45490778690619443},
{"x":3,"ret":0.4725842035933498,"vol":0.9640660662452317,"std_resid":0.4901989813145622},
{"x":4,"ret":1.6201447720624402,"vol":0.9642569877011173,"std_resid":1.6802001880484405},
{"x":5,"ret":0.28045405795416234,"vol":0.9644434724290334,"std_resid":0.29079367113949645},
{"x":6,"ret":1.2983159215175022,"vol":0.9646256243668918,"std_resid":1.3459272579137838},
{"x":7,"ret":-0.01987996243675271,"vol":0.9648035449790658,"std_resid":-0.020605192155657},
{"x":8,"ret":0.21824565572954072,"vol":0.9649773333170001,"std_resid":0.22616661365438093},
{"x":9,"ret":0.25509660863237965,"vol":0.9651470860783395,"std_resid":0.2643085311161307},
{"x":10,"ret":-0.11999203046929163,"vol":0.9653128976644727,"std_resid":-0.12430376799026148},
{"x":11,"ret":-0.7174524918352548,"vol":0.9654748602366175,"std_resid":-0.7431084136767915},
{"x":12,"ret":-0.21424087596888453,"vol":0.9656330637704622,"std_resid":-0.22186572105593425},
{"x":13,"ret":-0.4694096628322326,"vol":0.9657875961093959,"std_resid":-0.4860381979673531},
{"x":14,"ret":1.5834667570079413,"vol":0.9659385430163944,"std_resid":1.6393038340339483},
{"x":15,"ret":0.6132359583166904,"vol":0.9660859882245701,"std_resid":0.6347633293426274},
{"x":16,"ret":-1.59366826383876,"vol":0.9662300134864111,"std_resid":-1.649367377948018},
{"x":17,"ret":-1.518919919412247,"vol":0.9663706986218394,"std_resid":-1.5717777055724154},
{"x":18,"ret":1.3585377890997221,"vol":0.966508121564957,"std_resid":1.4056144576415932},
{"x":19,"ret":-0.4835243227290544,"vol":0.9666423584096829,"std_resid":-0.5002101537579494},
{"x":20,"ret":-2.250502757283063,"vol":0.9667734834542006,"std_resid":-2.3278490730240193},
{"x":21,"ret":0.3193832464242711,"vol":0.9669015692443208,"std_resid":0.33031619410224367},
{"x":22,"ret":-0.70656180301821,"vol":0.9670266866156555,"std_resid":-0.7306538824600534},
{"x":23,"ret":-0.5381929256618667,"vol":0.9671489047348997,"std_resid":-0.5564736960637805},
{"x":24,"ret":-0.1561158927236592,"vol":0.9672682911399202,"std_resid":-0.16139874960614858},
{"x":25,"ret":0.6037225274273443,"vol":0.9673849117789246,"std_resid":0.6240768489113176},
{"x":26,"ret":1.2657433557326152,"vol":0.9674988310486338,"std_resid":1.3082634470583556},
{"x":27,"ret":-1.1505071143854853,"vol":0.9676101118315,"std_resid":-1.1890193170964247},
{"x":28,"ret":-0.9158592464479492,"vol":0.9677188155319937,"std_resid":-0.9464104983268976},
{"x":29,"ret":0.5879337179676579,"vol":0.9678250021120066,"std_resid":0.6074793652619611},
{"x":30,"ret":-0.41282154828080614,"vol":0.9679287301253634,"std_resid":-0.42649994305607464},
{"x":31,"ret":-0.2429218347940629,"vol":0.9680300567514821,"std_resid":-0.2509445167531891},
{"x":32,"ret":-0.03516866082973856,"vol":0.9681290378282006,"std_resid":-0.03632641874747632},
{"x":33,"ret":-1.1741778355680308,"vol":0.9682257278837946,"std_resid":-1.2127108397897834},
{"x":34,"ret":1.2286976023402392,"vol":0.9683201801682116,"std_resid":1.2688959989729802},
{"x":35,"ret":0.36443715993347037,"vol":0.968412446683518,"std_resid":0.3763243246010966},
{"x":36,"ret":0.863519047346861,"vol":0.9685025782136187,"std_resid":0.8916022184882589},
{"x":37,"ret":-0.6110236695657176,"vol":0.9685906243532516,"std_resid":-0.6308378939489643},
{"x":38,"ret":-1.0731628669281819,"vol":0.9686766335362399,"std_resid":-1.1078649259975495},
{"x":39,"ret":-0.558994605387216,"vol":0.9687606530630894,"std_resid":-0.5770203441064117},
{"x":40,"ret":0.05819751744237116,"vol":0.9688427291278798,"std_resid":0.06006910687636438},
{"x":41,"ret":1.5143016801942752,"vol":0.9689229068445301,"std_resid":1.5628711732348946},
{"x":42,"ret":-0.6268646591147701,"vol":0.9690012302724093,"std_resid":-0.6469183315056716},
{"x":43,"ret":-1.1987953363968185,"vol":0.9690777424412949,"std_resid":-1.2370476422013579},
{"x":44,"ret":1.899472039842352,"vol":0.9691524853757971,"std_resid":1.9599310413013236},
{"x":45,"ret":-0.09971254641057269,"vol":0.9692255001191175,"std_resid":-0.10287858336199167},
{"x":46,"ret":0.009760745845731295,"vol":0.9692968267562437,"std_resid":0.010069924481642714},
{"x":47,"ret":1.545285105465797,"vol":0.9693665044366488,"std_resid":1.5941185283308767},
{"x":48,"ret":-1.4799904964815829,"vol":0.9694345713963578,"std_resid":-1.526653309206653},
{"x":49,"ret":0.6579032422092371,"vol":0.969501064979502,"std_resid":0.6785998138363541},
{"x":50,"ret":0.018781499514349355,"vol":0.9695660216593827,"std_resid":0.019371037242214194},
{"x":51,"ret":0.43823774231229634,"vol":0.9696294770590147,"std_resid":0.4519641292687555},
{"x":52,"ret":-0.8184545502763483,"vol":0.9696914659711567,"std_resid":-0.8440360454824226},
{"x":53,"ret":-0.4364375470212315,"vol":0.9697520223778732,"std_resid":-0.45005066960424384},
{"x":54,"ret":1.5083581349182493,"vol":0.9698111794696208,"std_resid":1.5553111439106673},
{"x":55,"ret":-0.399833933142405,"vol":0.969868969663894,"std_resid":-0.4122556197266179},
{"x":56,"ret":0.6776588566587324,"vol":0.9699254246233766,"std_resid":0.698671093111997},
{"x":57,"ret":-0.25870957887814156,"vol":0.9699805752737314,"std_resid":-0.2667162471837469},
{"x":58,"ret":-0.3325448241067508,"vol":0.9700344518208914,"std_resid":-0.342817539606472},
{"x":59,"ret":-0.7045956337428738,"vol":0.9700870837679814,"std_resid":-0.726322044208759},
{"x":60,"ret":-0.475919965044083,"vol":0.9701384999318166,"std_resid":-0.490569094080414},
{"x":61,"ret":-0.1609112014771097,"vol":0.9701887284590088,"std_resid":-0.1658555668160479},
{"x":62,"ret":0.6167444193105983,"vol":0.9702377968416962,"std_resid":0.6356631552782377},
{"x":63,"ret":1.656725291225609,"vol":0.9702857319328906,"std_resid":1.7074612525995545},
{"x":64,"ret":-1.115507949315443,"vol":0.9703325599614641,"std_resid":-1.1496140553706087},
{"x":65,"ret":-1.0786607458137447,"vol":0.9703783065467517,"std_resid":-1.1115878606688288},
{"x":66,"ret":0.8024570646067546,"vol":0.9704229967128645,"std_resid":0.8269147241202397},
{"x":67,"ret":0.8848294326243195,"vol":0.9704666549026049,"std_resid":0.9117566566087941},
{"x":68,"ret":-1.0237559862922225,"vol":0.9705093049910828,"std_resid":-1.0548646788107086},
{"x":69,"ret":0.19164735276562897,"vol":0.9705509702989938,"std_resid":0.1974624297233858},
{"x":70,"ret":0.13301422503123553,"vol":0.9705916736055856,"std_resid":0.1370444736426699},
{"x":71,"ret":-0.4792172281770884,"vol":0.9706314371613288,"std_resid":-0.49371698652022705},
{"x":72,"ret":0.2939583971472789,"vol":0.9706702827002687,"std_resid":0.30284062712781096},
{"x":73,"ret":-1.0602586327856445,"vol":0.9707082314520932,"std_resid":-1.0922526444424931},
{"x":74,"ret":-0.026493476200401492,"vol":0.9707453041539208,"std_resid":-0.027291892205950557},
{"x":75,"ret":1.644352653793086,"vol":0.9707815210617898,"std_resid":1.6938442050221345},
{"x":76,"ret":-1.272674368713393,"vol":0.9708169019619167,"std_resid":-1.3109314085297183},
{"x":77,"ret":-0.34438109788519616,"vol":0.9708514661816205,"std_resid":-0.3547206857910555},
{"x":78,"ret":1.2497844874830284,"vol":0.9708852326000637,"std_resid":1.2872628458217075},
{"x":79,"ret":1.007692869460378,"vol":0.9709182196587048,"std_resid":1.037876155846164},
{"x":80,"ret":-2.183101935152624,"vol":0.9709504453714811,"std_resid":-2.2484174610140677},
{"x":81,"ret":-1.95694257620551,"vol":0.9709819273348086,"std_resid":-2.0154263649139246},
{"x":82,"ret":0.5115918005306112,"vol":0.9710126827372674,"std_resid":0.5268641796608083},
{"x":83,"ret":0.7868160673314945,"vol":0.971042728369138,"std_resid":0.8102795524280879},
{"x":84,"ret":-0.4318914694159917,"vol":0.971072080631693,"std_resid":-0.4447573748954265},
{"x":85,"ret":0.08450767412628944,"vol":0.971100755546223,"std_resid":0.08702256037145777},
{"x":86,"ret":0.3627089596358936,"vol":0.9711287687629013,"std_resid":0.37349213750298044},
{"x":87,"ret":0.4057153815080021,"vol":0.9711561355694197,"std_resid":0.417765348586423},
{"x":88,"ret":0.648356747464586,"vol":0.9711828708994231,"std_resid":0.6675949163561089},
{"x":89,"ret":-2.3422253505792994,"vol":0.9712089893407497,"std_resid":-2.41165946391125},
{"x":90,"ret":0.058537307292524224,"vol":0.9712345051434884,"std_resid":0.060271033393604595},
{"x":91,"ret":1.2407776250140905,"vol":0.971259432227773,"std_resid":1.2774935139297694},
{"x":92,"ret":-0.671120074880389,"vol":0.9712837841915551,"std_resid":-0.6909618854998116},
{"x":93,"ret":0.6545125074113552,"vol":0.9713075743180111,"std_resid":0.6738468068375884},
{"x":94,"ret":1.4627322738064892,"vol":0.9713308155828992,"std_resid":1.5059053520593786},
{"x":95,"ret":-0.4026323321259725,"vol":0.9713535206616949,"std_resid":-0.4145064835423623},
{"x":96,"ret":0.2478964729796932,"vol":0.9713757019365481,"std_resid":0.2552014349190363},
{"x":97,"ret":0.6378644683857844,"vol":0.9713973715031318,"std_resid":0.656646277927187},
{"x":98,"ret":-1.0784077774543137,"vol":0.9714185411772736,"std_resid":-1.1101371157146935},
{"x":99,"ret":0.6661928537123607,"vol":0.9714392225014588,"std_resid":0.6857792420578945},
{"x":100,"ret":-1.3601924980733364,"vol":0.9714594267511713,"std_resid":-1.40015368693492},
{"x":101,"ret":0.5950165375641198,"vol":0.9714791649411079,"std_resid":0.6124851247841124},
{"x":102,"ret":-0.14126834445413233,"vol":0.9714984478312054,"std_resid":-0.14541283598497035},
{"x":103,"ret":-1.3546396920477852,"vol":0.9715172859325802,"std_resid":-1.3943546982259174},
{"x":104,"ret":-0.7149103634153315,"vol":0.9715356895132918,"std_resid":-0.7358559969870779},
{"x":105,"ret":-0.30829894213322245,"vol":0.9715536686039628,"std_resid":-0.3173256939847913},
{"x":106,"ret":-0.5558008236381837,"vol":0.9715712330033143,"std_resid":-0.5720638948109816},
{"x":107,"ret":0.11842629292379253,"vol":0.9715883922835318,"std_resid":0.12188936576882552},
{"x":108,"ret":1.4784668469101363,"vol":0.9716051557955145,"std_resid":1.5216745589412008},
{"x":109,"ret":0.3450991513310631,"vol":0.9716215326740197,"std_resid":0.3551785749141526},
{"x":110,"ret":-0.7875438839569323,"vol":0.971637531842643,"std_resid":-0.8105325886942738},
{"x":111,"ret":-2.459079052486651,"vol":0.9716531620187542,"std_resid":-2.530819791063663},
{"x":112,"ret":1.985713821808472,"vol":0.9716684317182634,"std_resid":2.043612570902409},
{"x":113,"ret":0.32277864640718545,"vol":0.9716833492602449,"std_resid":0.33218501341298173},
{"x":114,"ret":1.8546881587438901,"vol":0.9716979227715521,"std_resid":1.9087085762762617},
{"x":115,"ret":1.6327579825632743,"vol":0.9717121601912814,"std_resid":1.6802897498389504},
{"x":116,"ret":0.23699866408894116,"vol":0.9717260692750597,"std_resid":0.2438945208763928},
{"x":117,"ret":0.1938232907826632,"vol":0.9717396575993349,"std_resid":0.19946010154767183},
{"x":118,"ret":0.9690563038822385,"vol":0.9717529325655327,"std_resid":0.9972249852890335},
{"x":119,"ret":-1.0490474709800932,"vol":0.9717659014040904,"std_resid":-1.0795269410712394},
{"x":120,"ret":-0.7696881032986889,"vol":0.971778571178416,"std_resid":-0.7920406213169894},
{"x":121,"ret":-0.42308277859212345,"vol":0.9717909487887614,"std_resid":-0.43536398349815164},
{"x":122,"ret":0.30928199837740133,"vol":0.971803040976,"std_resid":0.31825584540956325},
{"x":123,"ret":0.8904646200777416,"vol":0.9718148543253154,"std_resid":0.9162903984380323},
{"x":124,"ret":-0.9264139330741645,"vol":0.971826395269805,"std_resid":-0.9532710138182316},
{"x":125,"ret":0.9791979163882076,"vol":0.9718376700939935,"std_resid":1.0075735346763233},
{"x":126,"ret":-1.3828053601964323,"vol":0.9718486849372784,"std_resid":-1.4228607617920237},
{"x":127,"ret":-1.986484629440342,"vol":0.9718594457972872,"std_resid":-2.044004035800345},
{"x":128,"ret":-0.8566022313678463,"vol":0.9718699585331562,"std_resid":-0.8813959355845472},
{"x":129,"ret":-0.5228187593686185,"vol":0.9718802288687144,"std_resid":-0.5379456684463977},
{"x":130,"ret":0.38699283912599847,"vol":0.9718902623956569,"std_resid":0.39818573567357496},
{"x":131,"ret":0.6311105096037605,"vol":0.9719000645765694,"std_resid":0.6493574109172616},
{"x":132,"ret":-2.2156582542334338,"vol":0.9719096407479216,"std_resid":-2.2796957261668895},
{"x":133,"ret":0.22006438651225776,"vol":0.9719189961229959,"std_resid":0.2264225592771609},
{"x":134,"ret":-1.2966962818325518,"vol":0.9719281357946825,"std_resid":-1.3341483120789868},
{"x":135,"ret":0.12913907274949055,"vol":0.9719370647383527,"std_resid":0.1328677312910739},
{"x":136,"ret":-0.6706073470895847,"vol":0.9719457878144984,"std_resid":-0.6899637361436604},
{"x":137,"ret":-1.3920969135607244,"vol":0.9719543097714337,"std_resid":-1.4322657964118624},
{"x":138,"ret":-0.7698577304637512,"vol":0.9719626352478692,"std_resid":-0.792065149981226},
{"x":139,"ret":-0.6403040790449113,"vol":0.9719707687754366,"std_resid":-0.6587688638534012},
{"x":140,"ret":0.09192223719142951,"vol":0.9719787147811876,"std_resid":0.09457227385079425},
{"x":141,"ret":-0.44595412461193007,"vol":0.9719864775899949,"std_resid":-0.4588069226206285},
{"x":142,"ret":-0.8684779465340083,"vol":0.9719940614269202,"std_resid":-0.8935012887414695},
{"x":143,"ret":1.0116831076128363,"vol":0.9720014704195178,"std_resid":1.0408246678641255},
{"x":144,"ret":-0.5811084214553092,"vol":0.9720087086000866,"std_resid":-0.5978428138696795},
{"x":145,"ret":1.0593932021147066,"vol":0.9720157799078706,"std_resid":1.0898930079253628},
{"x":146,"ret":1.1821782874978086,"vol":0.9720226881912191,"std_resid":1.2162044177154507},
{"x":147,"ret":-0.23344395094350798,"vol":0.972029437209673,"std_resid":-0.24016140047531565},
{"x":148,"ret":1.4223996688457998,"vol":0.9720360306360191,"std_resid":1.463319901747984},
{"x":149,"ret":0.9282411501765593,"vol":0.9720424720583126,"std_resid":0.9549388806139268},
{"x":150,"ret":0.939487795875224,"vol":0.9720487649818005,"std_resid":0.9665027411385209},
{"x":151,"ret":-1.1749982763140374,"vol":0.9720549128308659,"std_resid":-1.2087776737758056},
{"x":152,"ret":-0.7934506135951656,"vol":0.9720609189508814,"std_resid":-0.8162560577494617},
{"x":153,"ret":1.382501018288413,"vol":0.9720667866100312,"std_resid":1.4222284284701496},
{"x":154,"ret":-0.6613462785784165,"vol":0.9720725190011079,"std_resid":-0.6803466466246875},
{"x":155,"ret":0.9428755689280497,"vol":0.97207811924323,"std_resid":0.9699586383675474},
{"x":156,"ret":-0.49557300638543084,"vol":0.9720835903835718,"std_resid":-0.5098049296253258},
{"x":157,"ret":-0.4598402502641967,"vol":0.9720889353990013,"std_resid":-0.4730433950217238},
{"x":158,"ret":0.28129575649935373,"vol":0.9720941571977183,"std_resid":0.2893708952127153},
{"x":159,"ret":-0.5178240340695159,"vol":0.972099258620832,"std_resid":-0.5326863789652303},
{"x":160,"ret":-1.3815426391665615,"vol":0.9721042424439144,"std_resid":-1.421187748027208},
{"x":161,"ret":1.502711573684822,"vol":0.9721091113785147,"std_resid":1.5458260354682594},
{"x":162,"ret":-0.4431399891208335,"vol":0.9721138680736264,"std_resid":-0.455851936356977},
{"x":163,"ret":0.2585764750416383,"vol":0.972118515117136,"std_resid":0.2659927478189025},
{"x":164,"ret":-1.7095032286358498,"vol":0.9721230550372503,"std_resid":-1.7585255485688942},
{"x":165,"ret":-1.5897575243606703,"vol":0.9721274903038643,"std_resid":-1.6353385129184541},
{"x":166,"ret":-0.11419463655310703,"vol":0.972131823329885,"std_resid":-0.11746826285549548},
{"x":167,"ret":0.045466532570209814,"vol":0.9721360564725692,"std_resid":0.04676972144741423},
{"x":168,"ret":-0.653229380434178,"vol":0.9721401920348187,"std_resid":-0.6719497720456162},
{"x":169,"ret":-0.05142140675282799,"vol":0.9721442322664146,"std_resid":-0.05289483293332551},
{"x":170,"ret":0.27205117912114607,"vol":0.9721481793652456,"std_resid":0.27984538252057334},
{"x":171,"ret":0.745312260251881,"vol":0.9721520354785135,"std_resid":0.7666622432004916},
{"x":172,"ret":-0.11035395888602917,"vol":0.9721558027038995,"std_resid":-0.11351468414743489},
{"x":173,"ret":0.432364067831331,"vol":0.9721594830907014,"std_resid":0.4447460271197004},
{"x":174,"ret":-1.19819001580385,"vol":0.9721630786409619,"std_resid":-1.2324989933570232},
{"x":175,"ret":0.2983284889136429,"vol":0.9721665913105528,"std_resid":0.30686971922319806},
{"x":176,"ret":-0.021512606705105092,"vol":0.9721700230102297,"std_resid":-0.022128440700622923},
{"x":177,"ret":1.131813828761745,"vol":0.9721733756066954,"std_resid":1.1642098592295065},
{"x":178,"ret":0.783212207126035,"vol":0.9721766509236047,"std_resid":0.8056274612046624},
{"x":179,"ret":-0.025703397311993892,"vol":0.9721798507425482,"std_resid":-0.02643893235635537},
{"x":180,"ret":-0.23281054824649824,"vol":0.972182976804038,"std_resid":-0.2394719448923509},
{"x":181,"ret":-1.0032054239549346,"vol":0.9721860308084518,"std_resid":-1.0319068492690515},
{"x":182,"ret":0.8354753313942387,"vol":0.9721890144169582,"std_resid":0.8593754084901798},
{"x":183,"ret":-0.5732709973166978,"vol":0.972191929252413,"std_resid":-0.5896685418459772},
{"x":184,"ret":1.1450568162366033,"vol":0.9721947769002544,"std_resid":1.1778059741150866},
{"x":185,"ret":0.8783648313226607,"vol":0.9721975589093659,"std_resid":0.903483888920716},
{"x":186,"ret":-0.24888300727752527,"vol":0.9722002767929075,"std_resid":-0.2559997288815223},
{"x":187,"ret":0.7228996624267281,"vol":0.9722029320291522,"std_resid":0.7435686918963658},
{"x":188,"ret":-0.12041647632534423,"vol":0.9722055260622908,"std_resid":-0.12385907413329077},
{"x":189,"ret":-1.4352318894349707,"vol":0.9722080603032076,"std_resid":-1.4762600188557966},
{"x":190,"ret":0.8855858383172982,"vol":0.972210536130266,"std_resid":0.9108992398315657},
{"x":191,"ret":-0.9025208818149901,"vol":0.97221295489003,"std_resid":-0.9283160415375015},
{"x":192,"ret":-0.12074409616803661,"vol":0.97221531789803,"std_resid":-0.12419480946781458},
{"x":193,"ret":0.17269602853502322,"vol":0.9722176264394573,"std_resid":0.17763104045694597},
{"x":194,"ret":1.3197102226275068,"vol":0.9722198817698763,"std_resid":1.357419496734671},
{"x":195,"ret":0.32175060242573034,"vol":0.972222085115905,"std_resid":0.3309435234516117},
{"x":196,"ret":-0.7908568134899913,"vol":0.9722242376758649,"std_resid":-0.8134510361319127},
{"x":197,"ret":0.3874579326049864,"vol":0.9722263406204653,"std_resid":0.3985264710661044},
{"x":198,"ret":1.5677556877923258,"vol":0.9722283950934147,"std_resid":1.6125384690514937},
{"x":199,"ret":1.7762816619624333,"vol":0.9722304022120638,"std_resid":1.8270171946083507},
{"x":200,"ret":1.9489452010696782,"vol":0.972232363067989,"std_resid":2.0046084404345086}];
    const series = [{"name":"Returns","color":"#1f77b4","key":"ret","dash":""}];
    const bands = [];
    const refLines = [{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#vol_ret_81');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');
    if('Returns') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Returns');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"ret":0.2088332105422406,"vol":0.963670484654648,"std_resid":0.21670603579508868},
{"x":2,"ret":0.4384722422321556,"vol":0.9638706015875961,"std_resid":0.45490778690619443},
{"x":3,"ret":0.4725842035933498,"vol":0.9640660662452317,"std_resid":0.4901989813145622},
{"x":4,"ret":1.6201447720624402,"vol":0.9642569877011173,"std_resid":1.6802001880484405},
{"x":5,"ret":0.28045405795416234,"vol":0.9644434724290334,"std_resid":0.29079367113949645},
{"x":6,"ret":1.2983159215175022,"vol":0.9646256243668918,"std_resid":1.3459272579137838},
{"x":7,"ret":-0.01987996243675271,"vol":0.9648035449790658,"std_resid":-0.020605192155657},
{"x":8,"ret":0.21824565572954072,"vol":0.9649773333170001,"std_resid":0.22616661365438093},
{"x":9,"ret":0.25509660863237965,"vol":0.9651470860783395,"std_resid":0.2643085311161307},
{"x":10,"ret":-0.11999203046929163,"vol":0.9653128976644727,"std_resid":-0.12430376799026148},
{"x":11,"ret":-0.7174524918352548,"vol":0.9654748602366175,"std_resid":-0.7431084136767915},
{"x":12,"ret":-0.21424087596888453,"vol":0.9656330637704622,"std_resid":-0.22186572105593425},
{"x":13,"ret":-0.4694096628322326,"vol":0.9657875961093959,"std_resid":-0.4860381979673531},
{"x":14,"ret":1.5834667570079413,"vol":0.9659385430163944,"std_resid":1.6393038340339483},
{"x":15,"ret":0.6132359583166904,"vol":0.9660859882245701,"std_resid":0.6347633293426274},
{"x":16,"ret":-1.59366826383876,"vol":0.9662300134864111,"std_resid":-1.649367377948018},
{"x":17,"ret":-1.518919919412247,"vol":0.9663706986218394,"std_resid":-1.5717777055724154},
{"x":18,"ret":1.3585377890997221,"vol":0.966508121564957,"std_resid":1.4056144576415932},
{"x":19,"ret":-0.4835243227290544,"vol":0.9666423584096829,"std_resid":-0.5002101537579494},
{"x":20,"ret":-2.250502757283063,"vol":0.9667734834542006,"std_resid":-2.3278490730240193},
{"x":21,"ret":0.3193832464242711,"vol":0.9669015692443208,"std_resid":0.33031619410224367},
{"x":22,"ret":-0.70656180301821,"vol":0.9670266866156555,"std_resid":-0.7306538824600534},
{"x":23,"ret":-0.5381929256618667,"vol":0.9671489047348997,"std_resid":-0.5564736960637805},
{"x":24,"ret":-0.1561158927236592,"vol":0.9672682911399202,"std_resid":-0.16139874960614858},
{"x":25,"ret":0.6037225274273443,"vol":0.9673849117789246,"std_resid":0.6240768489113176},
{"x":26,"ret":1.2657433557326152,"vol":0.9674988310486338,"std_resid":1.3082634470583556},
{"x":27,"ret":-1.1505071143854853,"vol":0.9676101118315,"std_resid":-1.1890193170964247},
{"x":28,"ret":-0.9158592464479492,"vol":0.9677188155319937,"std_resid":-0.9464104983268976},
{"x":29,"ret":0.5879337179676579,"vol":0.9678250021120066,"std_resid":0.6074793652619611},
{"x":30,"ret":-0.41282154828080614,"vol":0.9679287301253634,"std_resid":-0.42649994305607464},
{"x":31,"ret":-0.2429218347940629,"vol":0.9680300567514821,"std_resid":-0.2509445167531891},
{"x":32,"ret":-0.03516866082973856,"vol":0.9681290378282006,"std_resid":-0.03632641874747632},
{"x":33,"ret":-1.1741778355680308,"vol":0.9682257278837946,"std_resid":-1.2127108397897834},
{"x":34,"ret":1.2286976023402392,"vol":0.9683201801682116,"std_resid":1.2688959989729802},
{"x":35,"ret":0.36443715993347037,"vol":0.968412446683518,"std_resid":0.3763243246010966},
{"x":36,"ret":0.863519047346861,"vol":0.9685025782136187,"std_resid":0.8916022184882589},
{"x":37,"ret":-0.6110236695657176,"vol":0.9685906243532516,"std_resid":-0.6308378939489643},
{"x":38,"ret":-1.0731628669281819,"vol":0.9686766335362399,"std_resid":-1.1078649259975495},
{"x":39,"ret":-0.558994605387216,"vol":0.9687606530630894,"std_resid":-0.5770203441064117},
{"x":40,"ret":0.05819751744237116,"vol":0.9688427291278798,"std_resid":0.06006910687636438},
{"x":41,"ret":1.5143016801942752,"vol":0.9689229068445301,"std_resid":1.5628711732348946},
{"x":42,"ret":-0.6268646591147701,"vol":0.9690012302724093,"std_resid":-0.6469183315056716},
{"x":43,"ret":-1.1987953363968185,"vol":0.9690777424412949,"std_resid":-1.2370476422013579},
{"x":44,"ret":1.899472039842352,"vol":0.9691524853757971,"std_resid":1.9599310413013236},
{"x":45,"ret":-0.09971254641057269,"vol":0.9692255001191175,"std_resid":-0.10287858336199167},
{"x":46,"ret":0.009760745845731295,"vol":0.9692968267562437,"std_resid":0.010069924481642714},
{"x":47,"ret":1.545285105465797,"vol":0.9693665044366488,"std_resid":1.5941185283308767},
{"x":48,"ret":-1.4799904964815829,"vol":0.9694345713963578,"std_resid":-1.526653309206653},
{"x":49,"ret":0.6579032422092371,"vol":0.969501064979502,"std_resid":0.6785998138363541},
{"x":50,"ret":0.018781499514349355,"vol":0.9695660216593827,"std_resid":0.019371037242214194},
{"x":51,"ret":0.43823774231229634,"vol":0.9696294770590147,"std_resid":0.4519641292687555},
{"x":52,"ret":-0.8184545502763483,"vol":0.9696914659711567,"std_resid":-0.8440360454824226},
{"x":53,"ret":-0.4364375470212315,"vol":0.9697520223778732,"std_resid":-0.45005066960424384},
{"x":54,"ret":1.5083581349182493,"vol":0.9698111794696208,"std_resid":1.5553111439106673},
{"x":55,"ret":-0.399833933142405,"vol":0.969868969663894,"std_resid":-0.4122556197266179},
{"x":56,"ret":0.6776588566587324,"vol":0.9699254246233766,"std_resid":0.698671093111997},
{"x":57,"ret":-0.25870957887814156,"vol":0.9699805752737314,"std_resid":-0.2667162471837469},
{"x":58,"ret":-0.3325448241067508,"vol":0.9700344518208914,"std_resid":-0.342817539606472},
{"x":59,"ret":-0.7045956337428738,"vol":0.9700870837679814,"std_resid":-0.726322044208759},
{"x":60,"ret":-0.475919965044083,"vol":0.9701384999318166,"std_resid":-0.490569094080414},
{"x":61,"ret":-0.1609112014771097,"vol":0.9701887284590088,"std_resid":-0.1658555668160479},
{"x":62,"ret":0.6167444193105983,"vol":0.9702377968416962,"std_resid":0.6356631552782377},
{"x":63,"ret":1.656725291225609,"vol":0.9702857319328906,"std_resid":1.7074612525995545},
{"x":64,"ret":-1.115507949315443,"vol":0.9703325599614641,"std_resid":-1.1496140553706087},
{"x":65,"ret":-1.0786607458137447,"vol":0.9703783065467517,"std_resid":-1.1115878606688288},
{"x":66,"ret":0.8024570646067546,"vol":0.9704229967128645,"std_resid":0.8269147241202397},
{"x":67,"ret":0.8848294326243195,"vol":0.9704666549026049,"std_resid":0.9117566566087941},
{"x":68,"ret":-1.0237559862922225,"vol":0.9705093049910828,"std_resid":-1.0548646788107086},
{"x":69,"ret":0.19164735276562897,"vol":0.9705509702989938,"std_resid":0.1974624297233858},
{"x":70,"ret":0.13301422503123553,"vol":0.9705916736055856,"std_resid":0.1370444736426699},
{"x":71,"ret":-0.4792172281770884,"vol":0.9706314371613288,"std_resid":-0.49371698652022705},
{"x":72,"ret":0.2939583971472789,"vol":0.9706702827002687,"std_resid":0.30284062712781096},
{"x":73,"ret":-1.0602586327856445,"vol":0.9707082314520932,"std_resid":-1.0922526444424931},
{"x":74,"ret":-0.026493476200401492,"vol":0.9707453041539208,"std_resid":-0.027291892205950557},
{"x":75,"ret":1.644352653793086,"vol":0.9707815210617898,"std_resid":1.6938442050221345},
{"x":76,"ret":-1.272674368713393,"vol":0.9708169019619167,"std_resid":-1.3109314085297183},
{"x":77,"ret":-0.34438109788519616,"vol":0.9708514661816205,"std_resid":-0.3547206857910555},
{"x":78,"ret":1.2497844874830284,"vol":0.9708852326000637,"std_resid":1.2872628458217075},
{"x":79,"ret":1.007692869460378,"vol":0.9709182196587048,"std_resid":1.037876155846164},
{"x":80,"ret":-2.183101935152624,"vol":0.9709504453714811,"std_resid":-2.2484174610140677},
{"x":81,"ret":-1.95694257620551,"vol":0.9709819273348086,"std_resid":-2.0154263649139246},
{"x":82,"ret":0.5115918005306112,"vol":0.9710126827372674,"std_resid":0.5268641796608083},
{"x":83,"ret":0.7868160673314945,"vol":0.971042728369138,"std_resid":0.8102795524280879},
{"x":84,"ret":-0.4318914694159917,"vol":0.971072080631693,"std_resid":-0.4447573748954265},
{"x":85,"ret":0.08450767412628944,"vol":0.971100755546223,"std_resid":0.08702256037145777},
{"x":86,"ret":0.3627089596358936,"vol":0.9711287687629013,"std_resid":0.37349213750298044},
{"x":87,"ret":0.4057153815080021,"vol":0.9711561355694197,"std_resid":0.417765348586423},
{"x":88,"ret":0.648356747464586,"vol":0.9711828708994231,"std_resid":0.6675949163561089},
{"x":89,"ret":-2.3422253505792994,"vol":0.9712089893407497,"std_resid":-2.41165946391125},
{"x":90,"ret":0.058537307292524224,"vol":0.9712345051434884,"std_resid":0.060271033393604595},
{"x":91,"ret":1.2407776250140905,"vol":0.971259432227773,"std_resid":1.2774935139297694},
{"x":92,"ret":-0.671120074880389,"vol":0.9712837841915551,"std_resid":-0.6909618854998116},
{"x":93,"ret":0.6545125074113552,"vol":0.9713075743180111,"std_resid":0.6738468068375884},
{"x":94,"ret":1.4627322738064892,"vol":0.9713308155828992,"std_resid":1.5059053520593786},
{"x":95,"ret":-0.4026323321259725,"vol":0.9713535206616949,"std_resid":-0.4145064835423623},
{"x":96,"ret":0.2478964729796932,"vol":0.9713757019365481,"std_resid":0.2552014349190363},
{"x":97,"ret":0.6378644683857844,"vol":0.9713973715031318,"std_resid":0.656646277927187},
{"x":98,"ret":-1.0784077774543137,"vol":0.9714185411772736,"std_resid":-1.1101371157146935},
{"x":99,"ret":0.6661928537123607,"vol":0.9714392225014588,"std_resid":0.6857792420578945},
{"x":100,"ret":-1.3601924980733364,"vol":0.9714594267511713,"std_resid":-1.40015368693492},
{"x":101,"ret":0.5950165375641198,"vol":0.9714791649411079,"std_resid":0.6124851247841124},
{"x":102,"ret":-0.14126834445413233,"vol":0.9714984478312054,"std_resid":-0.14541283598497035},
{"x":103,"ret":-1.3546396920477852,"vol":0.9715172859325802,"std_resid":-1.3943546982259174},
{"x":104,"ret":-0.7149103634153315,"vol":0.9715356895132918,"std_resid":-0.7358559969870779},
{"x":105,"ret":-0.30829894213322245,"vol":0.9715536686039628,"std_resid":-0.3173256939847913},
{"x":106,"ret":-0.5558008236381837,"vol":0.9715712330033143,"std_resid":-0.5720638948109816},
{"x":107,"ret":0.11842629292379253,"vol":0.9715883922835318,"std_resid":0.12188936576882552},
{"x":108,"ret":1.4784668469101363,"vol":0.9716051557955145,"std_resid":1.5216745589412008},
{"x":109,"ret":0.3450991513310631,"vol":0.9716215326740197,"std_resid":0.3551785749141526},
{"x":110,"ret":-0.7875438839569323,"vol":0.971637531842643,"std_resid":-0.8105325886942738},
{"x":111,"ret":-2.459079052486651,"vol":0.9716531620187542,"std_resid":-2.530819791063663},
{"x":112,"ret":1.985713821808472,"vol":0.9716684317182634,"std_resid":2.043612570902409},
{"x":113,"ret":0.32277864640718545,"vol":0.9716833492602449,"std_resid":0.33218501341298173},
{"x":114,"ret":1.8546881587438901,"vol":0.9716979227715521,"std_resid":1.9087085762762617},
{"x":115,"ret":1.6327579825632743,"vol":0.9717121601912814,"std_resid":1.6802897498389504},
{"x":116,"ret":0.23699866408894116,"vol":0.9717260692750597,"std_resid":0.2438945208763928},
{"x":117,"ret":0.1938232907826632,"vol":0.9717396575993349,"std_resid":0.19946010154767183},
{"x":118,"ret":0.9690563038822385,"vol":0.9717529325655327,"std_resid":0.9972249852890335},
{"x":119,"ret":-1.0490474709800932,"vol":0.9717659014040904,"std_resid":-1.0795269410712394},
{"x":120,"ret":-0.7696881032986889,"vol":0.971778571178416,"std_resid":-0.7920406213169894},
{"x":121,"ret":-0.42308277859212345,"vol":0.9717909487887614,"std_resid":-0.43536398349815164},
{"x":122,"ret":0.30928199837740133,"vol":0.971803040976,"std_resid":0.31825584540956325},
{"x":123,"ret":0.8904646200777416,"vol":0.9718148543253154,"std_resid":0.9162903984380323},
{"x":124,"ret":-0.9264139330741645,"vol":0.971826395269805,"std_resid":-0.9532710138182316},
{"x":125,"ret":0.9791979163882076,"vol":0.9718376700939935,"std_resid":1.0075735346763233},
{"x":126,"ret":-1.3828053601964323,"vol":0.9718486849372784,"std_resid":-1.4228607617920237},
{"x":127,"ret":-1.986484629440342,"vol":0.9718594457972872,"std_resid":-2.044004035800345},
{"x":128,"ret":-0.8566022313678463,"vol":0.9718699585331562,"std_resid":-0.8813959355845472},
{"x":129,"ret":-0.5228187593686185,"vol":0.9718802288687144,"std_resid":-0.5379456684463977},
{"x":130,"ret":0.38699283912599847,"vol":0.9718902623956569,"std_resid":0.39818573567357496},
{"x":131,"ret":0.6311105096037605,"vol":0.9719000645765694,"std_resid":0.6493574109172616},
{"x":132,"ret":-2.2156582542334338,"vol":0.9719096407479216,"std_resid":-2.2796957261668895},
{"x":133,"ret":0.22006438651225776,"vol":0.9719189961229959,"std_resid":0.2264225592771609},
{"x":134,"ret":-1.2966962818325518,"vol":0.9719281357946825,"std_resid":-1.3341483120789868},
{"x":135,"ret":0.12913907274949055,"vol":0.9719370647383527,"std_resid":0.1328677312910739},
{"x":136,"ret":-0.6706073470895847,"vol":0.9719457878144984,"std_resid":-0.6899637361436604},
{"x":137,"ret":-1.3920969135607244,"vol":0.9719543097714337,"std_resid":-1.4322657964118624},
{"x":138,"ret":-0.7698577304637512,"vol":0.9719626352478692,"std_resid":-0.792065149981226},
{"x":139,"ret":-0.6403040790449113,"vol":0.9719707687754366,"std_resid":-0.6587688638534012},
{"x":140,"ret":0.09192223719142951,"vol":0.9719787147811876,"std_resid":0.09457227385079425},
{"x":141,"ret":-0.44595412461193007,"vol":0.9719864775899949,"std_resid":-0.4588069226206285},
{"x":142,"ret":-0.8684779465340083,"vol":0.9719940614269202,"std_resid":-0.8935012887414695},
{"x":143,"ret":1.0116831076128363,"vol":0.9720014704195178,"std_resid":1.0408246678641255},
{"x":144,"ret":-0.5811084214553092,"vol":0.9720087086000866,"std_resid":-0.5978428138696795},
{"x":145,"ret":1.0593932021147066,"vol":0.9720157799078706,"std_resid":1.0898930079253628},
{"x":146,"ret":1.1821782874978086,"vol":0.9720226881912191,"std_resid":1.2162044177154507},
{"x":147,"ret":-0.23344395094350798,"vol":0.972029437209673,"std_resid":-0.24016140047531565},
{"x":148,"ret":1.4223996688457998,"vol":0.9720360306360191,"std_resid":1.463319901747984},
{"x":149,"ret":0.9282411501765593,"vol":0.9720424720583126,"std_resid":0.9549388806139268},
{"x":150,"ret":0.939487795875224,"vol":0.9720487649818005,"std_resid":0.9665027411385209},
{"x":151,"ret":-1.1749982763140374,"vol":0.9720549128308659,"std_resid":-1.2087776737758056},
{"x":152,"ret":-0.7934506135951656,"vol":0.9720609189508814,"std_resid":-0.8162560577494617},
{"x":153,"ret":1.382501018288413,"vol":0.9720667866100312,"std_resid":1.4222284284701496},
{"x":154,"ret":-0.6613462785784165,"vol":0.9720725190011079,"std_resid":-0.6803466466246875},
{"x":155,"ret":0.9428755689280497,"vol":0.97207811924323,"std_resid":0.9699586383675474},
{"x":156,"ret":-0.49557300638543084,"vol":0.9720835903835718,"std_resid":-0.5098049296253258},
{"x":157,"ret":-0.4598402502641967,"vol":0.9720889353990013,"std_resid":-0.4730433950217238},
{"x":158,"ret":0.28129575649935373,"vol":0.9720941571977183,"std_resid":0.2893708952127153},
{"x":159,"ret":-0.5178240340695159,"vol":0.972099258620832,"std_resid":-0.5326863789652303},
{"x":160,"ret":-1.3815426391665615,"vol":0.9721042424439144,"std_resid":-1.421187748027208},
{"x":161,"ret":1.502711573684822,"vol":0.9721091113785147,"std_resid":1.5458260354682594},
{"x":162,"ret":-0.4431399891208335,"vol":0.9721138680736264,"std_resid":-0.455851936356977},
{"x":163,"ret":0.2585764750416383,"vol":0.972118515117136,"std_resid":0.2659927478189025},
{"x":164,"ret":-1.7095032286358498,"vol":0.9721230550372503,"std_resid":-1.7585255485688942},
{"x":165,"ret":-1.5897575243606703,"vol":0.9721274903038643,"std_resid":-1.6353385129184541},
{"x":166,"ret":-0.11419463655310703,"vol":0.972131823329885,"std_resid":-0.11746826285549548},
{"x":167,"ret":0.045466532570209814,"vol":0.9721360564725692,"std_resid":0.04676972144741423},
{"x":168,"ret":-0.653229380434178,"vol":0.9721401920348187,"std_resid":-0.6719497720456162},
{"x":169,"ret":-0.05142140675282799,"vol":0.9721442322664146,"std_resid":-0.05289483293332551},
{"x":170,"ret":0.27205117912114607,"vol":0.9721481793652456,"std_resid":0.27984538252057334},
{"x":171,"ret":0.745312260251881,"vol":0.9721520354785135,"std_resid":0.7666622432004916},
{"x":172,"ret":-0.11035395888602917,"vol":0.9721558027038995,"std_resid":-0.11351468414743489},
{"x":173,"ret":0.432364067831331,"vol":0.9721594830907014,"std_resid":0.4447460271197004},
{"x":174,"ret":-1.19819001580385,"vol":0.9721630786409619,"std_resid":-1.2324989933570232},
{"x":175,"ret":0.2983284889136429,"vol":0.9721665913105528,"std_resid":0.30686971922319806},
{"x":176,"ret":-0.021512606705105092,"vol":0.9721700230102297,"std_resid":-0.022128440700622923},
{"x":177,"ret":1.131813828761745,"vol":0.9721733756066954,"std_resid":1.1642098592295065},
{"x":178,"ret":0.783212207126035,"vol":0.9721766509236047,"std_resid":0.8056274612046624},
{"x":179,"ret":-0.025703397311993892,"vol":0.9721798507425482,"std_resid":-0.02643893235635537},
{"x":180,"ret":-0.23281054824649824,"vol":0.972182976804038,"std_resid":-0.2394719448923509},
{"x":181,"ret":-1.0032054239549346,"vol":0.9721860308084518,"std_resid":-1.0319068492690515},
{"x":182,"ret":0.8354753313942387,"vol":0.9721890144169582,"std_resid":0.8593754084901798},
{"x":183,"ret":-0.5732709973166978,"vol":0.972191929252413,"std_resid":-0.5896685418459772},
{"x":184,"ret":1.1450568162366033,"vol":0.9721947769002544,"std_resid":1.1778059741150866},
{"x":185,"ret":0.8783648313226607,"vol":0.9721975589093659,"std_resid":0.903483888920716},
{"x":186,"ret":-0.24888300727752527,"vol":0.9722002767929075,"std_resid":-0.2559997288815223},
{"x":187,"ret":0.7228996624267281,"vol":0.9722029320291522,"std_resid":0.7435686918963658},
{"x":188,"ret":-0.12041647632534423,"vol":0.9722055260622908,"std_resid":-0.12385907413329077},
{"x":189,"ret":-1.4352318894349707,"vol":0.9722080603032076,"std_resid":-1.4762600188557966},
{"x":190,"ret":0.8855858383172982,"vol":0.972210536130266,"std_resid":0.9108992398315657},
{"x":191,"ret":-0.9025208818149901,"vol":0.97221295489003,"std_resid":-0.9283160415375015},
{"x":192,"ret":-0.12074409616803661,"vol":0.97221531789803,"std_resid":-0.12419480946781458},
{"x":193,"ret":0.17269602853502322,"vol":0.9722176264394573,"std_resid":0.17763104045694597},
{"x":194,"ret":1.3197102226275068,"vol":0.9722198817698763,"std_resid":1.357419496734671},
{"x":195,"ret":0.32175060242573034,"vol":0.972222085115905,"std_resid":0.3309435234516117},
{"x":196,"ret":-0.7908568134899913,"vol":0.9722242376758649,"std_resid":-0.8134510361319127},
{"x":197,"ret":0.3874579326049864,"vol":0.9722263406204653,"std_resid":0.3985264710661044},
{"x":198,"ret":1.5677556877923258,"vol":0.9722283950934147,"std_resid":1.6125384690514937},
{"x":199,"ret":1.7762816619624333,"vol":0.9722304022120638,"std_resid":1.8270171946083507},
{"x":200,"ret":1.9489452010696782,"vol":0.972232363067989,"std_resid":2.0046084404345086}];
    const series = [{"name":"Cond. Volatility (σ)","color":"#ff7f0e","key":"vol","dash":""}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#vol_sig_82');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');
    if('σₜ') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('σₜ');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"ret":0.2088332105422406,"vol":0.963670484654648,"std_resid":0.21670603579508868},
{"x":2,"ret":0.4384722422321556,"vol":0.9638706015875961,"std_resid":0.45490778690619443},
{"x":3,"ret":0.4725842035933498,"vol":0.9640660662452317,"std_resid":0.4901989813145622},
{"x":4,"ret":1.6201447720624402,"vol":0.9642569877011173,"std_resid":1.6802001880484405},
{"x":5,"ret":0.28045405795416234,"vol":0.9644434724290334,"std_resid":0.29079367113949645},
{"x":6,"ret":1.2983159215175022,"vol":0.9646256243668918,"std_resid":1.3459272579137838},
{"x":7,"ret":-0.01987996243675271,"vol":0.9648035449790658,"std_resid":-0.020605192155657},
{"x":8,"ret":0.21824565572954072,"vol":0.9649773333170001,"std_resid":0.22616661365438093},
{"x":9,"ret":0.25509660863237965,"vol":0.9651470860783395,"std_resid":0.2643085311161307},
{"x":10,"ret":-0.11999203046929163,"vol":0.9653128976644727,"std_resid":-0.12430376799026148},
{"x":11,"ret":-0.7174524918352548,"vol":0.9654748602366175,"std_resid":-0.7431084136767915},
{"x":12,"ret":-0.21424087596888453,"vol":0.9656330637704622,"std_resid":-0.22186572105593425},
{"x":13,"ret":-0.4694096628322326,"vol":0.9657875961093959,"std_resid":-0.4860381979673531},
{"x":14,"ret":1.5834667570079413,"vol":0.9659385430163944,"std_resid":1.6393038340339483},
{"x":15,"ret":0.6132359583166904,"vol":0.9660859882245701,"std_resid":0.6347633293426274},
{"x":16,"ret":-1.59366826383876,"vol":0.9662300134864111,"std_resid":-1.649367377948018},
{"x":17,"ret":-1.518919919412247,"vol":0.9663706986218394,"std_resid":-1.5717777055724154},
{"x":18,"ret":1.3585377890997221,"vol":0.966508121564957,"std_resid":1.4056144576415932},
{"x":19,"ret":-0.4835243227290544,"vol":0.9666423584096829,"std_resid":-0.5002101537579494},
{"x":20,"ret":-2.250502757283063,"vol":0.9667734834542006,"std_resid":-2.3278490730240193},
{"x":21,"ret":0.3193832464242711,"vol":0.9669015692443208,"std_resid":0.33031619410224367},
{"x":22,"ret":-0.70656180301821,"vol":0.9670266866156555,"std_resid":-0.7306538824600534},
{"x":23,"ret":-0.5381929256618667,"vol":0.9671489047348997,"std_resid":-0.5564736960637805},
{"x":24,"ret":-0.1561158927236592,"vol":0.9672682911399202,"std_resid":-0.16139874960614858},
{"x":25,"ret":0.6037225274273443,"vol":0.9673849117789246,"std_resid":0.6240768489113176},
{"x":26,"ret":1.2657433557326152,"vol":0.9674988310486338,"std_resid":1.3082634470583556},
{"x":27,"ret":-1.1505071143854853,"vol":0.9676101118315,"std_resid":-1.1890193170964247},
{"x":28,"ret":-0.9158592464479492,"vol":0.9677188155319937,"std_resid":-0.9464104983268976},
{"x":29,"ret":0.5879337179676579,"vol":0.9678250021120066,"std_resid":0.6074793652619611},
{"x":30,"ret":-0.41282154828080614,"vol":0.9679287301253634,"std_resid":-0.42649994305607464},
{"x":31,"ret":-0.2429218347940629,"vol":0.9680300567514821,"std_resid":-0.2509445167531891},
{"x":32,"ret":-0.03516866082973856,"vol":0.9681290378282006,"std_resid":-0.03632641874747632},
{"x":33,"ret":-1.1741778355680308,"vol":0.9682257278837946,"std_resid":-1.2127108397897834},
{"x":34,"ret":1.2286976023402392,"vol":0.9683201801682116,"std_resid":1.2688959989729802},
{"x":35,"ret":0.36443715993347037,"vol":0.968412446683518,"std_resid":0.3763243246010966},
{"x":36,"ret":0.863519047346861,"vol":0.9685025782136187,"std_resid":0.8916022184882589},
{"x":37,"ret":-0.6110236695657176,"vol":0.9685906243532516,"std_resid":-0.6308378939489643},
{"x":38,"ret":-1.0731628669281819,"vol":0.9686766335362399,"std_resid":-1.1078649259975495},
{"x":39,"ret":-0.558994605387216,"vol":0.9687606530630894,"std_resid":-0.5770203441064117},
{"x":40,"ret":0.05819751744237116,"vol":0.9688427291278798,"std_resid":0.06006910687636438},
{"x":41,"ret":1.5143016801942752,"vol":0.9689229068445301,"std_resid":1.5628711732348946},
{"x":42,"ret":-0.6268646591147701,"vol":0.9690012302724093,"std_resid":-0.6469183315056716},
{"x":43,"ret":-1.1987953363968185,"vol":0.9690777424412949,"std_resid":-1.2370476422013579},
{"x":44,"ret":1.899472039842352,"vol":0.9691524853757971,"std_resid":1.9599310413013236},
{"x":45,"ret":-0.09971254641057269,"vol":0.9692255001191175,"std_resid":-0.10287858336199167},
{"x":46,"ret":0.009760745845731295,"vol":0.9692968267562437,"std_resid":0.010069924481642714},
{"x":47,"ret":1.545285105465797,"vol":0.9693665044366488,"std_resid":1.5941185283308767},
{"x":48,"ret":-1.4799904964815829,"vol":0.9694345713963578,"std_resid":-1.526653309206653},
{"x":49,"ret":0.6579032422092371,"vol":0.969501064979502,"std_resid":0.6785998138363541},
{"x":50,"ret":0.018781499514349355,"vol":0.9695660216593827,"std_resid":0.019371037242214194},
{"x":51,"ret":0.43823774231229634,"vol":0.9696294770590147,"std_resid":0.4519641292687555},
{"x":52,"ret":-0.8184545502763483,"vol":0.9696914659711567,"std_resid":-0.8440360454824226},
{"x":53,"ret":-0.4364375470212315,"vol":0.9697520223778732,"std_resid":-0.45005066960424384},
{"x":54,"ret":1.5083581349182493,"vol":0.9698111794696208,"std_resid":1.5553111439106673},
{"x":55,"ret":-0.399833933142405,"vol":0.969868969663894,"std_resid":-0.4122556197266179},
{"x":56,"ret":0.6776588566587324,"vol":0.9699254246233766,"std_resid":0.698671093111997},
{"x":57,"ret":-0.25870957887814156,"vol":0.9699805752737314,"std_resid":-0.2667162471837469},
{"x":58,"ret":-0.3325448241067508,"vol":0.9700344518208914,"std_resid":-0.342817539606472},
{"x":59,"ret":-0.7045956337428738,"vol":0.9700870837679814,"std_resid":-0.726322044208759},
{"x":60,"ret":-0.475919965044083,"vol":0.9701384999318166,"std_resid":-0.490569094080414},
{"x":61,"ret":-0.1609112014771097,"vol":0.9701887284590088,"std_resid":-0.1658555668160479},
{"x":62,"ret":0.6167444193105983,"vol":0.9702377968416962,"std_resid":0.6356631552782377},
{"x":63,"ret":1.656725291225609,"vol":0.9702857319328906,"std_resid":1.7074612525995545},
{"x":64,"ret":-1.115507949315443,"vol":0.9703325599614641,"std_resid":-1.1496140553706087},
{"x":65,"ret":-1.0786607458137447,"vol":0.9703783065467517,"std_resid":-1.1115878606688288},
{"x":66,"ret":0.8024570646067546,"vol":0.9704229967128645,"std_resid":0.8269147241202397},
{"x":67,"ret":0.8848294326243195,"vol":0.9704666549026049,"std_resid":0.9117566566087941},
{"x":68,"ret":-1.0237559862922225,"vol":0.9705093049910828,"std_resid":-1.0548646788107086},
{"x":69,"ret":0.19164735276562897,"vol":0.9705509702989938,"std_resid":0.1974624297233858},
{"x":70,"ret":0.13301422503123553,"vol":0.9705916736055856,"std_resid":0.1370444736426699},
{"x":71,"ret":-0.4792172281770884,"vol":0.9706314371613288,"std_resid":-0.49371698652022705},
{"x":72,"ret":0.2939583971472789,"vol":0.9706702827002687,"std_resid":0.30284062712781096},
{"x":73,"ret":-1.0602586327856445,"vol":0.9707082314520932,"std_resid":-1.0922526444424931},
{"x":74,"ret":-0.026493476200401492,"vol":0.9707453041539208,"std_resid":-0.027291892205950557},
{"x":75,"ret":1.644352653793086,"vol":0.9707815210617898,"std_resid":1.6938442050221345},
{"x":76,"ret":-1.272674368713393,"vol":0.9708169019619167,"std_resid":-1.3109314085297183},
{"x":77,"ret":-0.34438109788519616,"vol":0.9708514661816205,"std_resid":-0.3547206857910555},
{"x":78,"ret":1.2497844874830284,"vol":0.9708852326000637,"std_resid":1.2872628458217075},
{"x":79,"ret":1.007692869460378,"vol":0.9709182196587048,"std_resid":1.037876155846164},
{"x":80,"ret":-2.183101935152624,"vol":0.9709504453714811,"std_resid":-2.2484174610140677},
{"x":81,"ret":-1.95694257620551,"vol":0.9709819273348086,"std_resid":-2.0154263649139246},
{"x":82,"ret":0.5115918005306112,"vol":0.9710126827372674,"std_resid":0.5268641796608083},
{"x":83,"ret":0.7868160673314945,"vol":0.971042728369138,"std_resid":0.8102795524280879},
{"x":84,"ret":-0.4318914694159917,"vol":0.971072080631693,"std_resid":-0.4447573748954265},
{"x":85,"ret":0.08450767412628944,"vol":0.971100755546223,"std_resid":0.08702256037145777},
{"x":86,"ret":0.3627089596358936,"vol":0.9711287687629013,"std_resid":0.37349213750298044},
{"x":87,"ret":0.4057153815080021,"vol":0.9711561355694197,"std_resid":0.417765348586423},
{"x":88,"ret":0.648356747464586,"vol":0.9711828708994231,"std_resid":0.6675949163561089},
{"x":89,"ret":-2.3422253505792994,"vol":0.9712089893407497,"std_resid":-2.41165946391125},
{"x":90,"ret":0.058537307292524224,"vol":0.9712345051434884,"std_resid":0.060271033393604595},
{"x":91,"ret":1.2407776250140905,"vol":0.971259432227773,"std_resid":1.2774935139297694},
{"x":92,"ret":-0.671120074880389,"vol":0.9712837841915551,"std_resid":-0.6909618854998116},
{"x":93,"ret":0.6545125074113552,"vol":0.9713075743180111,"std_resid":0.6738468068375884},
{"x":94,"ret":1.4627322738064892,"vol":0.9713308155828992,"std_resid":1.5059053520593786},
{"x":95,"ret":-0.4026323321259725,"vol":0.9713535206616949,"std_resid":-0.4145064835423623},
{"x":96,"ret":0.2478964729796932,"vol":0.9713757019365481,"std_resid":0.2552014349190363},
{"x":97,"ret":0.6378644683857844,"vol":0.9713973715031318,"std_resid":0.656646277927187},
{"x":98,"ret":-1.0784077774543137,"vol":0.9714185411772736,"std_resid":-1.1101371157146935},
{"x":99,"ret":0.6661928537123607,"vol":0.9714392225014588,"std_resid":0.6857792420578945},
{"x":100,"ret":-1.3601924980733364,"vol":0.9714594267511713,"std_resid":-1.40015368693492},
{"x":101,"ret":0.5950165375641198,"vol":0.9714791649411079,"std_resid":0.6124851247841124},
{"x":102,"ret":-0.14126834445413233,"vol":0.9714984478312054,"std_resid":-0.14541283598497035},
{"x":103,"ret":-1.3546396920477852,"vol":0.9715172859325802,"std_resid":-1.3943546982259174},
{"x":104,"ret":-0.7149103634153315,"vol":0.9715356895132918,"std_resid":-0.7358559969870779},
{"x":105,"ret":-0.30829894213322245,"vol":0.9715536686039628,"std_resid":-0.3173256939847913},
{"x":106,"ret":-0.5558008236381837,"vol":0.9715712330033143,"std_resid":-0.5720638948109816},
{"x":107,"ret":0.11842629292379253,"vol":0.9715883922835318,"std_resid":0.12188936576882552},
{"x":108,"ret":1.4784668469101363,"vol":0.9716051557955145,"std_resid":1.5216745589412008},
{"x":109,"ret":0.3450991513310631,"vol":0.9716215326740197,"std_resid":0.3551785749141526},
{"x":110,"ret":-0.7875438839569323,"vol":0.971637531842643,"std_resid":-0.8105325886942738},
{"x":111,"ret":-2.459079052486651,"vol":0.9716531620187542,"std_resid":-2.530819791063663},
{"x":112,"ret":1.985713821808472,"vol":0.9716684317182634,"std_resid":2.043612570902409},
{"x":113,"ret":0.32277864640718545,"vol":0.9716833492602449,"std_resid":0.33218501341298173},
{"x":114,"ret":1.8546881587438901,"vol":0.9716979227715521,"std_resid":1.9087085762762617},
{"x":115,"ret":1.6327579825632743,"vol":0.9717121601912814,"std_resid":1.6802897498389504},
{"x":116,"ret":0.23699866408894116,"vol":0.9717260692750597,"std_resid":0.2438945208763928},
{"x":117,"ret":0.1938232907826632,"vol":0.9717396575993349,"std_resid":0.19946010154767183},
{"x":118,"ret":0.9690563038822385,"vol":0.9717529325655327,"std_resid":0.9972249852890335},
{"x":119,"ret":-1.0490474709800932,"vol":0.9717659014040904,"std_resid":-1.0795269410712394},
{"x":120,"ret":-0.7696881032986889,"vol":0.971778571178416,"std_resid":-0.7920406213169894},
{"x":121,"ret":-0.42308277859212345,"vol":0.9717909487887614,"std_resid":-0.43536398349815164},
{"x":122,"ret":0.30928199837740133,"vol":0.971803040976,"std_resid":0.31825584540956325},
{"x":123,"ret":0.8904646200777416,"vol":0.9718148543253154,"std_resid":0.9162903984380323},
{"x":124,"ret":-0.9264139330741645,"vol":0.971826395269805,"std_resid":-0.9532710138182316},
{"x":125,"ret":0.9791979163882076,"vol":0.9718376700939935,"std_resid":1.0075735346763233},
{"x":126,"ret":-1.3828053601964323,"vol":0.9718486849372784,"std_resid":-1.4228607617920237},
{"x":127,"ret":-1.986484629440342,"vol":0.9718594457972872,"std_resid":-2.044004035800345},
{"x":128,"ret":-0.8566022313678463,"vol":0.9718699585331562,"std_resid":-0.8813959355845472},
{"x":129,"ret":-0.5228187593686185,"vol":0.9718802288687144,"std_resid":-0.5379456684463977},
{"x":130,"ret":0.38699283912599847,"vol":0.9718902623956569,"std_resid":0.39818573567357496},
{"x":131,"ret":0.6311105096037605,"vol":0.9719000645765694,"std_resid":0.6493574109172616},
{"x":132,"ret":-2.2156582542334338,"vol":0.9719096407479216,"std_resid":-2.2796957261668895},
{"x":133,"ret":0.22006438651225776,"vol":0.9719189961229959,"std_resid":0.2264225592771609},
{"x":134,"ret":-1.2966962818325518,"vol":0.9719281357946825,"std_resid":-1.3341483120789868},
{"x":135,"ret":0.12913907274949055,"vol":0.9719370647383527,"std_resid":0.1328677312910739},
{"x":136,"ret":-0.6706073470895847,"vol":0.9719457878144984,"std_resid":-0.6899637361436604},
{"x":137,"ret":-1.3920969135607244,"vol":0.9719543097714337,"std_resid":-1.4322657964118624},
{"x":138,"ret":-0.7698577304637512,"vol":0.9719626352478692,"std_resid":-0.792065149981226},
{"x":139,"ret":-0.6403040790449113,"vol":0.9719707687754366,"std_resid":-0.6587688638534012},
{"x":140,"ret":0.09192223719142951,"vol":0.9719787147811876,"std_resid":0.09457227385079425},
{"x":141,"ret":-0.44595412461193007,"vol":0.9719864775899949,"std_resid":-0.4588069226206285},
{"x":142,"ret":-0.8684779465340083,"vol":0.9719940614269202,"std_resid":-0.8935012887414695},
{"x":143,"ret":1.0116831076128363,"vol":0.9720014704195178,"std_resid":1.0408246678641255},
{"x":144,"ret":-0.5811084214553092,"vol":0.9720087086000866,"std_resid":-0.5978428138696795},
{"x":145,"ret":1.0593932021147066,"vol":0.9720157799078706,"std_resid":1.0898930079253628},
{"x":146,"ret":1.1821782874978086,"vol":0.9720226881912191,"std_resid":1.2162044177154507},
{"x":147,"ret":-0.23344395094350798,"vol":0.972029437209673,"std_resid":-0.24016140047531565},
{"x":148,"ret":1.4223996688457998,"vol":0.9720360306360191,"std_resid":1.463319901747984},
{"x":149,"ret":0.9282411501765593,"vol":0.9720424720583126,"std_resid":0.9549388806139268},
{"x":150,"ret":0.939487795875224,"vol":0.9720487649818005,"std_resid":0.9665027411385209},
{"x":151,"ret":-1.1749982763140374,"vol":0.9720549128308659,"std_resid":-1.2087776737758056},
{"x":152,"ret":-0.7934506135951656,"vol":0.9720609189508814,"std_resid":-0.8162560577494617},
{"x":153,"ret":1.382501018288413,"vol":0.9720667866100312,"std_resid":1.4222284284701496},
{"x":154,"ret":-0.6613462785784165,"vol":0.9720725190011079,"std_resid":-0.6803466466246875},
{"x":155,"ret":0.9428755689280497,"vol":0.97207811924323,"std_resid":0.9699586383675474},
{"x":156,"ret":-0.49557300638543084,"vol":0.9720835903835718,"std_resid":-0.5098049296253258},
{"x":157,"ret":-0.4598402502641967,"vol":0.9720889353990013,"std_resid":-0.4730433950217238},
{"x":158,"ret":0.28129575649935373,"vol":0.9720941571977183,"std_resid":0.2893708952127153},
{"x":159,"ret":-0.5178240340695159,"vol":0.972099258620832,"std_resid":-0.5326863789652303},
{"x":160,"ret":-1.3815426391665615,"vol":0.9721042424439144,"std_resid":-1.421187748027208},
{"x":161,"ret":1.502711573684822,"vol":0.9721091113785147,"std_resid":1.5458260354682594},
{"x":162,"ret":-0.4431399891208335,"vol":0.9721138680736264,"std_resid":-0.455851936356977},
{"x":163,"ret":0.2585764750416383,"vol":0.972118515117136,"std_resid":0.2659927478189025},
{"x":164,"ret":-1.7095032286358498,"vol":0.9721230550372503,"std_resid":-1.7585255485688942},
{"x":165,"ret":-1.5897575243606703,"vol":0.9721274903038643,"std_resid":-1.6353385129184541},
{"x":166,"ret":-0.11419463655310703,"vol":0.972131823329885,"std_resid":-0.11746826285549548},
{"x":167,"ret":0.045466532570209814,"vol":0.9721360564725692,"std_resid":0.04676972144741423},
{"x":168,"ret":-0.653229380434178,"vol":0.9721401920348187,"std_resid":-0.6719497720456162},
{"x":169,"ret":-0.05142140675282799,"vol":0.9721442322664146,"std_resid":-0.05289483293332551},
{"x":170,"ret":0.27205117912114607,"vol":0.9721481793652456,"std_resid":0.27984538252057334},
{"x":171,"ret":0.745312260251881,"vol":0.9721520354785135,"std_resid":0.7666622432004916},
{"x":172,"ret":-0.11035395888602917,"vol":0.9721558027038995,"std_resid":-0.11351468414743489},
{"x":173,"ret":0.432364067831331,"vol":0.9721594830907014,"std_resid":0.4447460271197004},
{"x":174,"ret":-1.19819001580385,"vol":0.9721630786409619,"std_resid":-1.2324989933570232},
{"x":175,"ret":0.2983284889136429,"vol":0.9721665913105528,"std_resid":0.30686971922319806},
{"x":176,"ret":-0.021512606705105092,"vol":0.9721700230102297,"std_resid":-0.022128440700622923},
{"x":177,"ret":1.131813828761745,"vol":0.9721733756066954,"std_resid":1.1642098592295065},
{"x":178,"ret":0.783212207126035,"vol":0.9721766509236047,"std_resid":0.8056274612046624},
{"x":179,"ret":-0.025703397311993892,"vol":0.9721798507425482,"std_resid":-0.02643893235635537},
{"x":180,"ret":-0.23281054824649824,"vol":0.972182976804038,"std_resid":-0.2394719448923509},
{"x":181,"ret":-1.0032054239549346,"vol":0.9721860308084518,"std_resid":-1.0319068492690515},
{"x":182,"ret":0.8354753313942387,"vol":0.9721890144169582,"std_resid":0.8593754084901798},
{"x":183,"ret":-0.5732709973166978,"vol":0.972191929252413,"std_resid":-0.5896685418459772},
{"x":184,"ret":1.1450568162366033,"vol":0.9721947769002544,"std_resid":1.1778059741150866},
{"x":185,"ret":0.8783648313226607,"vol":0.9721975589093659,"std_resid":0.903483888920716},
{"x":186,"ret":-0.24888300727752527,"vol":0.9722002767929075,"std_resid":-0.2559997288815223},
{"x":187,"ret":0.7228996624267281,"vol":0.9722029320291522,"std_resid":0.7435686918963658},
{"x":188,"ret":-0.12041647632534423,"vol":0.9722055260622908,"std_resid":-0.12385907413329077},
{"x":189,"ret":-1.4352318894349707,"vol":0.9722080603032076,"std_resid":-1.4762600188557966},
{"x":190,"ret":0.8855858383172982,"vol":0.972210536130266,"std_resid":0.9108992398315657},
{"x":191,"ret":-0.9025208818149901,"vol":0.97221295489003,"std_resid":-0.9283160415375015},
{"x":192,"ret":-0.12074409616803661,"vol":0.97221531789803,"std_resid":-0.12419480946781458},
{"x":193,"ret":0.17269602853502322,"vol":0.9722176264394573,"std_resid":0.17763104045694597},
{"x":194,"ret":1.3197102226275068,"vol":0.9722198817698763,"std_resid":1.357419496734671},
{"x":195,"ret":0.32175060242573034,"vol":0.972222085115905,"std_resid":0.3309435234516117},
{"x":196,"ret":-0.7908568134899913,"vol":0.9722242376758649,"std_resid":-0.8134510361319127},
{"x":197,"ret":0.3874579326049864,"vol":0.9722263406204653,"std_resid":0.3985264710661044},
{"x":198,"ret":1.5677556877923258,"vol":0.9722283950934147,"std_resid":1.6125384690514937},
{"x":199,"ret":1.7762816619624333,"vol":0.9722304022120638,"std_resid":1.8270171946083507},
{"x":200,"ret":1.9489452010696782,"vol":0.972232363067989,"std_resid":2.0046084404345086}];
    const series = [{"name":"Std. Residuals","color":"#2ca02c","key":"std_resid","dash":""}];
    const bands = [];
    const refLines = [{"value":2,"color":"#d62728","dash":"4,3"},{"value":-2,"color":"#d62728","dash":"4,3"},{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#vol_zr_83');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('zₜ = εₜ/σₜ') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('zₜ = εₜ/σₜ');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>