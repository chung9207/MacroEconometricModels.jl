<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bayesian Historical Decomposition (cholesky)</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">Bayesian Historical Decomposition (cholesky)</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">INDPRO — Posterior Mean Contributions</div>
<div id="bhd_bar_55"></div>
</div>
<div class="panel">
<div class="panel-title">INDPRO — Actual vs Decomposition</div>
<div id="bhd_line_56"></div>
</div>
<div class="panel">
<div class="panel-title">UNRATE — Posterior Mean Contributions</div>
<div id="bhd_bar_57"></div>
</div>
<div class="panel">
<div class="panel-title">UNRATE — Actual vs Decomposition</div>
<div id="bhd_line_58"></div>
</div>
<div class="panel">
<div class="panel-title">CPI — Posterior Mean Contributions</div>
<div id="bhd_bar_59"></div>
</div>
<div class="panel">
<div class="panel-title">CPI — Actual vs Decomposition</div>
<div id="bhd_line_60"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":1,"s1":0.0004956288189084093,"s2":0.0,"s3":0.0},
{"x":2,"s1":0.003494584284076543,"s2":0.0004792508391247087,"s3":-0.00023928644575693276},
{"x":3,"s1":-0.001354738701411847,"s2":0.0008093562991813961,"s3":0.0006322225360784384},
{"x":4,"s1":0.007376505514903478,"s2":0.0012827117387717397,"s3":-0.0013743545168047456},
{"x":5,"s1":0.0013963616327704272,"s2":-0.0005699584330942487,"s3":0.0003508765605559627},
{"x":6,"s1":0.0012631839268316086,"s2":-0.0001821927064652799,"s3":0.0006022041039983247},
{"x":7,"s1":-0.00577696080734492,"s2":0.0017845000118996066,"s3":-0.00245683540826432},
{"x":8,"s1":-0.0003207975993227266,"s2":0.0016787376008969568,"s3":0.0012060290252959584},
{"x":9,"s1":-0.002494298437879873,"s2":3.073756785820065e-5,"s3":-0.0009550498901094825},
{"x":10,"s1":0.002974379516485011,"s2":-0.0019197698632055372,"s3":0.0003199976532044015},
{"x":11,"s1":-0.008460715766546332,"s2":0.005390722675593261,"s3":-0.002872290515214071},
{"x":12,"s1":-0.0013937441721885789,"s2":0.0006826951435043911,"s3":-0.0006427930618577507},
{"x":13,"s1":-0.005952326153857686,"s2":0.0003580960099660765,"s3":0.001270106127675317},
{"x":14,"s1":0.002478365325289074,"s2":0.0030193494727081536,"s3":-0.003563885207129222},
{"x":15,"s1":-0.006429247814116204,"s2":-0.003090851314355209,"s3":0.0017601278461229282},
{"x":16,"s1":0.0007675277199824771,"s2":0.0009769818109185316,"s3":-0.0007380471315096539},
{"x":17,"s1":-0.0005688873686012419,"s2":-0.0011153423656014604,"s3":-0.0005635140177214073},
{"x":18,"s1":-0.0025589960947272885,"s2":0.0056469722657704335,"s3":-0.0031204251238496315},
{"x":19,"s1":-0.002380308897003881,"s2":0.0012560050908430702,"s3":-0.0007020105162472816},
{"x":20,"s1":-0.006053189684393504,"s2":-0.006009904487757339,"s3":0.0022333572531394023},
{"x":21,"s1":-0.005478488958385947,"s2":0.0041503705419125,"s3":-0.0027182542413622763},
{"x":22,"s1":-0.00479864871237597,"s2":0.0028688636906762303,"s3":-0.003596269710870445},
{"x":23,"s1":-0.012805111891159498,"s2":0.00026525577981805013,"s3":-2.933756446297786e-5},
{"x":24,"s1":-0.005070206626055211,"s2":-0.0006605312436531306,"s3":-0.0005387054246061655},
{"x":25,"s1":-0.012167862128293844,"s2":-0.004401079390483989,"s3":0.00035347856072247676},
{"x":26,"s1":0.004079865847139716,"s2":0.0004050964289862109,"s3":-0.00047660453898027214},
{"x":27,"s1":-0.010975458502486293,"s2":0.004570864634686473,"s3":-0.003174183426612348},
{"x":28,"s1":-0.005969448606531197,"s2":-0.0035143126925170076,"s3":0.0029344386102020583},
{"x":29,"s1":-2.8717528003987256e-5,"s2":0.0024660829274063515,"s3":-0.0048374086689559875},
{"x":30,"s1":0.0037238057140613658,"s2":-0.0026502217176331577,"s3":-0.0002478252318231454},
{"x":31,"s1":-0.007313216279732031,"s2":-0.004488266083395026,"s3":0.002024942008018325},
{"x":32,"s1":0.004852597561192116,"s2":0.004188558884343978,"s3":-0.004437833789872269},
{"x":33,"s1":-0.001303326768690788,"s2":0.00012891804825081914,"s3":0.0015651822647752742},
{"x":34,"s1":-0.004708302242267337,"s2":0.0014729346134114765,"s3":-0.0031343879951392884},
{"x":35,"s1":-0.0014706043772329792,"s2":-0.002093254774161477,"s3":0.002215844534219638},
{"x":36,"s1":-0.0008778998404691428,"s2":-0.004382428548986749,"s3":0.004734432538602973},
{"x":37,"s1":-0.004363076651082025,"s2":0.002083081301115824,"s3":-0.003948008858911146},
{"x":38,"s1":0.0009748737085811119,"s2":-0.0009592678499979442,"s3":-0.00030214903545063796},
{"x":39,"s1":-0.0033847456855110045,"s2":-0.005720804985312422,"s3":0.004722382137819569},
{"x":40,"s1":-0.0029852595183355504,"s2":-0.007145577492871896,"s3":-0.00016311719326157632},
{"x":41,"s1":-0.016628535976316767,"s2":-0.0017424821725793664,"s3":0.0007587415235222166},
{"x":42,"s1":-0.009985992323017273,"s2":0.001579821806925764,"s3":-0.0029557443375999087},
{"x":43,"s1":-0.006786015167106234,"s2":-0.0072403813667370155,"s3":0.006196357441913804},
{"x":44,"s1":-0.008606533809409867,"s2":3.3477167414832504e-5,"s3":-0.0030928528400619086},
{"x":45,"s1":-0.00914755435016601,"s2":-0.000140322320151068,"s3":-0.0011199084585567132},
{"x":46,"s1":0.0023341827611477683,"s2":-0.007300071694888531,"s3":0.0038163421138306614},
{"x":47,"s1":0.004910109773101327,"s2":-0.001331970643885656,"s3":0.0015753910311752581},
{"x":48,"s1":0.008103333637481551,"s2":-0.0012354861934972578,"s3":-0.0025112715517925633},
{"x":49,"s1":-0.00013324536586100823,"s2":-0.0028612202121656967,"s3":0.0013759025297212539},
{"x":50,"s1":-9.16526729179505e-5,"s2":-0.003252088913575522,"s3":4.443086777321526e-5},
{"x":51,"s1":0.0034192680984810554,"s2":-0.004142030780134505,"s3":0.0046745277926423835},
{"x":52,"s1":-0.0034004813230249327,"s2":0.0015736122854714384,"s3":-0.0024139566868053614},
{"x":53,"s1":-0.003476531279113928,"s2":-0.005346707513843314,"s3":0.003095238145986122},
{"x":54,"s1":-0.006711445641490251,"s2":-0.0026049930152826192,"s3":0.0009324247261171213},
{"x":55,"s1":-0.011514622376214399,"s2":0.0009124175410968903,"s3":0.0011076297990796505},
{"x":56,"s1":0.005590625015390699,"s2":-0.006252540550591368,"s3":0.00406024464585473},
{"x":57,"s1":0.004388572654401906,"s2":0.0025556653002796427,"s3":-0.002909635418017246},
{"x":58,"s1":0.002902690090486067,"s2":0.0010452377084375643,"s3":-0.00029772196322133915},
{"x":59,"s1":-0.0005251122115686651,"s2":-0.00023620129699495246,"s3":-0.0005223885410319915},
{"x":60,"s1":-1.9635272583695684e-6,"s2":-0.003113399510234406,"s3":-0.0003035397377286912},
{"x":61,"s1":0.009281405806860883,"s2":-0.0061521070548821635,"s3":0.0011851409997419332},
{"x":62,"s1":-0.0032653233713926923,"s2":-0.005304947236077016,"s3":-0.0011986828597707437},
{"x":63,"s1":-0.001409231585951623,"s2":-0.0006615737139429303,"s3":0.0008180424106643923},
{"x":64,"s1":0.001337498251307311,"s2":0.0002193384563034073,"s3":0.0008980106243791665},
{"x":65,"s1":-0.0022915928951667396,"s2":0.0002792321407353327,"s3":0.00097821305338976},
{"x":66,"s1":3.9575713585776866e-5,"s2":-0.0006638881900327654,"s3":-0.0016763443685236534},
{"x":67,"s1":-0.00324389773847496,"s2":-0.0017645151609744954,"s3":0.0043501297967409045},
{"x":68,"s1":0.0035975225316134175,"s2":-0.003267814860966596,"s3":0.0003636053153636106},
{"x":69,"s1":-0.005113430856228218,"s2":0.0006082572828642592,"s3":-0.0010071655511943675},
{"x":70,"s1":-0.004993002798382819,"s2":0.009723940243411208,"s3":-0.005702445149811658},
{"x":71,"s1":-0.009320470986086293,"s2":-0.0029780169104310604,"s3":0.003918986969606545},
{"x":72,"s1":-0.00023197304082680234,"s2":0.0012920794007722249,"s3":-0.0031271599368129224},
{"x":73,"s1":-0.003204823042900912,"s2":0.0054285999539420236,"s3":-0.004117073372211275},
{"x":74,"s1":-0.003994055302439001,"s2":0.0027198495557702587,"s3":-0.004259065346662748},
{"x":75,"s1":-0.003806743964468799,"s2":0.006406695571961189,"s3":-0.002393461350316185},
{"x":76,"s1":0.002661296096342488,"s2":0.0028388608410364773,"s3":-0.0029462605321148023},
{"x":77,"s1":0.002866595410019541,"s2":0.0007792250455204031,"s3":-0.004620815834271217},
{"x":78,"s1":0.002866156709532367,"s2":0.0004803963656992543,"s3":-0.002534010050510285},
{"x":79,"s1":-0.0023795182654183563,"s2":0.0006849534753320888,"s3":-0.001148692262508663},
{"x":80,"s1":-0.002518166316742671,"s2":-0.0010416210573726045,"s3":-0.0011445198161058007},
{"x":81,"s1":0.006531361657660063,"s2":-0.0020460093081774954,"s3":-0.00040967199662193566},
{"x":82,"s1":0.006024071564797177,"s2":-0.006428072912617678,"s3":0.0009590240345851099},
{"x":83,"s1":-0.002648561127360127,"s2":0.0016838526438311303,"s3":-3.978182525660222e-5},
{"x":84,"s1":-0.0025008096312010572,"s2":0.005436349152982212,"s3":-0.0015647961447090176},
{"x":85,"s1":-0.005668268633664296,"s2":0.0009840791961302961,"s3":0.00021494412123942373},
{"x":86,"s1":0.0023595347467772376,"s2":0.0024599755401304197,"s3":-0.0029502993800365343},
{"x":87,"s1":-0.0012852393899494558,"s2":-0.0011172501040256706,"s3":0.0002815230452596452},
{"x":88,"s1":0.0039175350991087115,"s2":-0.0006962608057222328,"s3":-7.527083714478594e-5},
{"x":89,"s1":-0.001073441413650289,"s2":0.007642763573660237,"s3":-0.005101631698329539},
{"x":90,"s1":0.0044628839351487995,"s2":0.0048394356084811,"s3":-0.0036571146901741443},
{"x":91,"s1":-0.004613663226934364,"s2":0.0033199216215270694,"s3":-0.002230228574318329},
{"x":92,"s1":-0.00553764766661795,"s2":0.002732713022128527,"s3":-0.00303488081853208},
{"x":93,"s1":-0.0016835268083146779,"s2":-0.0012407501262025674,"s3":-0.000589984524355181},
{"x":94,"s1":-0.0032277831311194258,"s2":0.002947675952793602,"s3":-0.006265814979107049},
{"x":95,"s1":0.0001619629867678358,"s2":-0.0008117666900091632,"s3":0.0003107674987177712},
{"x":96,"s1":0.0025847339043269593,"s2":-0.004212883709874553,"s3":0.0002208024117658526},
{"x":97,"s1":-0.005852763296983371,"s2":0.00023006513667595931,"s3":-0.004013785537949658},
{"x":98,"s1":0.006275647691852159,"s2":0.00498624737483911,"s3":-0.002857335907070908},
{"x":99,"s1":-0.0018546193146553736,"s2":-0.0008596460853037089,"s3":0.0015644189136186548},
{"x":100,"s1":-0.0012377576912157879,"s2":-0.004548326284000701,"s3":-0.0006505974243961718},
{"x":101,"s1":-0.003368399533546575,"s2":0.006532048640305805,"s3":-0.00577386928427285},
{"x":102,"s1":0.001920762492601496,"s2":-0.003533987328058429,"s3":0.0005835250151030806},
{"x":103,"s1":-0.008579026351626053,"s2":-0.004469648936169788,"s3":0.0023705430088590902},
{"x":104,"s1":0.010610248884646341,"s2":0.0037827978675731367,"s3":-0.004407446323967403},
{"x":105,"s1":-0.005514871648418378,"s2":-0.0009199362066368022,"s3":0.0003053337888152878},
{"x":106,"s1":0.007905183817064097,"s2":-0.0007335931880903509,"s3":-0.001483200481110627},
{"x":107,"s1":0.0017110955922263308,"s2":0.0016319279917769605,"s3":-0.0007599008746334955},
{"x":108,"s1":0.005001181099989541,"s2":-0.0008260724534777331,"s3":-0.0010272253076335826},
{"x":109,"s1":-0.004446354291753056,"s2":0.004703677473813216,"s3":-0.0049572967255119},
{"x":110,"s1":0.00048085643366884925,"s2":0.002685959264930231,"s3":-0.002400276069603062},
{"x":111,"s1":-0.0034384203533598737,"s2":0.0037244570835988596,"s3":0.0008717729441970303},
{"x":112,"s1":-0.003377662044421663,"s2":0.007491819119599305,"s3":-0.008369772145810892},
{"x":113,"s1":0.0013099488415381172,"s2":0.00042358545405286684,"s3":0.0022316334703662843},
{"x":114,"s1":0.006723850807848398,"s2":-0.0015538179092236069,"s3":-0.0035648386146092262},
{"x":115,"s1":-0.001644179254737519,"s2":-0.005090642841511237,"s3":0.003137753159619043},
{"x":116,"s1":0.008864252324639893,"s2":0.005109039093434725,"s3":-0.007016068071479977},
{"x":117,"s1":2.9256052082662563e-5,"s2":0.0015674555505965383,"s3":-0.0008518816662973315},
{"x":118,"s1":-0.0008235801497251963,"s2":-0.0015743355596767022,"s3":-0.0012130705040950922},
{"x":119,"s1":4.575274640426395e-5,"s2":0.001768497575722007,"s3":-0.001555889250636646},
{"x":120,"s1":0.0032163798907094894,"s2":-0.00042142804291301706,"s3":-0.0032303084224699296},
{"x":121,"s1":0.004893618886530202,"s2":-0.0006447221172138595,"s3":-0.0012057532019868844},
{"x":122,"s1":0.008512275193839566,"s2":-8.529346725714165e-5,"s3":-0.003087420506621251},
{"x":123,"s1":0.0043516653397978455,"s2":-0.0023420039440340845,"s3":0.0019141927153241375},
{"x":124,"s1":0.008576882929027332,"s2":-0.0008098868502601579,"s3":-0.003758501001341786},
{"x":125,"s1":0.001260701299503751,"s2":0.003250123727527486,"s3":-0.0018479074095547304},
{"x":126,"s1":0.00290637666465032,"s2":-0.0016601312883673634,"s3":-0.0015919229673791561},
{"x":127,"s1":-0.0030929733275584194,"s2":0.006750634961808113,"s3":-0.004437606223516225},
{"x":128,"s1":-0.0011472715465766512,"s2":-0.0002583250047668615,"s3":-0.0017366398802257294},
{"x":129,"s1":-0.0014581912873148574,"s2":-0.0004076405640606877,"s3":-0.0030803403087832117},
{"x":130,"s1":-0.0013886943512754477,"s2":0.005978936977583341,"s3":-0.006016883214116382},
{"x":131,"s1":-0.0019469800892508832,"s2":0.0038970873302997416,"s3":-0.0008240908601881514},
{"x":132,"s1":-0.006230462346570047,"s2":0.0043353614351103005,"s3":-0.009071624231931303},
{"x":133,"s1":-0.01061189944697518,"s2":0.0021210897345453846,"s3":-0.001122264437587239},
{"x":134,"s1":0.023641413698987233,"s2":-0.003568385787822219,"s3":-0.004877230752906165},
{"x":135,"s1":-0.0018016868825879104,"s2":-0.005399671636323394,"s3":0.0010661901468540262},
{"x":136,"s1":0.007143516278581906,"s2":0.0017351270982359367,"s3":-0.007451308869546251},
{"x":137,"s1":-0.0016746505885467274,"s2":-0.006251682826660027,"s3":0.0011508879637201204},
{"x":138,"s1":0.004204342197424848,"s2":-0.002004301683038937,"s3":-0.002930101013546898},
{"x":139,"s1":-0.0012320634652198818,"s2":0.0033511459042328785,"s3":-0.0035708475891520833},
{"x":140,"s1":0.005862538446844565,"s2":-0.004946617482808052,"s3":-0.00028848270787637883},
{"x":141,"s1":-0.0015084614275441422,"s2":-0.0029874947152210016,"s3":0.0009588936848670775},
{"x":142,"s1":-0.0010472651542963742,"s2":0.003919922544143791,"s3":-0.005665334691520468},
{"x":143,"s1":0.0026034684934053446,"s2":-0.0027619060380792418,"s3":0.0007573333743390116},
{"x":144,"s1":-0.0014562017814492016,"s2":-0.0003783079092287675,"s3":-0.004144200956174195},
{"x":145,"s1":-0.000845944368192891,"s2":0.0023951145721114115,"s3":-0.0013556991278687951},
{"x":146,"s1":0.004606943224132064,"s2":-0.003655470990817104,"s3":-0.0020452787904932327},
{"x":147,"s1":-0.010478556659885504,"s2":0.006215162819869105,"s3":-0.005354624826083001},
{"x":148,"s1":0.01133929977434221,"s2":-0.0016278971698729175,"s3":-0.002702097180056755},
{"x":149,"s1":0.0016691427783338338,"s2":0.0023207778131081698,"s3":-0.004835922251050984},
{"x":150,"s1":0.005018668392570249,"s2":0.0024714944051149068,"s3":-0.004945660127540704},
{"x":151,"s1":-0.005847008915895302,"s2":-0.0010305914431404718,"s3":-0.00012222887696424333},
{"x":152,"s1":0.0028907049182020266,"s2":0.001291891884011937,"s3":-0.006264765591858154},
{"x":153,"s1":0.0010987940454154214,"s2":-0.0039009691557973375,"s3":0.0005041564795745874},
{"x":154,"s1":0.007574187333078898,"s2":-0.0008314259423731011,"s3":-0.005982196596503525},
{"x":155,"s1":-0.003055061274632391,"s2":-0.0006030343008870816,"s3":0.0008574782158516384},
{"x":156,"s1":-0.0036047389345963536,"s2":0.0006257590559704008,"s3":-0.0019137580012556752},
{"x":157,"s1":-0.005408794188236065,"s2":-0.003827758312845064,"s3":0.0015546211194009904},
{"x":158,"s1":0.0007281103760912827,"s2":-0.0033389495368074456,"s3":-0.0050463172645769565},
{"x":159,"s1":-0.001345789444408474,"s2":-9.485784883874328e-5,"s3":0.0005893996871949991},
{"x":160,"s1":-0.007590808594886698,"s2":0.0012114334001099357,"s3":-0.002597215133885727},
{"x":161,"s1":-0.005690664377265999,"s2":0.0011872994529156316,"s3":-0.0006626708651196044},
{"x":162,"s1":-0.006607229779226497,"s2":0.00470351571112066,"s3":-0.006216071643705093},
{"x":163,"s1":-0.009484500159347434,"s2":0.0004962188036783113,"s3":-0.0011633172401639207},
{"x":164,"s1":-0.004340631953696698,"s2":-0.005718734430795538,"s3":-0.0013432821370958853},
{"x":165,"s1":-0.006515467939650202,"s2":0.0018294400963229183,"s3":-0.0028184612973470445},
{"x":166,"s1":-0.0002562902361622309,"s2":-0.001998540276272955,"s3":-0.006355009287970235},
{"x":167,"s1":-0.011201809386678788,"s2":-0.0002176445057775317,"s3":0.0012811805753050788},
{"x":168,"s1":-0.009559791697520286,"s2":0.0035378982283332783,"s3":-0.004282978845522211},
{"x":169,"s1":-0.00777192481901097,"s2":-0.0024701599866677228,"s3":-0.0018881417102939967},
{"x":170,"s1":-0.003007613247784587,"s2":0.0009887016698541236,"s3":-0.004270567222392305},
{"x":171,"s1":-0.008178688676725807,"s2":-0.002747251652998975,"s3":0.00028321832571475715},
{"x":172,"s1":0.00079098402600578,"s2":-0.009681259413206366,"s3":0.0009058684411651637},
{"x":173,"s1":-0.008617829068067103,"s2":-0.0014749757295869,"s3":-0.001829689962504524},
{"x":174,"s1":0.0005765947599600061,"s2":-0.006634873859041395,"s3":0.0004164940180944662},
{"x":175,"s1":0.005464921125739162,"s2":-0.006502210271109416,"s3":0.0020147052571477357},
{"x":176,"s1":-0.0024990405476544774,"s2":-0.0007001083509095912,"s3":-0.0020241027958064635},
{"x":177,"s1":0.002544510026178494,"s2":-0.0008864919970352385,"s3":-0.00017884798396541172},
{"x":178,"s1":0.0040300760435680125,"s2":-0.0026898936457347956,"s3":-0.0015959358241729275},
{"x":179,"s1":0.000122957704273109,"s2":-0.002195047852210008,"s3":0.0004122173450687739},
{"x":180,"s1":0.007643527589505457,"s2":-0.006973944511965933,"s3":0.0023689198275974295},
{"x":181,"s1":-0.005685103096271621,"s2":0.00045097903595722337,"s3":-0.0006452848472945302},
{"x":182,"s1":-0.006009193461914969,"s2":-8.463829261048574e-5,"s3":-0.00014437149636146256},
{"x":183,"s1":-0.004758876684705069,"s2":-0.0001157227811011294,"s3":0.00010504178111136485},
{"x":184,"s1":-0.007010663579823587,"s2":0.00244496717885273,"s3":-0.00258710968378864},
{"x":185,"s1":-0.0019464818898854753,"s2":0.00028897738365214824,"s3":0.001547587381644943},
{"x":186,"s1":-0.0060166713613269045,"s2":-0.0028176965573209825,"s3":-0.0019864080373910692},
{"x":187,"s1":0.0036930301417442872,"s2":-0.0028765628329257757,"s3":0.0020721772755489584},
{"x":188,"s1":-0.0016838106637180814,"s2":0.004701304155265976,"s3":-0.007156620905318234},
{"x":189,"s1":-0.007265251791319605,"s2":0.001374247868562954,"s3":-0.0026724734481935104},
{"x":190,"s1":-0.007970461920289378,"s2":-0.000931087848742221,"s3":-0.00237482560591918},
{"x":191,"s1":-0.0040516331088952,"s2":-0.0005146465688465381,"s3":-0.0014963054502903257},
{"x":192,"s1":0.002605499034985642,"s2":-0.00671549371264137,"s3":-0.00013366116084935405},
{"x":193,"s1":0.004736994521709299,"s2":-0.00372580891002726,"s3":-0.0018674303674377029},
{"x":194,"s1":-0.0003279384964932753,"s2":-0.0053620441925638805,"s3":-0.0018169110893016768},
{"x":195,"s1":0.0049820111884687586,"s2":-0.001991415148243085,"s3":-0.0024174192405907995},
{"x":196,"s1":-0.003747487822834986,"s2":0.0019408182176087526,"s3":-0.002448133191326483},
{"x":197,"s1":0.001041813035122098,"s2":-0.004080053391331285,"s3":0.003865667930800793},
{"x":198,"s1":-0.0006080478939939613,"s2":-0.0019546496827943533,"s3":-0.0024531808967869244},
{"x":199,"s1":-0.007117448392462665,"s2":0.005947449778669051,"s3":-0.0030944872662014046},
{"x":200,"s1":0.002904339248238877,"s2":-0.0029814603180079126,"s3":0.0007641122761295035},
{"x":201,"s1":-0.008434591649109995,"s2":0.0012330333825458673,"s3":-0.002617667989488007},
{"x":202,"s1":-0.0016108268204345316,"s2":0.0008707472735760174,"s3":-0.0009015446093552848},
{"x":203,"s1":0.000602846033437485,"s2":0.0008711332396470801,"s3":-1.173658786117306e-5},
{"x":204,"s1":-0.013620049264373046,"s2":0.005340871550727579,"s3":-0.004839507057326638},
{"x":205,"s1":5.5995781483918445e-5,"s2":0.003704552636400558,"s3":-0.002273180371926034},
{"x":206,"s1":-0.003090077203931666,"s2":0.006637810716318941,"s3":-0.0082775259697138},
{"x":207,"s1":-0.0036698768884767543,"s2":0.0006430885526251516,"s3":-0.001419287407982774},
{"x":208,"s1":0.006015513246841574,"s2":0.0036083421506146207,"s3":-0.006598927287286728},
{"x":209,"s1":-0.002202169145422385,"s2":-0.0008987492892129731,"s3":-0.000414803272089716},
{"x":210,"s1":0.008937191925702024,"s2":-0.003538561918627421,"s3":-0.0028105522604069825},
{"x":211,"s1":0.0013505506127471114,"s2":0.0018468750150487604,"s3":-0.005425642575027278},
{"x":212,"s1":0.0037985636525096804,"s2":-0.005123455744016366,"s3":0.0030969553539704174},
{"x":213,"s1":-0.0033279676750613864,"s2":-0.003851665465708494,"s3":-2.365684210318712e-5},
{"x":214,"s1":-0.0013296933617063104,"s2":-0.0008131471014058462,"s3":-0.0009983868966803443},
{"x":215,"s1":-0.0018024484849772774,"s2":-0.0009985708486684637,"s3":-0.0020796680615191828},
{"x":216,"s1":-0.0005462712650441626,"s2":-0.001524404275365849,"s3":0.001277252180393031},
{"x":217,"s1":-0.012531047510291974,"s2":0.002595932621027735,"s3":0.0010582683767413866},
{"x":218,"s1":-3.9200705644236684e-5,"s2":-0.0005298174664472884,"s3":-0.0014347889428701541},
{"x":219,"s1":-0.02658316438966221,"s2":0.006964361948320437,"s3":-0.0055866566296803285},
{"x":220,"s1":0.00939657096929869,"s2":-0.0009435320058932817,"s3":-0.001580268879516442},
{"x":221,"s1":0.007010114377680701,"s2":0.0013681871199271735,"s3":-0.0029373475979162606},
{"x":222,"s1":-0.002828661776870952,"s2":0.005096971636455087,"s3":-0.0023674958202173557},
{"x":223,"s1":-0.003302913541694673,"s2":0.0032011116406744193,"s3":-0.003957903988978957},
{"x":224,"s1":-0.005456782596528765,"s2":0.006601687841221225,"s3":-0.006013573512533557},
{"x":225,"s1":-0.0011956182464333595,"s2":0.0008479751666205532,"s3":-0.003290102368669759},
{"x":226,"s1":0.0020897004813473863,"s2":0.001841351658198776,"s3":-0.006196707787149462},
{"x":227,"s1":-0.005632506275734473,"s2":0.0010997717365240083,"s3":-0.0009403638150141246},
{"x":228,"s1":-0.0006784125049468249,"s2":0.0009844615311474967,"s3":-0.0026454316273445528},
{"x":229,"s1":-0.005624635060724803,"s2":0.0005778309260113538,"s3":-0.0013947696833557072},
{"x":230,"s1":0.0020693806844584916,"s2":-0.002806630539607523,"s3":-0.00021438081804460912},
{"x":231,"s1":-0.0043734523225734175,"s2":-0.0012984732047291417,"s3":-0.0018489894273543042},
{"x":232,"s1":-0.006842035419804283,"s2":-0.0013043151388958262,"s3":0.0015183213233770285},
{"x":233,"s1":-0.01009420977176132,"s2":0.004562098639020245,"s3":-0.0007519288470544648},
{"x":234,"s1":0.00428945514200362,"s2":0.0004146186151783479,"s3":6.325322144143672e-5},
{"x":235,"s1":-0.00575159561836159,"s2":-0.0012819579197186294,"s3":-0.0021679689550018265},
{"x":236,"s1":0.008843759593692718,"s2":-0.000994783767132311,"s3":-0.0037976721914198012},
{"x":237,"s1":-0.006171261102498939,"s2":0.00045906285441239407,"s3":0.0016336527752930797},
{"x":238,"s1":0.003985272976995965,"s2":0.0016288436169158457,"s3":-0.004303196897466692},
{"x":239,"s1":-0.0038106894059174424,"s2":0.001999526046350428,"s3":-0.002918502966046543},
{"x":240,"s1":-0.006716254704932842,"s2":0.0066144869730209695,"s3":-0.004655647184986018},
{"x":241,"s1":-0.003246938393746826,"s2":-0.0049179526834103315,"s3":0.0010281734156299459},
{"x":242,"s1":0.0001666978946660704,"s2":-0.001734245372355974,"s3":-0.001889828558308332},
{"x":243,"s1":-0.0035018550225053963,"s2":0.00452669552328756,"s3":-0.004544839619219505},
{"x":244,"s1":-0.0041656107606173765,"s2":-0.0018507204818015367,"s3":-0.0022675802272719295},
{"x":245,"s1":-0.004267087111358895,"s2":0.004608844843620597,"s3":-0.0010293153463602073},
{"x":246,"s1":-0.0004352208286045339,"s2":-0.002244327502784395,"s3":-0.0023974507280778764}];
    const series = [{"name":"INDPRO","color":"#1f77b4","key":"s1","dash":""},{"name":"UNRATE","color":"#ff7f0e","key":"s2","dash":""},{"name":"CPI","color":"#2ca02c","key":"s3","dash":""}];
    const mode = 'stacked';

    const container = d3.select('#bhd_bar_55');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    const keys = series.map(s => s.key);
    const x = d3.scaleBand().domain(data.map(d=>d.x)).range([0,w]).padding(0.15);

    let yMin = 0, yMax = 0;
    if(mode === 'stacked') {
        const stack = d3.stack().keys(keys).order(d3.stackOrderNone).offset(d3.stackOffsetDiverging);
        const stacked = stack(data);
        stacked.forEach(layer => layer.forEach(d => {
            yMin = Math.min(yMin, d[0], d[1]);
            yMax = Math.max(yMax, d[0], d[1]);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.layer').data(stacked).join('g').attr('class','layer')
            .attr('fill', (d,i) => series[i].color)
            .selectAll('rect').data(d => d).join('rect')
            .attr('x', d => x(d.data.x))
            .attr('y', d => y(Math.max(d[0], d[1])))
            .attr('height', d => Math.abs(y(d[0]) - y(d[1])))
            .attr('width', x.bandwidth());

        // Zero line
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    } else {
        // Grouped
        data.forEach(d => keys.forEach(k => {
            yMin = Math.min(yMin, d[k]||0);
            yMax = Math.max(yMax, d[k]||0);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);
        const x1 = d3.scaleBand().domain(keys).range([0, x.bandwidth()]).padding(0.05);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.group').data(data).join('g').attr('class','group')
            .attr('transform', d => 'translate('+x(d.x)+',0)')
            .selectAll('rect').data(d => keys.map(k => ({key:k, val:d[k]||0})))
            .join('rect')
            .attr('x', d => x1(d.key))
            .attr('y', d => y(Math.max(0, d.val)))
            .attr('height', d => Math.abs(y(0) - y(d.val)))
            .attr('width', x1.bandwidth())
            .attr('fill', d => series.find(s=>s.key===d.key).color);

        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    }

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Contribution') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Contribution');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*90)+',0)');
            gi.append('rect').attr('width',12).attr('height',12).attr('y',-6).attr('fill',s.color);
            gi.append('text').attr('x',16).attr('y',4).attr('font-size','10px').attr('fill','#555').text(s.name);
        });
    }

    // Tooltip
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const bands = x.domain();
            const idx = Math.min(Math.floor(mx / (w / bands.length)), bands.length-1);
            const d = data[Math.max(0,idx)];
            if(!d) return;
            let html = '<b>'+d.x+'</b>';
            series.forEach(s => { if(d[s.key]!==undefined) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"actual":0.006797065473966413,"recon":0.006797065473966415},
{"x":2,"actual":0.007478081537837689,"recon":0.007478081537837689},
{"x":3,"actual":0.003931774012906786,"recon":0.003931774012906787},
{"x":4,"actual":0.01323349510920746,"recon":0.013233495109207457},
{"x":5,"actual":0.004865946043528524,"recon":0.004865946043528524},
{"x":6,"actual":0.005592546578943036,"recon":0.005592546578943036},
{"x":7,"actual":-0.00019700828905744316,"recon":-0.0001970082890574423},
{"x":8,"actual":0.004999271340642153,"recon":0.004999271340642153},
{"x":9,"actual":0.002464822424946611,"recon":0.0024648224249466098},
{"x":10,"actual":0.005784379012641949,"recon":0.005784379012641949},
{"x":11,"actual":-0.002018273083187694,"recon":-0.0020182730831876956},
{"x":12,"actual":0.00289692739416747,"recon":0.00289692739416747},
{"x":13,"actual":0.0001469114322585341,"recon":0.0001469114322585341},
{"x":14,"actual":0.005001679278237248,"recon":0.0050016792782372485},
{"x":15,"actual":-0.003129633358873285,"recon":-0.003129633358873285},
{"x":16,"actual":0.0043015363906127035,"recon":0.004301536390612704},
{"x":17,"actual":0.0024157555877204473,"recon":0.002415755587720449},
{"x":18,"actual":0.00451930917807708,"recon":0.004519309178077079},
{"x":19,"actual":0.0029453491324780146,"recon":0.0029453491324780146},
{"x":20,"actual":-0.004434996841930605,"recon":-0.004434996841930605},
{"x":21,"actual":0.002497608429581355,"recon":0.002497608429581354},
{"x":22,"actual":-0.00014968072164389667,"recon":-0.00014968072164389494},
{"x":23,"actual":-0.005701295487130054,"recon":-0.005701295487130055},
{"x":24,"actual":-7.60861911217603e-5,"recon":-7.608619112175943e-5},
{"x":25,"actual":-0.009693959689255571,"recon":-0.009693959689255573},
{"x":26,"actual":0.009750620169152846,"recon":0.009750620169152846},
{"x":27,"actual":-0.003138966589546932,"recon":-0.003138966589546933},
{"x":28,"actual":-0.0013487581284179484,"recon":-0.0013487581284179467},
{"x":29,"actual":0.0033733524412147275,"recon":0.0033733524412147267},
{"x":30,"actual":0.005469228290109207,"recon":0.005469228290109205},
{"x":31,"actual":-0.005070632766924987,"recon":-0.005070632766924987},
{"x":32,"actual":0.009040640973159597,"recon":0.009040640973159595},
{"x":33,"actual":0.004969202991748745,"recon":0.0049692029917487454},
{"x":34,"actual":-0.002623250205882499,"recon":-0.002623250205882498},
{"x":35,"actual":0.0030369033197290562,"recon":0.0030369033197290562},
{"x":36,"actual":0.0033858350269504456,"recon":0.003385835026950444},
{"x":37,"actual":-0.0017488731555337367,"recon":-0.0017488731555337367},
{"x":38,"actual":0.003486749997004601,"recon":0.003486749997004602},
{"x":39,"actual":7.625111401843299e-5,"recon":7.625111401843299e-5},
{"x":40,"actual":-0.005859653143676979,"recon":-0.00585965314367698},
{"x":41,"actual":-0.01279714376480623,"recon":-0.012797143764806234},
{"x":42,"actual":-0.007366596588133767,"recon":-0.007366596588133766},
{"x":43,"actual":-0.003261191076563641,"recon":-0.003261191076563639},
{"x":44,"actual":-0.007415936065028106,"recon":-0.007415936065028106},
{"x":45,"actual":-0.005771039266291744,"recon":-0.0057710392662917425},
{"x":46,"actual":0.0026351435941132095,"recon":0.002635143594113209},
{"x":47,"actual":0.009370150601197835,"recon":0.009370150601197839},
{"x":48,"actual":0.008070413249054553,"recon":0.008070413249054555},
{"x":49,"actual":0.0027966918655684125,"recon":0.002796691865568413},
{"x":50,"actual":-1.1339677612909327e-5,"recon":-1.1339677612910628e-5},
{"x":51,"actual":0.007901658951122492,"recon":0.007901658951122492},
{"x":52,"actual":-0.0005466018382946913,"recon":-0.0005466018382946931},
{"x":53,"actual":-0.0015836157055426625,"recon":-0.0015836157055426634},
{"x":54,"actual":-0.004874384309522917,"recon":-0.004874384309522917},
{"x":55,"actual":-0.0052512640267554644,"recon":-0.005251264026755466},
{"x":56,"actual":0.007034889592290483,"recon":0.007034889592290483},
{"x":57,"actual":0.008489522000498795,"recon":0.008489522000498795},
{"x":58,"actual":0.00756146666679669,"recon":0.00756146666679669},
{"x":59,"actual":0.0032856911647831666,"recon":0.0032856911647831683},
{"x":60,"actual":0.0005117224959834132,"recon":0.0005117224959834128},
{"x":61,"actual":0.009164938072931506,"recon":0.009164938072931506},
{"x":62,"actual":-0.005607554576631202,"recon":-0.005607554576631203},
{"x":63,"actual":0.0032931151719015617,"recon":0.0032931151719015617},
{"x":64,"actual":0.00672889068479865,"recon":0.00672889068479865},
{"x":65,"actual":0.0037850447982945568,"recon":0.0037850447982945555},
{"x":66,"actual":0.0016874963663999765,"recon":0.0016874963663999765},
{"x":67,"actual":0.003832542487244517,"recon":0.003832542487244517},
{"x":68,"actual":0.004804393879324742,"recon":0.004804393879324741},
{"x":69,"actual":-0.0008739137323683366,"recon":-0.0008739137323683383},
{"x":70,"actual":0.0027394050036360085,"recon":0.002739405003636007},
{"x":71,"actual":-0.0037915803418799854,"recon":-0.0037915803418799854},
{"x":72,"actual":0.0022526473495334542,"recon":0.002252647349533455},
{"x":73,"actual":0.002693116497312964,"recon":0.0026931164973129623},
{"x":74,"actual":-0.0012064683528301146,"recon":-0.001206468352830112},
{"x":75,"actual":0.005291488315735116,"recon":0.005291488315735115},
{"x":76,"actual":0.007303652422303131,"recon":0.0073036524223031325},
{"x":77,"actual":0.0045590055532489515,"recon":0.0045590055532489515},
{"x":78,"actual":0.00590527084702952,"recon":0.005905270847029518},
{"x":79,"actual":0.0028736794669281807,"recon":0.0028736794669281802},
{"x":80,"actual":0.0005827318302769058,"recon":0.0005827318302769058},
{"x":81,"actual":0.010149890606631295,"recon":0.010149890606631295},
{"x":82,"actual":0.005896138042652765,"recon":0.005896138042652765},
{"x":83,"actual":0.004590495958547436,"recon":0.004590495958547437},
{"x":84,"actual":0.006728449687136262,"recon":0.006728449687136262},
{"x":85,"actual":0.0013295056794984106,"recon":0.0013295056794984132},
{"x":86,"actual":0.006681857512926825,"recon":0.0066818575129268245},
{"x":87,"actual":0.0031405492615519393,"recon":0.003140549261551939},
{"x":88,"actual":0.00801293123785829,"recon":0.008012931237858291},
{"x":89,"actual":0.006812622956685388,"recon":0.006812622956685389},
{"x":90,"actual":0.010166425922232492,"recon":0.010166425922232492},
{"x":91,"actual":0.001700536197938085,"recon":0.0017005361979380868},
{"x":92,"actual":-0.0011286873050115886,"recon":-0.0011286873050115878},
{"x":93,"actual":0.0016603011582869698,"recon":0.001660301158286969},
{"x":94,"actual":-0.0017277257902161836,"recon":-0.0017277257902161836},
{"x":95,"actual":0.004898906985118856,"recon":0.004898906985118856},
{"x":96,"actual":0.0033088514322034968,"recon":0.003308851432203495},
{"x":97,"actual":-0.00418989274010606,"recon":-0.0041898927401060595},
{"x":98,"actual":0.013169322992450994,"recon":0.01316932299245099},
{"x":99,"actual":0.004025176187479218,"recon":0.004025176187479218},
{"x":100,"actual":-0.0017591074109057914,"recon":-0.0017591074109057905},
{"x":101,"actual":0.0026320058946325275,"recon":0.0026320058946325275},
{"x":102,"actual":0.003464824423083712,"recon":0.0034648244230837113},
{"x":103,"actual":-0.005740078791367509,"recon":-0.005740078791367511},
{"x":104,"actual":0.014529159926465418,"recon":0.014529159926465415},
{"x":105,"actual":-0.0012250426290405514,"recon":-0.0012250426290405514},
{"x":106,"actual":0.009901218260520928,"recon":0.00990121826052093},
{"x":107,"actual":0.0074455836229239125,"recon":0.007445583622923911},
{"x":108,"actual":0.007593378241184112,"recon":0.007593378241184111},
{"x":109,"actual":0.00015374603570972312,"recon":0.00015374603570972312},
{"x":110,"actual":0.0051052352845752935,"recon":0.005105235284575295},
{"x":111,"actual":0.006239632118214544,"recon":0.006239632118214544},
{"x":112,"actual":0.00029609405001806977,"recon":0.0002960940500180715},
{"x":113,"actual":0.009144785172068737,"recon":0.009144785172068737},
{"x":114,"actual":0.006386648092456149,"recon":0.0063866480924561495},
{"x":115,"actual":0.0015838703738682014,"recon":0.0015838703738681997},
{"x":116,"actual":0.011867816799596476,"recon":0.011867816799596477},
{"x":117,"actual":0.006326080160110159,"recon":0.00632608016011016},
{"x":118,"actual":0.0011715145153683437,"recon":0.0011715145153683442},
{"x":119,"actual":0.005524360977567255,"recon":0.005524360977567257},
{"x":120,"actual":0.004585436547763777,"recon":0.004585436547763777},
{"x":121,"actual":0.008505942659710719,"recon":0.008505942659710719},
{"x":122,"actual":0.00995494609358527,"recon":0.00995494609358527},
{"x":123,"actual":0.009117575456573768,"recon":0.009117575456573768},
{"x":124,"actual":0.008827849981996039,"recon":0.008827849981996035},
{"x":125,"actual":0.007844288895028306,"recon":0.007844288895028306},
{"x":126,"actual":0.00424944358291679,"recon":0.00424944358291679},
{"x":127,"actual":0.004373784275946591,"recon":0.0043737842759465915},
{"x":128,"actual":0.0016174896182681309,"recon":0.0016174896182681296},
{"x":129,"actual":0.0003515910121256738,"recon":0.00035159101212567465},
{"x":130,"actual":0.0034253831806134727,"recon":0.003425383180613471},
{"x":131,"actual":0.0065697125334116535,"recon":0.006569712533411654},
{"x":132,"actual":-0.006016655286145145,"recon":-0.006016655286145145},
{"x":133,"actual":-0.003852986693513749,"recon":-0.0038529866935137482},
{"x":134,"actual":0.020491901058277584,"recon":0.020491901058277584},
{"x":135,"actual":-0.0005323279149607174,"recon":-0.0005323279149607183},
{"x":136,"actual":0.006812999094851335,"recon":0.0068129990948513335},
{"x":137,"actual":-0.0007584271645324492,"recon":-0.0007584271645324474},
{"x":138,"actual":0.004520149593450817,"recon":0.004520149593450817},
{"x":139,"actual":0.0043112451049784895,"recon":0.004311245104978488},
{"x":140,"actual":0.006063079650347802,"recon":0.006063079650347803},
{"x":141,"actual":0.0022660526894453525,"recon":0.0022660526894453525},
{"x":142,"actual":0.0022959860915063857,"recon":0.0022959860915063852},
{"x":143,"actual":0.006302647258385363,"recon":0.006302647258385363},
{"x":144,"actual":-0.0007846779120086467,"recon":-0.0007846779120086449},
{"x":145,"actual":0.005769502318011099,"recon":0.005769502318011098},
{"x":146,"actual":0.004007243163624885,"recon":0.004007243163624884},
{"x":147,"actual":-0.004045261045452442,"recon":-0.004045261045452441},
{"x":148,"actual":0.012148883898799312,"recon":0.012148883898799312},
{"x":149,"actual":0.004835676101424546,"recon":0.0048356761014245455},
{"x":150,"actual":0.007683533835146861,"recon":0.00768353383514686},
{"x":151,"actual":-0.0013689853853140477,"recon":-0.0013689853853140468},
{"x":152,"actual":0.0031184257109906355,"recon":0.0031184257109906355},
{"x":153,"actual":0.00354941252967933,"recon":0.0035494125296793287},
{"x":154,"actual":0.005934581411047191,"recon":0.0059345814110471915},
{"x":155,"actual":0.0027040320534066353,"recon":0.002704032053406635},
{"x":156,"actual":0.00039045672638238216,"recon":0.000390456726382383},
{"x":157,"actual":-0.0019527324535886237,"recon":-0.0019527324535886246},
{"x":158,"actual":-0.00272663339275514,"recon":-0.002726633392755139},
{"x":159,"actual":0.004604083024880801,"recon":0.0046040830248808},
{"x":160,"actual":-0.003893384717707171,"recon":-0.0038933847177071695},
{"x":161,"actual":0.00027960447484520756,"recon":0.0002796044748452067},
{"x":162,"actual":-0.0032683707203071677,"recon":-0.0032683707203071703},
{"x":163,"actual":-0.004770869350923412,"recon":-0.0047708693509234115},
{"x":164,"actual":-0.006534765134370346,"recon":-0.006534765134370345},
{"x":165,"actual":-0.0020524117552422894,"recon":-0.0020524117552422894},
{"x":166,"actual":-0.003596380672338917,"recon":-0.003596380672338917},
{"x":167,"actual":-0.004787344785630587,"recon":-0.004787344785630584},
{"x":168,"actual":-0.005294243917338015,"recon":-0.005294243917338018},
{"x":169,"actual":-0.006424803271452895,"recon":-0.006424803271452894},
{"x":170,"actual":-0.0011484395650906976,"recon":-0.0011484395650906967},
{"x":171,"actual":-0.005077876004763837,"recon":-0.005077876004763836},
{"x":172,"actual":-0.0027452194543418074,"recon":-0.0027452194543418056},
{"x":173,"actual":-0.006065460085318719,"recon":-0.006065460085318721},
{"x":174,"actual":-0.0004275098074009165,"recon":-0.0004275098074009165},
{"x":175,"actual":0.006633064841170544,"recon":0.006633064841170545},
{"x":176,"actual":0.00011522468260949381,"recon":0.00011522468260949555},
{"x":177,"actual":0.0072123326949231625,"recon":0.007212332694923164},
{"x":178,"actual":0.004871002165678817,"recon":0.004871002165678817},
{"x":179,"actual":0.0040096284673607485,"recon":0.004009628467360747},
{"x":180,"actual":0.008215019236447851,"recon":0.008215019236447853},
{"x":181,"actual":-0.00032197063949990223,"recon":-0.0003219706394999031},
{"x":182,"actual":-0.0011111535235635017,"recon":-0.0011111535235635026},
{"x":183,"actual":0.0008486486965990636,"recon":0.0008486486965990636},
{"x":184,"actual":-0.002084836336934792,"recon":-0.0020848363369347913},
{"x":185,"actual":0.0055865759173183704,"recon":0.0055865759173183704},
{"x":186,"actual":-0.005576627290919234,"recon":-0.0055766272909192355},
{"x":187,"actual":0.00848540572389922,"recon":0.008485405723899218},
{"x":188,"actual":0.0011874209279270076,"recon":0.0011874209279270067},
{"x":189,"actual":-0.002631971347628159,"recon":-0.002631971347628159},
{"x":190,"actual":-0.005974715309085887,"recon":-0.005974715309085889},
{"x":191,"actual":-0.00027277943080949996,"recon":-0.0002727794308094991},
{"x":192,"actual":0.0012771147115513415,"recon":0.0012771147115513406},
{"x":193,"actual":0.005125135550598792,"recon":0.005125135550598792},
{"x":194,"actual":-0.002184157819974608,"recon":-0.002184157819974608},
{"x":195,"actual":0.006426751702139022,"recon":0.006426751702139021},
{"x":196,"actual":0.0012308567584176089,"recon":0.0012308567584176098},
{"x":197,"actual":0.006682592049196856,"recon":0.006682592049196855},
{"x":198,"actual":0.0002959460294098548,"recon":0.0002959460294098548},
{"x":199,"actual":0.001520626219034149,"recon":0.001520626219034149},
{"x":200,"actual":0.00601430610916065,"recon":0.0060143061091606515},
{"x":201,"actual":-0.004008755848768253,"recon":-0.004008755848768255},
{"x":202,"actual":0.0037074991758068165,"recon":0.0037074991758068174},
{"x":203,"actual":0.007197750706737338,"recon":0.007197750706737338},
{"x":204,"actual":-0.007832838806188569,"recon":-0.007832838806188572},
{"x":205,"actual":0.007443879683666665,"recon":0.007443879683666665},
{"x":206,"actual":0.0006709667193680602,"recon":0.0006709667193680584},
{"x":207,"actual":0.0012701843581544026,"recon":0.0012701843581544034},
{"x":208,"actual":0.008495312737233363,"recon":0.008495312737233364},
{"x":209,"actual":0.0024803554509942316,"recon":0.002480355450994232},
{"x":210,"actual":0.007936241000935595,"recon":0.007936241000935595},
{"x":211,"actual":0.0035900791158702816,"recon":0.00359007911587028},
{"x":212,"actual":0.007232846062771081,"recon":0.007232846062771082},
{"x":213,"actual":-0.0013521797796176571,"recon":-0.0013521797796176571},
{"x":214,"actual":0.0021501954438223336,"recon":0.0021501954438223345},
{"x":215,"actual":0.0008997205268519437,"recon":0.0008997205268519428},
{"x":216,"actual":0.004487529157463754,"recon":0.004487529157463754},
{"x":217,"actual":-0.003171466288216962,"recon":-0.0031714662882169594},
{"x":218,"actual":0.003253788346562203,"recon":0.0032537883465622035},
{"x":219,"actual":-0.0195638287695461,"recon":-0.0195638287695461},
{"x":220,"actual":0.012064329407210472,"recon":0.012064329407210472},
{"x":221,"actual":0.01117751662149491,"recon":0.011177516621494908},
{"x":222,"actual":0.005151693564231508,"recon":0.0051516935642315085},
{"x":223,"actual":0.0015766002009156566,"recon":0.0015766002009156557},
{"x":224,"actual":0.0004215001803382634,"recon":0.00042150018033826255},
{"x":225,"actual":0.002252114659746063,"recon":0.002252114659746061},
{"x":226,"actual":0.0030320784432706915,"recon":0.00303207844327069},
{"x":227,"actual":0.0002541145564114444,"recon":0.00025411455641144356},
{"x":228,"actual":0.0031614092164247154,"recon":0.003161409216424715},
{"x":229,"actual":-0.0005127465055316804,"recon":-0.0005127465055316813},
{"x":230,"actual":0.004379138878333855,"recon":0.004379138878333855},
{"x":231,"actual":-0.0016629623569395235,"recon":-0.0016629623569395227},
{"x":232,"actual":-0.0011474759561265202,"recon":-0.0011474759561265176},
{"x":233,"actual":-0.0004204326283367976,"recon":-0.0004204326283367933},
{"x":234,"actual":0.010141747096689357,"recon":0.01014174709668936},
{"x":235,"actual":-0.0033888659943164257,"recon":-0.003388865994316425},
{"x":236,"actual":0.009378469307674386,"recon":0.009378469307674386},
{"x":237,"actual":0.0017786154493029116,"recon":0.0017786154493029125},
{"x":238,"actual":0.006700319901752572,"recon":0.006700319901752574},
{"x":239,"actual":0.0009559214748104949,"recon":0.0009559214748104932},
{"x":240,"actual":0.0005768477837078123,"recon":0.0005768477837078132},
{"x":241,"actual":-0.0012002567099926864,"recon":-0.0012002567099926881},
{"x":242,"actual":0.0019240393848489745,"recon":0.0019240393848489745},
{"x":243,"actual":0.002220126784417964,"recon":0.002220126784417966},
{"x":244,"actual":-0.002824061214514728,"recon":-0.002824061214514729},
{"x":245,"actual":0.005320711796714228,"recon":0.00532071179671423},
{"x":246,"actual":0.00034876070631284506,"recon":0.00034876070631284506}];
    const series = [{"name":"Actual","color":"#1f77b4","key":"actual","dash":""},{"name":"Reconstructed","color":"#ff7f0e","key":"recon","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#bhd_line_56');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"s1":-0.0003553293531233598,"s2":-0.03125510469881633,"s3":0.0},
{"x":2,"s1":-0.002036734494710829,"s2":-0.06543723139435534,"s3":0.0007760702416017688},
{"x":3,"s1":-0.008060456880624957,"s2":-0.059754411203007916,"s3":-0.0002515757957274774},
{"x":4,"s1":-0.004721265895368143,"s2":0.14061148773457074,"s3":0.0010362274040893106},
{"x":5,"s1":-0.019929114260651647,"s2":-0.1706190235348534,"s3":-0.002167207028095808},
{"x":6,"s1":-0.02478600551191305,"s2":-0.059763855742194394,"s3":-0.0009267988100915331},
{"x":7,"s1":-0.01850798135096033,"s2":0.024172610620364285,"s3":0.009056878306838318},
{"x":8,"s1":-0.010586601821245618,"s2":0.025528731225301804,"s3":-0.0073805682852421},
{"x":9,"s1":-0.0009811899705246894,"s2":0.009105200060861641,"s3":0.0029707926807221226},
{"x":10,"s1":-0.0037097596273092544,"s2":-0.2875008849106512,"s3":0.0021652047848854305},
{"x":11,"s1":0.002304105552151838,"s2":0.20732060943108815,"s3":0.00686466296935596},
{"x":12,"s1":0.002421774273749212,"s2":-0.1892848310677328,"s3":-0.00041239675527628833},
{"x":13,"s1":0.012417245833375447,"s2":-9.850585954199985e-5,"s3":0.003382439134805406},
{"x":14,"s1":0.017278254088449765,"s2":0.18558607204988195,"s3":0.01622002716503387},
{"x":15,"s1":0.011443932762789473,"s2":-0.19398807996548706,"s3":0.00047203834037832235},
{"x":16,"s1":0.017666282440525646,"s2":-0.013152702020948665,"s3":0.010302128706083186},
{"x":17,"s1":0.0008627687504394929,"s2":-0.09175734183162866,"s3":0.008715650914885688},
{"x":18,"s1":0.011233383421380371,"s2":0.007915272522070565,"s3":-0.0015071752278104124},
{"x":19,"s1":0.00038725903888533667,"s2":0.09778401441921067,"s3":0.01886929419555943},
{"x":20,"s1":0.007611133288491112,"s2":-0.19688541935342557,"s3":0.012231467526028134},
{"x":21,"s1":0.018922811318546798,"s2":-0.21450134620948025,"s3":0.019168498420308495},
{"x":22,"s1":0.022652116893313947,"s2":0.20076493880573257,"s3":0.001589946142299302},
{"x":23,"s1":0.02285532119152012,"s2":-0.005558086451159738,"s3":0.014009161731002067},
{"x":24,"s1":0.033094262363691576,"s2":0.077346616158521,"s3":0.024219509346929756},
{"x":25,"s1":0.04357634817207423,"s2":-0.11931465387383548,"s3":0.007924965592822112},
{"x":26,"s1":0.04812433151735553,"s2":-0.01509380919333228,"s3":0.005526298682958076},
{"x":27,"s1":0.037022550259453994,"s2":0.08800730713139918,"s3":0.013085571193742953},
{"x":28,"s1":0.012127400453184346,"s2":0.02161378458933961,"s3":0.004896522660151033},
{"x":29,"s1":0.04078306141614367,"s2":0.07005309481526886,"s3":0.02577093251391349},
{"x":30,"s1":0.04072051606729292,"s2":-0.009544191445318454,"s3":0.007466616308533319},
{"x":31,"s1":0.006939142564272707,"s2":0.008990805018475826,"s3":0.01977141838385907},
{"x":32,"s1":0.013801127535062222,"s2":-0.09604169499666554,"s3":0.01833179126893928},
{"x":33,"s1":0.0035220790501543954,"s2":-0.08513027826237252,"s3":0.014185060303167834},
{"x":34,"s1":0.0075541995629846495,"s2":0.20271692643723815,"s3":0.025172456940875405},
{"x":35,"s1":0.013378335783201958,"s2":0.013324143505467742,"s3":0.0048937905362900986},
{"x":36,"s1":0.011023662708529705,"s2":-0.20143759972455463,"s3":0.022754361095963252},
{"x":37,"s1":0.012702259286796514,"s2":0.30657658208610733,"s3":0.011530992290267127},
{"x":38,"s1":0.022140148992349454,"s2":0.21109242747162313,"s3":-0.0007938612842316466},
{"x":39,"s1":0.0010658604547653275,"s2":0.21500390425144253,"s3":0.013352749723900798},
{"x":40,"s1":0.012306729076819883,"s2":0.015780400299741863,"s3":0.003385376766159686},
{"x":41,"s1":0.013162620589905439,"s2":0.3075763923445253,"s3":0.008554109796674324},
{"x":42,"s1":0.043552531217056475,"s2":0.0897811954347509,"s3":-0.0023507937549473324},
{"x":43,"s1":0.043129268428590696,"s2":0.08433417054369989,"s3":0.0023451307581305665},
{"x":44,"s1":0.04814796673107744,"s2":0.15786592176890518,"s3":0.02403082069387961},
{"x":45,"s1":0.05432769079029941,"s2":0.17398978676634433,"s3":-0.0011646121695242208},
{"x":46,"s1":0.06581831883179153,"s2":-0.1514200684192472,"s3":0.01598611605554093},
{"x":47,"s1":0.03205853357427631,"s2":0.16974469917052576,"s3":0.02605341855893306},
{"x":48,"s1":0.021634286759449835,"s2":-5.606244572763496e-5,"s3":0.0057138446968014985},
{"x":49,"s1":-0.0033534676063759357,"s2":-0.08795391555207689,"s3":0.018575302834053273},
{"x":50,"s1":0.0002601590422272201,"s2":0.10723516456313849,"s3":0.020537400650178124},
{"x":51,"s1":0.0008357333230494315,"s2":0.008950530297379768,"s3":0.017010171709613418},
{"x":52,"s1":0.011541612958973789,"s2":0.11572798456162585,"s3":0.0007493343276643017},
{"x":53,"s1":-0.004065682472531718,"s2":0.01387542479550859,"s3":0.01624383289546907},
{"x":54,"s1":0.018614063073177527,"s2":0.29750052084615947,"s3":0.011469877606126977},
{"x":55,"s1":0.03170834835246802,"s2":0.00046226028707795004,"s3":-0.004413923005511566},
{"x":56,"s1":0.04151983072445632,"s2":0.09639335412988262,"s3":-0.009464715390925107},
{"x":57,"s1":0.038582139314952434,"s2":-0.0268476051260502,"s3":0.014690072752463429},
{"x":58,"s1":0.010088635904827122,"s2":0.029217519533726616,"s3":-0.011014462295068058},
{"x":59,"s1":0.01074540737718525,"s2":0.20199575062625455,"s3":0.016024965842743835},
{"x":60,"s1":0.017075897055248687,"s2":0.20969129576253653,"s3":0.002384353553719077},
{"x":61,"s1":0.024697646080711656,"s2":-0.11453611979129745,"s3":0.017607292669161258},
{"x":62,"s1":0.004427140070990368,"s2":-0.08767820275935385,"s3":0.013242512006433301},
{"x":63,"s1":0.0008907100434511397,"s2":0.01803459806424488,"s3":0.01171923140757811},
{"x":64,"s1":0.017395162617293087,"s2":-0.2995566853605985,"s3":0.013226078965761844},
{"x":65,"s1":0.008217522050830397,"s2":0.11171676263318323,"s3":0.009759711762026443},
{"x":66,"s1":0.02116881973490597,"s2":-0.0071991255421517825,"s3":0.019277513439867885},
{"x":67,"s1":0.021395243269594317,"s2":-0.10397747709298699,"s3":0.013893625777424989},
{"x":68,"s1":0.021442734521554305,"s2":-0.20255034970863237,"s3":0.01347167381457989},
{"x":69,"s1":0.013458429985988465,"s2":-0.08031160732307056,"s3":-0.000551292818224524},
{"x":70,"s1":0.023478241912469576,"s2":0.10484055082352388,"s3":0.005186520662780733},
{"x":71,"s1":0.015123440387293597,"s2":0.0021407109666508614,"s3":0.014469187866962805},
{"x":72,"s1":0.04524618047671544,"s2":-0.1309059996837446,"s3":0.01999193988789985},
{"x":73,"s1":0.035206996465772106,"s2":-0.1127550078561749,"s3":0.010637742176222594},
{"x":74,"s1":0.035166008281327626,"s2":-0.11495172758599881,"s3":0.014122220144005455},
{"x":75,"s1":0.022518852433920437,"s2":-0.11541547588554224,"s3":0.027051124992046593},
{"x":76,"s1":0.02785360045474532,"s2":0.08345898535269493,"s3":0.02566590875481726},
{"x":77,"s1":0.023998304977960946,"s2":-0.2170525047086543,"s3":0.02826196276825227},
{"x":78,"s1":0.016397714381103663,"s2":-0.11097615860349701,"s3":0.03338932895424092},
{"x":79,"s1":-0.0020483628968262736,"s2":0.10517834605951201,"s3":0.0361447716128781},
{"x":80,"s1":-0.0021966048845024045,"s2":0.028986922345730155,"s3":0.014177950442317244},
{"x":81,"s1":0.011288283939209418,"s2":-0.10175168177588481,"s3":0.031016894169705333},
{"x":82,"s1":-0.0032716463344681047,"s2":-0.07460443215699991,"s3":0.021774660097545313},
{"x":83,"s1":-0.016969634666745195,"s2":-0.2606944087112181,"s3":0.021546850159112032},
{"x":84,"s1":-0.010990633340308946,"s2":0.04243883608044831,"s3":0.013173437976541805},
{"x":85,"s1":-0.006757606082888762,"s2":0.030602323843079166,"s3":0.019463965832060153},
{"x":86,"s1":0.02139849891016623,"s2":-0.08832946045671802,"s3":0.013329621013507964},
{"x":87,"s1":0.010083639971547844,"s2":-0.09068084511923499,"s3":0.024945579428401275},
{"x":88,"s1":-0.0005872973409579779,"s2":-0.07027695075235896,"s3":0.015516528575520125},
{"x":89,"s1":0.006386607688062008,"s2":-0.17523984485786437,"s3":0.012307229677545118},
{"x":90,"s1":-0.01091099405561444,"s2":-0.056018875169266666,"s3":0.0114091864745683},
{"x":91,"s1":-0.018433531717768948,"s2":0.12261362623637054,"s3":0.03889452856920219},
{"x":92,"s1":0.0004897734859586412,"s2":-0.18345451077562036,"s3":0.027017247814861402},
{"x":93,"s1":0.0011982121680807205,"s2":0.019229827652381567,"s3":0.021710407005936856},
{"x":94,"s1":0.014919588330178545,"s2":0.3982989467391346,"s3":0.02977763130713861},
{"x":95,"s1":0.0019920039698683237,"s2":-0.17951638749490592,"s3":0.020272583733223538},
{"x":96,"s1":-0.00257104361364116,"s2":0.011159790338771009,"s3":0.035091529959837685},
{"x":97,"s1":-0.011897452468518378,"s2":0.12307954586198737,"s3":0.029693007801254556},
{"x":98,"s1":0.005744145898864706,"s2":0.028315993276547085,"s3":0.008941121389530385},
{"x":99,"s1":-0.009564011472897272,"s2":-0.08707146565866944,"s3":0.038668065280240534},
{"x":100,"s1":-0.01476943056249054,"s2":-0.0766797162219052,"s3":0.03361755464740326},
{"x":101,"s1":0.010798537869446168,"s2":0.09947523518629871,"s3":0.0304596734261263},
{"x":102,"s1":0.005157348107298604,"s2":0.015449226975120378,"s3":0.021036036667701586},
{"x":103,"s1":0.006675847601732368,"s2":-0.002203882345257012,"s3":0.03577270204004704},
{"x":104,"s1":0.011019910028041735,"s2":-0.10541199013150442,"s3":0.03574949092789729},
{"x":105,"s1":-0.001851838299144386,"s2":0.022676117947942696,"s3":0.018754507335837993},
{"x":106,"s1":0.0009976346889567264,"s2":0.11342546672456355,"s3":0.026204199405136613},
{"x":107,"s1":-0.009987401195561022,"s2":0.02954169682666875,"s3":0.019725344409281843},
{"x":108,"s1":-0.015507499955158838,"s2":-0.2703353517362922,"s3":0.026703541667232628},
{"x":109,"s1":-0.00723121808310011,"s2":0.2135783097733281,"s3":0.03282995456177987},
{"x":110,"s1":-0.0014063300463053356,"s2":-0.3771048886254125,"s3":0.0188766488797782},
{"x":111,"s1":-0.010606207525693091,"s2":0.11994486758838929,"s3":0.030323209711890304},
{"x":112,"s1":0.013944212360318564,"s2":-0.007134696111879455,"s3":0.03425287506746934},
{"x":113,"s1":0.011161684155786309,"s2":0.1998343947430618,"s3":0.028619309234738426},
{"x":114,"s1":0.030242331625232273,"s2":-0.025488600238977276,"s3":0.03663616063158665},
{"x":115,"s1":-0.01016252870094853,"s2":-0.05987565041926625,"s3":0.011053264738660678},
{"x":116,"s1":0.0028115394118193903,"s2":-0.0953588817658513,"s3":0.03451819425989176},
{"x":117,"s1":-0.013248048964771289,"s2":0.03354134462667736,"s3":0.0203204574963711},
{"x":118,"s1":-0.003936364719575614,"s2":-0.07444474527446301,"s3":0.022120475736807338},
{"x":119,"s1":-0.010114742622777794,"s2":-0.19335006325780185,"s3":0.04570861704208159},
{"x":120,"s1":0.020880244677869874,"s2":0.10004502937700481,"s3":0.02196994362734039},
{"x":121,"s1":-0.0013945605447381253,"s2":-0.10267277310563024,"s3":0.04691772469577575},
{"x":122,"s1":-1.4321867467928517e-5,"s2":-0.07652314006981989,"s3":0.02101102675677015},
{"x":123,"s1":-0.018680026847290147,"s2":0.11687338384890075,"s3":0.044555090598373384},
{"x":124,"s1":-0.01982449088925334,"s2":-0.1595530783152232,"s3":0.02369286740378359},
{"x":125,"s1":-0.02479824921776349,"s2":-0.0627215665119364,"s3":0.030590633696841545},
{"x":126,"s1":-0.02896610480615453,"s2":0.14525203038513465,"s3":0.027802755700050207},
{"x":127,"s1":-0.01054045002151793,"s2":-0.07599740162653167,"s3":0.02987729560633654},
{"x":128,"s1":-0.005428111458595783,"s2":0.023175544900357916,"s3":0.027036976656740236},
{"x":129,"s1":0.0013791089931420486,"s2":0.10255175438886052,"s3":0.03867054158212304},
{"x":130,"s1":0.016314266081353133,"s2":-0.39024594529521306,"s3":0.018476327132089854},
{"x":131,"s1":-0.0018427655086974408,"s2":0.09768522229741548,"s3":0.04861834117368272},
{"x":132,"s1":0.019922605923829783,"s2":0.09682698241826253,"s3":0.028696864119056108},
{"x":133,"s1":0.018710559160292687,"s2":-0.01576944643867521,"s3":0.04106345422885871},
{"x":134,"s1":0.0398600251472313,"s2":-0.04002479378170763,"s3":0.046508345165929534},
{"x":135,"s1":0.005386716919985676,"s2":0.10869260984536504,"s3":0.032355778173940565},
{"x":136,"s1":-0.014979869592592693,"s2":-0.07892633622184297,"s3":0.041311555025546225},
{"x":137,"s1":-0.027229438153980497,"s2":-0.06354581520944144,"s3":0.03695319157361258},
{"x":138,"s1":-0.009387916369458633,"s2":0.017775500924919037,"s3":0.04057066805000035},
{"x":139,"s1":-0.012804246917991697,"s2":-0.07995789420151304,"s3":0.04058422079331604},
{"x":140,"s1":-0.0039326752173883175,"s2":0.12317555792879242,"s3":0.02966780840242301},
{"x":141,"s1":-0.020353760571047572,"s2":-0.18890051619568343,"s3":0.05762158221794085},
{"x":142,"s1":0.004148007175447953,"s2":0.1300826337612165,"s3":0.015260820519359456},
{"x":143,"s1":-0.010023119402388179,"s2":-0.07825420199304765,"s3":0.036384368426406286},
{"x":144,"s1":0.0021684382732475582,"s2":0.11385286804984947,"s3":0.03383236756128347},
{"x":145,"s1":-0.0106674041817378,"s2":0.021960521529851368,"s3":0.0370368358474979},
{"x":146,"s1":-0.0018234303489034552,"s2":-0.06954778570445432,"s3":0.020330942160063776},
{"x":147,"s1":0.0105000451755738,"s2":0.0030889748759060725,"s3":0.03477777385021974},
{"x":148,"s1":-0.007080319967658025,"s2":-0.07461064821760521,"s3":0.03131209298405648},
{"x":149,"s1":3.687966430611922e-5,"s2":0.00789062125305916,"s3":0.03952440743937496},
{"x":150,"s1":-0.008757694259208696,"s2":-0.0740870184547934,"s3":0.03217143137455498},
{"x":151,"s1":-0.023412320377342078,"s2":0.02183545937816698,"s3":0.04993146643744194},
{"x":152,"s1":0.0066911938493778205,"s2":0.10682584742619775,"s3":0.03535502881199196},
{"x":153,"s1":-0.01403574415411979,"s2":-0.0791538084080183,"s3":0.040923576491098554},
{"x":154,"s1":0.002740400038057338,"s2":-0.18741564382392595,"s3":0.03400509924229322},
{"x":155,"s1":-0.020970064243904567,"s2":0.2293774086025933,"s3":0.039624290028676304},
{"x":156,"s1":-0.004084558999372207,"s2":0.0220450521335327,"s3":0.03072869479527171},
{"x":157,"s1":-0.013422791464786402,"s2":0.028186171500674862,"s3":0.032562335428271354},
{"x":158,"s1":0.025486922352647857,"s2":0.08393698681126403,"s3":0.03953119440484519},
{"x":159,"s1":0.00909881081874531,"s2":-0.18830553299890374,"s3":0.026480623347248634},
{"x":160,"s1":0.0070155501597497765,"s2":0.012656971236460268,"s3":0.028401484395616107},
{"x":161,"s1":0.007873882473516294,"s2":0.0041381208703725044,"s3":0.034672824001768285},
{"x":162,"s1":0.04266764358820604,"s2":-0.0205591437343421,"s3":0.025635946586600577},
{"x":163,"s1":0.02116308198783621,"s2":0.2787673025534131,"s3":0.046710957438238304},
{"x":164,"s1":0.04806859500614557,"s2":-0.03790477897051397,"s3":0.03754152514044948},
{"x":165,"s1":0.03444663680207481,"s2":0.07203194132515159,"s3":0.0392663741550036},
{"x":166,"s1":0.03840598222062848,"s2":0.08081447087048668,"s3":0.02787966858529751},
{"x":167,"s1":0.025040716299557654,"s2":-0.10921779074225979,"s3":0.031094634306171993},
{"x":168,"s1":0.032098104038371,"s2":0.16492212706939652,"s3":0.05053437336429748},
{"x":169,"s1":0.03472359775898788,"s2":0.06983640695100111,"s3":0.040996030107149146},
{"x":170,"s1":0.06535505862015475,"s2":0.25494245109713864,"s3":0.027811865033031354},
{"x":171,"s1":0.03861959038988687,"s2":0.05553483362392997,"s3":0.05314207724548211},
{"x":172,"s1":0.04422768849175965,"s2":0.27339106199520447,"s3":0.030324339114478766},
{"x":173,"s1":0.036618232425482275,"s2":0.16878065188891542,"s3":0.04179495993298841},
{"x":174,"s1":0.03324001288927175,"s2":0.20431714541916693,"s3":0.011256058327705609},
{"x":175,"s1":0.03546125871971434,"s2":-0.029737598050563828,"s3":0.04211583625202047},
{"x":176,"s1":0.019249603825862525,"s2":-0.0016603421513362421,"s3":0.03179882534174302},
{"x":177,"s1":0.004895030864653102,"s2":0.016220464200922543,"s3":0.027024834044965734},
{"x":178,"s1":0.02193166768845093,"s2":0.1940114803616361,"s3":0.0332874911320808},
{"x":179,"s1":0.01256515477057989,"s2":-0.09989285002695843,"s3":0.03577283063770262},
{"x":180,"s1":0.009102556078108151,"s2":0.01422624727214615,"s3":0.026700416169601497},
{"x":181,"s1":0.007738892200263778,"s2":0.0062721719644981185,"s3":0.0342538341663716},
{"x":182,"s1":0.008986509502680814,"s2":-0.0705618626395237,"s3":0.010830104634738097},
{"x":183,"s1":0.014592313153097728,"s2":0.00644108414392233,"s3":0.027651957563779212},
{"x":184,"s1":0.04122540146357091,"s2":-0.003321215063267735,"s3":0.012030276041918784},
{"x":185,"s1":0.034126133913620724,"s2":0.18820955295189873,"s3":0.025771025468208825},
{"x":186,"s1":0.04073038204914277,"s2":0.08769123486693545,"s3":0.02108082129950032},
{"x":187,"s1":0.036084959160055885,"s2":-0.19545056238090086,"s3":0.008487212174473029},
{"x":188,"s1":0.03547278695666305,"s2":0.08575927201447842,"s3":0.028654975632180214},
{"x":189,"s1":0.007891285595080906,"s2":0.017394598852929346,"s3":0.02325086808022379},
{"x":190,"s1":0.04154722730541848,"s2":0.08347963849266157,"s3":0.025787280719563162},
{"x":191,"s1":0.0388777434710209,"s2":0.07833930715962929,"s3":0.03229612235812057},
{"x":192,"s1":0.05405689242161198,"s2":0.16616473985473557,"s3":0.030250728978948288},
{"x":193,"s1":0.040321687876135465,"s2":-0.127527572640798,"s3":0.037288096012018206},
{"x":194,"s1":0.009399628512335322,"s2":-0.08677468958613321,"s3":0.028761185723688916},
{"x":195,"s1":0.007598298414480312,"s2":0.0013298215938641078,"s3":0.04115092297926882},
{"x":196,"s1":0.01658332226171893,"s2":-0.09549509368283611,"s3":0.030574103313067404},
{"x":197,"s1":0.00015759642684353721,"s2":-0.18365794737511082,"s3":0.03394162916412049},
{"x":198,"s1":0.01947807980271765,"s2":-0.10954445156709858,"s3":0.04149650418836041},
{"x":199,"s1":0.015424160052010166,"s2":0.009579030770407991,"s3":0.025726176645060946},
{"x":200,"s1":0.021437704934728127,"s2":-0.10110779742391936,"s3":0.03155708754211076},
{"x":201,"s1":0.02631511789520672,"s2":0.19709944721629571,"s3":0.026613924973855646},
{"x":202,"s1":0.01773710048377588,"s2":-0.19028746679676992,"s3":0.024128261216478545},
{"x":203,"s1":0.024099350696986467,"s2":0.005468996342155221,"s3":0.021354830942027635},
{"x":204,"s1":0.025992746781250818,"s2":0.0074863593134828765,"s3":0.018145454196106095},
{"x":205,"s1":0.017515339819703428,"s2":-0.08710530465394187,"s3":0.01964413407228252},
{"x":206,"s1":0.04518793786891506,"s2":-0.12290516642735246,"s3":0.029433948901427483},
{"x":207,"s1":0.023161335479106742,"s2":-0.00043580384162560175,"s3":0.02829985426884855},
{"x":208,"s1":0.03991125227793364,"s2":0.06899719777645087,"s3":0.04273694917735518},
{"x":209,"s1":0.005983456408070486,"s2":-0.09444568956866643,"s3":0.038754845112409904},
{"x":210,"s1":0.009169109797058268,"s2":0.003365734000721242,"s3":0.03949587961281027},
{"x":211,"s1":0.004279041065266424,"s2":-0.08879437196066743,"s3":0.03524651371019908},
{"x":212,"s1":-0.018625103692901768,"s2":0.141176235157677,"s3":0.029214716363053277},
{"x":213,"s1":-0.012114046122186306,"s2":-0.17982789176271569,"s3":0.04257732376670357},
{"x":214,"s1":-0.011845138397832541,"s2":0.039505317047477895,"s3":0.023765503934925415},
{"x":215,"s1":0.004763507519715814,"s2":-0.09424166929120202,"s3":0.03987726153976066},
{"x":216,"s1":0.0065275892049517555,"s2":-0.06825048742211565,"s3":0.013539598473084438},
{"x":217,"s1":-0.006528167708968182,"s2":0.017737027757642347,"s3":0.038751266137311224},
{"x":218,"s1":0.014318552202595,"s2":-0.08345940122174336,"s3":0.019894705523345064},
{"x":219,"s1":0.03626983067981408,"s2":0.0902380274301578,"s3":0.02374854669420513},
{"x":220,"s1":0.03754025160421582,"s2":-0.020305625330413402,"s3":0.0339068770260375},
{"x":221,"s1":0.05457978261050078,"s2":-0.02781680381535672,"s3":0.022469238579656277},
{"x":222,"s1":-0.006630386715716379,"s2":-0.07091518172005552,"s3":0.02839043786497685},
{"x":223,"s1":-0.010876661998515145,"s2":-0.1650952803610346,"s3":0.025855924606640778},
{"x":224,"s1":0.020994358146571936,"s2":0.0902027743960567,"s3":0.03940887113167234},
{"x":225,"s1":0.0010564622560386143,"s2":-0.10044109619691784,"s3":0.04897384134492013},
{"x":226,"s1":0.02539779871800287,"s2":-0.005834785885220581,"s3":0.031468000953042766},
{"x":227,"s1":0.0007069878177075483,"s2":-0.10535858764454561,"s3":0.05456209914300646},
{"x":228,"s1":0.017903009368953116,"s2":-0.007084494139503461,"s3":0.040219277650612936},
{"x":229,"s1":0.007011575994491244,"s2":0.10899958100129303,"s3":0.03414550750864971},
{"x":230,"s1":0.008986813270867103,"s2":0.004698992000194673,"s3":0.03780476560042807},
{"x":231,"s1":0.019806714400100598,"s2":-0.20399314896641033,"s3":0.03452525003609906},
{"x":232,"s1":0.00711438482527778,"s2":-0.08548622056630488,"s3":0.030115259866933662},
{"x":233,"s1":0.028210197100725736,"s2":0.10401303168733818,"s3":0.01839208446429374},
{"x":234,"s1":0.03652561793189813,"s2":-0.1036665098246724,"s3":0.01878026812636336},
{"x":235,"s1":0.016130694439560337,"s2":0.1890016947354228,"s3":0.04579163212728838},
{"x":236,"s1":0.032479612097087975,"s2":-0.10191709559460653,"s3":0.02156314132280439},
{"x":237,"s1":0.004428309382770427,"s2":-0.0865662936516721,"s3":0.03254097751295178},
{"x":238,"s1":0.004295040847830204,"s2":0.11230448068090035,"s3":0.03516617912035892},
{"x":239,"s1":-0.0006319487021457197,"s2":-0.07059966179301987,"s3":0.022570724106407817},
{"x":240,"s1":0.005327796048774576,"s2":0.20788170435428147,"s3":0.03864368971256778},
{"x":241,"s1":0.01176516465696675,"s2":0.09648332217145963,"s3":0.042011676240850906},
{"x":242,"s1":0.03524838034462919,"s2":-0.11089732685571707,"s3":0.0278864821981533},
{"x":243,"s1":0.01477796355005034,"s2":0.10572100091922369,"s3":0.030691281597180636},
{"x":244,"s1":0.01182269522226636,"s2":0.008480732598778316,"s3":0.03153929447342421},
{"x":245,"s1":0.017516936026737474,"s2":-0.016573357817740657,"s3":0.050011055104737336},
{"x":246,"s1":0.028378666248092776,"s2":0.29697979484027337,"s3":0.026954162154717513}];
    const series = [{"name":"INDPRO","color":"#1f77b4","key":"s1","dash":""},{"name":"UNRATE","color":"#ff7f0e","key":"s2","dash":""},{"name":"CPI","color":"#2ca02c","key":"s3","dash":""}];
    const mode = 'stacked';

    const container = d3.select('#bhd_bar_57');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    const keys = series.map(s => s.key);
    const x = d3.scaleBand().domain(data.map(d=>d.x)).range([0,w]).padding(0.15);

    let yMin = 0, yMax = 0;
    if(mode === 'stacked') {
        const stack = d3.stack().keys(keys).order(d3.stackOrderNone).offset(d3.stackOffsetDiverging);
        const stacked = stack(data);
        stacked.forEach(layer => layer.forEach(d => {
            yMin = Math.min(yMin, d[0], d[1]);
            yMax = Math.max(yMax, d[0], d[1]);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.layer').data(stacked).join('g').attr('class','layer')
            .attr('fill', (d,i) => series[i].color)
            .selectAll('rect').data(d => d).join('rect')
            .attr('x', d => x(d.data.x))
            .attr('y', d => y(Math.max(d[0], d[1])))
            .attr('height', d => Math.abs(y(d[0]) - y(d[1])))
            .attr('width', x.bandwidth());

        // Zero line
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    } else {
        // Grouped
        data.forEach(d => keys.forEach(k => {
            yMin = Math.min(yMin, d[k]||0);
            yMax = Math.max(yMax, d[k]||0);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);
        const x1 = d3.scaleBand().domain(keys).range([0, x.bandwidth()]).padding(0.05);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.group').data(data).join('g').attr('class','group')
            .attr('transform', d => 'translate('+x(d.x)+',0)')
            .selectAll('rect').data(d => keys.map(k => ({key:k, val:d[k]||0})))
            .join('rect')
            .attr('x', d => x1(d.key))
            .attr('y', d => y(Math.max(0, d.val)))
            .attr('height', d => Math.abs(y(0) - y(d.val)))
            .attr('width', x1.bandwidth())
            .attr('fill', d => series.find(s=>s.key===d.key).color);

        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    }

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Contribution') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Contribution');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*90)+',0)');
            gi.append('rect').attr('width',12).attr('height',12).attr('y',-6).attr('fill',s.color);
            gi.append('text').attr('x',16).attr('y',4).attr('font-size','10px').attr('fill','#555').text(s.name);
        });
    }

    // Tooltip
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const bands = x.domain();
            const idx = Math.min(Math.floor(mx / (w / bands.length)), bands.length-1);
            const d = data[Math.max(0,idx)];
            if(!d) return;
            let html = '<b>'+d.x+'</b>';
            series.forEach(s => { if(d[s.key]!==undefined) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":2,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":3,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":4,"actual":0.09999999999999964,"recon":0.09999999999999967},
{"x":5,"actual":-0.20000000000000018,"recon":-0.20000000000000015},
{"x":6,"actual":-0.09999999999999964,"recon":-0.09999999999999962},
{"x":7,"actual":0.0,"recon":1.0408340855860843e-17},
{"x":8,"actual":0.0,"recon":-2.6020852139652106e-18},
{"x":9,"actual":0.0,"recon":3.469446951953614e-18},
{"x":10,"actual":-0.2999999999999998,"recon":-0.2999999999999998},
{"x":11,"actual":0.1999999999999993,"recon":0.19999999999999926},
{"x":12,"actual":-0.1999999999999993,"recon":-0.19999999999999934},
{"x":13,"actual":0.0,"recon":3.469446951953614e-18},
{"x":14,"actual":0.1999999999999993,"recon":0.1999999999999993},
{"x":15,"actual":-0.1999999999999993,"recon":-0.19999999999999932},
{"x":16,"actual":0.0,"recon":-3.469446951953614e-18},
{"x":17,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":18,"actual":0.0,"recon":-3.469446951953614e-18},
{"x":19,"actual":0.10000000000000053,"recon":0.10000000000000055},
{"x":20,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":21,"actual":-0.20000000000000018,"recon":-0.20000000000000023},
{"x":22,"actual":0.20000000000000018,"recon":0.20000000000000018},
{"x":23,"actual":0.0,"recon":0.0},
{"x":24,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":25,"actual":-0.09999999999999964,"recon":-0.09999999999999969},
{"x":26,"actual":0.0,"recon":0.0},
{"x":27,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":28,"actual":0.0,"recon":0.0},
{"x":29,"actual":0.10000000000000053,"recon":0.1000000000000005},
{"x":30,"actual":0.0,"recon":0.0},
{"x":31,"actual":0.0,"recon":6.938893903907228e-18},
{"x":32,"actual":-0.10000000000000053,"recon":-0.10000000000000055},
{"x":33,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":34,"actual":0.20000000000000018,"recon":0.20000000000000018},
{"x":35,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":36,"actual":-0.20000000000000018,"recon":-0.2000000000000002},
{"x":37,"actual":0.2999999999999998,"recon":0.2999999999999998},
{"x":38,"actual":0.20000000000000018,"recon":0.20000000000000023},
{"x":39,"actual":0.20000000000000018,"recon":0.2000000000000002},
{"x":40,"actual":0.0,"recon":0.0},
{"x":41,"actual":0.2999999999999998,"recon":0.2999999999999997},
{"x":42,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":43,"actual":0.10000000000000053,"recon":0.10000000000000056},
{"x":44,"actual":0.1999999999999993,"recon":0.1999999999999993},
{"x":45,"actual":0.20000000000000018,"recon":0.20000000000000018},
{"x":46,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":47,"actual":0.20000000000000018,"recon":0.20000000000000018},
{"x":48,"actual":0.0,"recon":-1.3877787807814457e-17},
{"x":49,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":50,"actual":0.10000000000000053,"recon":0.10000000000000052},
{"x":51,"actual":0.0,"recon":0.0},
{"x":52,"actual":0.09999999999999964,"recon":0.09999999999999963},
{"x":53,"actual":0.0,"recon":3.469446951953614e-18},
{"x":54,"actual":0.2999999999999998,"recon":0.2999999999999998},
{"x":55,"actual":0.0,"recon":0.0},
{"x":56,"actual":0.10000000000000053,"recon":0.10000000000000052},
{"x":57,"actual":0.0,"recon":0.0},
{"x":58,"actual":0.0,"recon":6.938893903907228e-18},
{"x":59,"actual":0.1999999999999993,"recon":0.19999999999999926},
{"x":60,"actual":0.20000000000000018,"recon":0.2000000000000002},
{"x":61,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":62,"actual":-0.10000000000000053,"recon":-0.10000000000000055},
{"x":63,"actual":0.0,"recon":3.469446951953614e-18},
{"x":64,"actual":-0.2999999999999998,"recon":-0.29999999999999993},
{"x":65,"actual":0.10000000000000053,"recon":0.10000000000000055},
{"x":66,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":67,"actual":-0.10000000000000053,"recon":-0.10000000000000052},
{"x":68,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":69,"actual":-0.09999999999999964,"recon":-0.09999999999999966},
{"x":70,"actual":0.09999999999999964,"recon":0.09999999999999962},
{"x":71,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":72,"actual":-0.09999999999999964,"recon":-0.0999999999999996},
{"x":73,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":74,"actual":-0.10000000000000053,"recon":-0.10000000000000056},
{"x":75,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":76,"actual":0.09999999999999964,"recon":0.09999999999999962},
{"x":77,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":78,"actual":-0.09999999999999964,"recon":-0.09999999999999967},
{"x":79,"actual":0.09999999999999964,"recon":0.09999999999999962},
{"x":80,"actual":0.0,"recon":0.0},
{"x":81,"actual":-0.09999999999999964,"recon":-0.09999999999999967},
{"x":82,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":83,"actual":-0.3000000000000007,"recon":-0.30000000000000066},
{"x":84,"actual":0.0,"recon":0.0},
{"x":85,"actual":0.0,"recon":0.0},
{"x":86,"actual":-0.09999999999999964,"recon":-0.09999999999999962},
{"x":87,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":88,"actual":-0.10000000000000053,"recon":-0.10000000000000055},
{"x":89,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":90,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":91,"actual":0.09999999999999964,"recon":0.09999999999999966},
{"x":92,"actual":-0.1999999999999993,"recon":-0.1999999999999993},
{"x":93,"actual":0.0,"recon":0.0},
{"x":94,"actual":0.39999999999999947,"recon":0.39999999999999947},
{"x":95,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":96,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":97,"actual":0.10000000000000053,"recon":0.10000000000000055},
{"x":98,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":99,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":100,"actual":-0.09999999999999964,"recon":-0.09999999999999962},
{"x":101,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":102,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":103,"actual":0.0,"recon":0.0},
{"x":104,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":105,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":106,"actual":0.09999999999999964,"recon":0.0999999999999996},
{"x":107,"actual":0.0,"recon":0.0},
{"x":108,"actual":-0.2999999999999998,"recon":-0.2999999999999998},
{"x":109,"actual":0.20000000000000018,"recon":0.20000000000000018},
{"x":110,"actual":-0.40000000000000036,"recon":-0.4000000000000004},
{"x":111,"actual":0.10000000000000053,"recon":0.1000000000000005},
{"x":112,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":113,"actual":0.20000000000000018,"recon":0.20000000000000023},
{"x":114,"actual":0.0,"recon":6.938893903907228e-18},
{"x":115,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":116,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":117,"actual":0.0,"recon":6.938893903907228e-18},
{"x":118,"actual":-0.10000000000000053,"recon":-0.10000000000000055},
{"x":119,"actual":-0.1999999999999993,"recon":-0.19999999999999923},
{"x":120,"actual":0.09999999999999964,"recon":0.09999999999999966},
{"x":121,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":122,"actual":-0.10000000000000053,"recon":-0.10000000000000052},
{"x":123,"actual":0.10000000000000053,"recon":0.10000000000000053},
{"x":124,"actual":-0.20000000000000018,"recon":-0.20000000000000015},
{"x":125,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":126,"actual":0.10000000000000053,"recon":0.10000000000000049},
{"x":127,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":128,"actual":0.0,"recon":6.938893903907228e-18},
{"x":129,"actual":0.10000000000000053,"recon":0.10000000000000052},
{"x":130,"actual":-0.40000000000000036,"recon":-0.4000000000000004},
{"x":131,"actual":0.10000000000000053,"recon":0.10000000000000053},
{"x":132,"actual":0.09999999999999964,"recon":0.09999999999999963},
{"x":133,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":134,"actual":0.0,"recon":0.0},
{"x":135,"actual":0.09999999999999964,"recon":0.09999999999999963},
{"x":136,"actual":-0.09999999999999964,"recon":-0.09999999999999966},
{"x":137,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":138,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":139,"actual":-0.10000000000000053,"recon":-0.10000000000000052},
{"x":140,"actual":0.10000000000000053,"recon":0.10000000000000055},
{"x":141,"actual":-0.20000000000000018,"recon":-0.20000000000000015},
{"x":142,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":143,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":144,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":145,"actual":0.0,"recon":0.0},
{"x":146,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":147,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":148,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":149,"actual":0.0,"recon":6.938893903907228e-18},
{"x":150,"actual":-0.09999999999999964,"recon":-0.09999999999999962},
{"x":151,"actual":0.0,"recon":6.938893903907228e-18},
{"x":152,"actual":0.09999999999999964,"recon":0.09999999999999967},
{"x":153,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":154,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":155,"actual":0.20000000000000018,"recon":0.20000000000000018},
{"x":156,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":157,"actual":0.0,"recon":0.0},
{"x":158,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":159,"actual":-0.19999999999999973,"recon":-0.19999999999999973},
{"x":160,"actual":0.0,"recon":6.938893903907228e-18},
{"x":161,"actual":0.0,"recon":6.938893903907228e-18},
{"x":162,"actual":0.0,"recon":6.938893903907228e-18},
{"x":163,"actual":0.30000000000000027,"recon":0.30000000000000027},
{"x":164,"actual":0.0,"recon":-1.3877787807814457e-17},
{"x":165,"actual":0.09999999999999964,"recon":0.09999999999999966},
{"x":166,"actual":0.10000000000000053,"recon":0.10000000000000053},
{"x":167,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":168,"actual":0.20000000000000018,"recon":0.20000000000000018},
{"x":169,"actual":0.09999999999999964,"recon":0.09999999999999963},
{"x":170,"actual":0.3000000000000007,"recon":0.3000000000000007},
{"x":171,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":172,"actual":0.2999999999999998,"recon":0.2999999999999997},
{"x":173,"actual":0.20000000000000018,"recon":0.20000000000000012},
{"x":174,"actual":0.20000000000000018,"recon":0.20000000000000023},
{"x":175,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":176,"actual":0.0,"recon":0.0},
{"x":177,"actual":0.0,"recon":-2.0816681711721685e-17},
{"x":178,"actual":0.20000000000000018,"recon":0.20000000000000012},
{"x":179,"actual":-0.10000000000000053,"recon":-0.10000000000000056},
{"x":180,"actual":0.0,"recon":-2.0816681711721685e-17},
{"x":181,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":182,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":183,"actual":0.0,"recon":0.0},
{"x":184,"actual":0.0,"recon":0.0},
{"x":185,"actual":0.20000000000000018,"recon":0.20000000000000023},
{"x":186,"actual":0.09999999999999964,"recon":0.09999999999999966},
{"x":187,"actual":-0.20000000000000018,"recon":-0.20000000000000012},
{"x":188,"actual":0.10000000000000053,"recon":0.10000000000000053},
{"x":189,"actual":0.0,"recon":0.0},
{"x":190,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":191,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":192,"actual":0.20000000000000018,"recon":0.20000000000000012},
{"x":193,"actual":-0.09999999999999964,"recon":-0.0999999999999997},
{"x":194,"actual":-0.10000000000000053,"recon":-0.10000000000000056},
{"x":195,"actual":0.0,"recon":6.938893903907228e-18},
{"x":196,"actual":-0.09999999999999964,"recon":-0.09999999999999967},
{"x":197,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":198,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":199,"actual":0.0,"recon":6.938893903907228e-18},
{"x":200,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":201,"actual":0.20000000000000018,"recon":0.2000000000000002},
{"x":202,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":203,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":204,"actual":0.0,"recon":6.938893903907228e-18},
{"x":205,"actual":-0.09999999999999964,"recon":-0.09999999999999962},
{"x":206,"actual":-0.09999999999999964,"recon":-0.09999999999999962},
{"x":207,"actual":0.0,"recon":0.0},
{"x":208,"actual":0.09999999999999964,"recon":0.09999999999999966},
{"x":209,"actual":-0.09999999999999964,"recon":-0.09999999999999963},
{"x":210,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":211,"actual":-0.10000000000000053,"recon":-0.10000000000000053},
{"x":212,"actual":0.10000000000000053,"recon":0.10000000000000053},
{"x":213,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":214,"actual":0.0,"recon":0.0},
{"x":215,"actual":-0.10000000000000053,"recon":-0.10000000000000056},
{"x":216,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":217,"actual":0.0,"recon":0.0},
{"x":218,"actual":-0.09999999999999964,"recon":-0.09999999999999967},
{"x":219,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":220,"actual":0.0,"recon":0.0},
{"x":221,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":222,"actual":-0.09999999999999964,"recon":-0.09999999999999962},
{"x":223,"actual":-0.20000000000000018,"recon":-0.20000000000000018},
{"x":224,"actual":0.09999999999999964,"recon":0.09999999999999966},
{"x":225,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":226,"actual":0.0,"recon":1.3877787807814457e-17},
{"x":227,"actual":-0.10000000000000053,"recon":-0.10000000000000056},
{"x":228,"actual":0.0,"recon":6.938893903907228e-18},
{"x":229,"actual":0.10000000000000053,"recon":0.10000000000000056},
{"x":230,"actual":0.0,"recon":0.0},
{"x":231,"actual":-0.20000000000000018,"recon":-0.20000000000000012},
{"x":232,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":233,"actual":0.09999999999999964,"recon":0.09999999999999967},
{"x":234,"actual":-0.09999999999999964,"recon":-0.09999999999999967},
{"x":235,"actual":0.1999999999999993,"recon":0.19999999999999934},
{"x":236,"actual":-0.09999999999999964,"recon":-0.09999999999999966},
{"x":237,"actual":-0.09999999999999964,"recon":-0.09999999999999964},
{"x":238,"actual":0.09999999999999964,"recon":0.09999999999999964},
{"x":239,"actual":-0.09999999999999964,"recon":-0.09999999999999966},
{"x":240,"actual":0.1999999999999993,"recon":0.19999999999999926},
{"x":241,"actual":0.10000000000000053,"recon":0.10000000000000053},
{"x":242,"actual":-0.10000000000000053,"recon":-0.10000000000000056},
{"x":243,"actual":0.10000000000000053,"recon":0.10000000000000052},
{"x":244,"actual":0.0,"recon":-1.3877787807814457e-17},
{"x":245,"actual":0.0,"recon":-6.938893903907228e-18},
{"x":246,"actual":0.2999999999999998,"recon":0.2999999999999999}];
    const series = [{"name":"Actual","color":"#1f77b4","key":"actual","dash":""},{"name":"Reconstructed","color":"#ff7f0e","key":"recon","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#bhd_line_58');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"s1":-0.0001262522660063789,"s2":5.193197130014605e-5,"s3":-0.0033927688464792994},
{"x":2,"s1":3.481857653853445e-5,"s2":4.289728645362763e-5,"s3":0.004054410613971393},
{"x":3,"s1":-0.0005679076859192873,"s2":-4.444719003388136e-5,"s3":-0.002442474178877529},
{"x":4,"s1":-0.0019795843031363263,"s2":-0.000862477755982282,"s3":0.0004183618069179381},
{"x":5,"s1":0.00043289358721282194,"s2":-0.0002060619946049903,"s3":-0.00012582567628661437},
{"x":6,"s1":-0.0010696930665784453,"s2":-0.0025585362605740785,"s3":0.00150345096480719},
{"x":7,"s1":-0.002375930164781599,"s2":0.0022786153769502743,"s3":-0.0004179392468023611},
{"x":8,"s1":-0.0013278662765806128,"s2":-0.0011192862745054116,"s3":0.0012132228965115385},
{"x":9,"s1":0.0019397291187145938,"s2":-0.003376942565540783,"s3":0.0014348527587272264},
{"x":10,"s1":-0.002398038690376593,"s2":0.0018723192756881762,"s3":0.0026310858103708963},
{"x":11,"s1":-0.0005502321733443638,"s2":-0.0026377140492132726,"s3":-0.0004934779945021504},
{"x":12,"s1":-0.0024611749343187257,"s2":0.0032268747457833724,"s3":0.0004692969733089242},
{"x":13,"s1":0.002601795660851382,"s2":-0.006619220842389711,"s3":0.0036080283236665026},
{"x":14,"s1":-0.0018222979408399928,"s2":0.0020489603134076456,"s3":-0.0016057257854424905},
{"x":15,"s1":-0.0011686969059319953,"s2":0.0006457043583341956,"s3":-6.913749278922914e-5},
{"x":16,"s1":-0.00023465856795432818,"s2":-0.004862736188937374,"s3":0.0033377031989787415},
{"x":17,"s1":-0.0016263932234154947,"s2":0.006185635966666799,"s3":-0.005625117667527757},
{"x":18,"s1":-0.0045398052262737645,"s2":-0.003514400584577175,"s3":0.006647609501800006},
{"x":19,"s1":0.0023535313947107123,"s2":0.0005019982646589002,"s3":-0.0021350165358595442},
{"x":20,"s1":-0.0028993917922875206,"s2":-0.0014410098408151237,"s3":0.0026807127984709344},
{"x":21,"s1":-0.0011826675965715956,"s2":-0.0008463971749662985,"s3":0.0031987740938875923},
{"x":22,"s1":-0.0032918300357523767,"s2":0.0035376842077484657,"s3":0.00183419256376877},
{"x":23,"s1":-0.0002360435405467037,"s2":-0.00035260437970061466,"s3":-0.0011790558098926794},
{"x":24,"s1":0.0026323752079871155,"s2":-0.003070485196902019,"s3":-0.001725661087451163},
{"x":25,"s1":-0.001152807830237296,"s2":0.00029476421829354013,"s3":0.0027218144955603292},
{"x":26,"s1":-0.0029944805130173568,"s2":0.0024641253118049184,"s3":-0.002690222556382196},
{"x":27,"s1":0.00041424381165637905,"s2":0.002051347519552893,"s3":0.001163749388852641},
{"x":28,"s1":-0.00021220299952942829,"s2":-0.0020167284957546467,"s3":0.0060823404830313},
{"x":29,"s1":0.0018434106407716362,"s2":-0.0010717399354985267,"s3":-0.0003200754974405835},
{"x":30,"s1":-0.00608830866270061,"s2":0.0017989148194431745,"s3":0.003744115047644387},
{"x":31,"s1":0.0036710084618498543,"s2":-0.0014881089165245844,"s3":0.006116681021006688},
{"x":32,"s1":-0.005256529519510968,"s2":0.0041173346501195765,"s3":-0.004041908921898487},
{"x":33,"s1":-0.0011388089909224284,"s2":-0.0025422554499712332,"s3":0.005756216362791411},
{"x":34,"s1":-0.0009216676345403518,"s2":0.004217686515555376,"s3":-0.005253021276453994},
{"x":35,"s1":0.00041303548486746385,"s2":-0.0026853491508291878,"s3":0.0027007496709690374},
{"x":36,"s1":0.00017329531738090965,"s2":-0.00192794837151119,"s3":0.00690466076542051},
{"x":37,"s1":-0.0007277506042038294,"s2":0.004468562901012406,"s3":-0.003969939523789922},
{"x":38,"s1":-0.00514303013501544,"s2":0.003663778933000617,"s3":0.005701719425946823},
{"x":39,"s1":0.007074211803132366,"s2":-0.0032029968041073255,"s3":-0.0039055820373137666},
{"x":40,"s1":-0.002156887493360096,"s2":-0.0002273325089050768,"s3":0.003465061054057582},
{"x":41,"s1":-0.0044907717032587734,"s2":0.004635913041000467,"s3":-0.0030358714164573208},
{"x":42,"s1":-0.0003401180611449247,"s2":0.00275441330973022,"s3":0.0005659146167051644},
{"x":43,"s1":0.004468744553793989,"s2":-0.004690876972629195,"s3":0.002489550707859775},
{"x":44,"s1":-0.0011265280861143022,"s2":0.004543740558928986,"s3":-0.00481221425723649},
{"x":45,"s1":-0.00020798637079985993,"s2":0.0006033111253314154,"s3":0.0016814580814917303},
{"x":46,"s1":0.002348752343667522,"s2":-0.002671516151010364,"s3":0.004358806154945006},
{"x":47,"s1":0.002626645467321991,"s2":0.004654167359960803,"s3":-0.003131289245962114},
{"x":48,"s1":-0.0014511504212773607,"s2":-0.0013056261840068283,"s3":0.004682823661190176},
{"x":49,"s1":0.0026973869802951276,"s2":0.004254780856278231,"s3":-0.005982862417159387},
{"x":50,"s1":0.00036579380571154696,"s2":-0.003393876478057504,"s3":0.006588295606690199},
{"x":51,"s1":0.00288064606600005,"s2":0.0019354753068561137,"s3":-0.0018296438639052997},
{"x":52,"s1":0.0008783764341757195,"s2":-0.002642785960262395,"s3":0.0021368303073750474},
{"x":53,"s1":0.002526728311959559,"s2":0.0001778434357996959,"s3":0.002488607460036094},
{"x":54,"s1":0.0031441518678262657,"s2":-0.0011371776404403193,"s3":-0.0015619122121858554},
{"x":55,"s1":0.002779437853725364,"s2":-0.0015689552266430016,"s3":-0.0010127820171334464},
{"x":56,"s1":0.005164017516405315,"s2":-0.006836087030278463,"s3":0.004807480690171061},
{"x":57,"s1":0.003041680803516327,"s2":0.0040863323491642485,"s3":-0.0032683324102651457},
{"x":58,"s1":0.0014993518136193534,"s2":-0.005574536834230093,"s3":0.004180497001642139},
{"x":59,"s1":0.0069273885544414455,"s2":-0.003779634025470853,"s3":-0.0007324212924416503},
{"x":60,"s1":0.0013060777547396886,"s2":-0.0015077064290622622,"s3":0.003143790437960998},
{"x":61,"s1":0.004881050845062453,"s2":-0.0050562032460759266,"s3":0.002639207343981595},
{"x":62,"s1":0.0026515455349741934,"s2":0.0031124225744340937,"s3":-0.004409611704850776},
{"x":63,"s1":0.002661651474653372,"s2":-0.0015973185731457868,"s3":0.0018533061817364617},
{"x":64,"s1":0.002380207815458183,"s2":0.0037497469467553763,"s3":-0.0015847428411455082},
{"x":65,"s1":0.007871804220519385,"s2":-0.008575933605672235,"s3":0.0024436069486540486},
{"x":66,"s1":0.003053545210259228,"s2":0.0009025204478462091,"s3":-0.0034922106279864557},
{"x":67,"s1":0.005433093223630747,"s2":-0.0018295494693134694,"s3":0.00167496010515081},
{"x":68,"s1":0.004787959078879722,"s2":-0.0035741020016565616,"s3":8.621735653347824e-5},
{"x":69,"s1":0.0033342869830537422,"s2":0.0025285157512782803,"s3":-0.003918603315743534},
{"x":70,"s1":0.0026023764212404826,"s2":-0.002458044920140292,"s3":0.004002778975324037},
{"x":71,"s1":0.010490510735086955,"s2":-0.0058990756562172985,"s3":-0.0023737632000979995},
{"x":72,"s1":8.39369944808193e-5,"s2":-0.004398166156938891,"s3":0.00423371511825617},
{"x":73,"s1":0.003438730388479155,"s2":-0.0036176364537973175,"s3":0.003398239179624833},
{"x":74,"s1":0.00189245787856387,"s2":0.0005167039938722879,"s3":0.00019562384386080794},
{"x":75,"s1":0.002958266966950393,"s2":-0.0029281122091892537,"s3":0.0018343381373950164},
{"x":76,"s1":0.003129792296262507,"s2":-0.007541777917380419,"s3":0.008983416675510352},
{"x":77,"s1":0.0022220188040934117,"s2":-0.0009493007991336353,"s3":0.00031861274726806136},
{"x":78,"s1":0.0010916469274412344,"s2":-0.004147155574390281,"s3":0.004320599571032806},
{"x":79,"s1":0.003300167792777435,"s2":0.0004641513875421516,"s3":-0.003074219121674721},
{"x":80,"s1":-0.00028653439423249004,"s2":-0.00037066567740906916,"s3":0.006078139049309436},
{"x":81,"s1":0.0029321700709425465,"s2":-0.0019480057584431742,"s3":0.0021217689479679446},
{"x":82,"s1":0.0012386040181324338,"s2":0.0011944501925889456,"s3":-0.0018374855369847026},
{"x":83,"s1":0.001421451814541945,"s2":0.0011545264990588677,"s3":0.0021996953975977904},
{"x":84,"s1":-0.0021377042763730484,"s2":0.000767929502376232,"s3":0.004935892092295328},
{"x":85,"s1":0.0010853680427254354,"s2":0.0004984457782164983,"s3":0.002669586584695633},
{"x":86,"s1":0.0008662190983068213,"s2":-0.00028843437153228243,"s3":0.0027263698347790195},
{"x":87,"s1":0.002643101144395906,"s2":0.0005045430903339503,"s3":-0.001520482389437655},
{"x":88,"s1":-0.0026460609285487687,"s2":0.002939448097013746,"s3":0.001292810593005378},
{"x":89,"s1":-0.0013156248792465857,"s2":0.0023738747564254403,"s3":0.004107852128194289},
{"x":90,"s1":-0.0016440986366164589,"s2":0.0014657789931520975,"s3":0.0023019013204451395},
{"x":91,"s1":0.004653296030863284,"s2":-0.00102006519481885,"s3":0.00041015244604678864},
{"x":92,"s1":-0.003918813863001344,"s2":0.0014988341792045326,"s3":0.005101226324337955},
{"x":93,"s1":0.001554712571398348,"s2":-0.0037512830109726935,"s3":0.0047131446708302775},
{"x":94,"s1":-0.0017770928336123194,"s2":0.004543569811956515,"s3":0.0018991163127959065},
{"x":95,"s1":0.0009717837942554743,"s2":-0.0005382335948999555,"s3":0.00098517303410306},
{"x":96,"s1":0.0008989792565040049,"s2":-0.004029390078568387,"s3":0.005912616736884005},
{"x":97,"s1":-0.003828858433172804,"s2":0.004234973158705138,"s3":0.002546372722559832},
{"x":98,"s1":-0.004848691346396429,"s2":9.026268795998471e-5,"s3":0.008143449801379111},
{"x":99,"s1":0.004595760699859934,"s2":-0.003176702108734296,"s3":0.0015834625274592441},
{"x":100,"s1":-0.004217037114099801,"s2":0.0020471715585559367,"s3":0.006944204692740265},
{"x":101,"s1":-0.005231553238292087,"s2":0.0016804881395550363,"s3":0.0058732432295394},
{"x":102,"s1":-0.000768594032446675,"s2":0.000343887157742306,"s3":0.0035284798845452063},
{"x":103,"s1":0.0008930067781149256,"s2":0.00045137335523248365,"s3":0.006623913075516345},
{"x":104,"s1":-0.005780034597894229,"s2":0.007567312631714056,"s3":-0.0015750450103312306},
{"x":105,"s1":0.0004060379955458632,"s2":-0.0010851037781774494,"s3":0.005874601383346798},
{"x":106,"s1":-0.003476568373766465,"s2":0.006529723799955157,"s3":0.0007728422031146479},
{"x":107,"s1":0.0023021619635968933,"s2":0.0005725272331203338,"s3":-0.0007352038211810493},
{"x":108,"s1":-0.00018639887766274782,"s2":-0.002915735587453494,"s3":0.006447761553037987},
{"x":109,"s1":-0.0004267693771843453,"s2":0.004862230159752869,"s3":-0.0005377959456139331},
{"x":110,"s1":-0.003495975296520751,"s2":0.0007620761249664751,"s3":0.005329167337404145},
{"x":111,"s1":0.009271251566991216,"s2":-0.0070306707467882425,"s3":0.0034367104152642595},
{"x":112,"s1":-0.002435826902301935,"s2":0.0029789958761968875,"s3":0.0028349520247162455},
{"x":113,"s1":0.004576832309233716,"s2":-0.006458932404901406,"s3":0.0058302760477364855},
{"x":114,"s1":0.005228678627485382,"s2":-0.004856911093934441,"s3":0.0021873533721037926},
{"x":115,"s1":0.0007615392432437312,"s2":-8.992872856247945e-5,"s3":0.002585542754658055},
{"x":116,"s1":-0.0030706243532509243,"s2":-0.0006723850058844476,"s3":0.007245061471290624},
{"x":117,"s1":0.0015791246214084409,"s2":0.0028948496964554668,"s3":-0.001519028159986758},
{"x":118,"s1":0.0001456153128788381,"s2":-0.009067270365176634,"s3":0.012202671207710422},
{"x":119,"s1":0.0030872703405934124,"s2":0.0026856010860401448,"s3":-0.002196351690247261},
{"x":120,"s1":-0.0036368825533142834,"s2":-0.005741554273122035,"s3":0.015069234705053915},
{"x":121,"s1":0.0007566633958368933,"s2":0.008011535095973429,"s3":-0.005316460436464324},
{"x":122,"s1":0.0031318742684164173,"s2":-0.007019423279541868,"s3":0.008684871051652086},
{"x":123,"s1":0.001706171559983929,"s2":0.0023903691468928185,"s3":0.0002455031158423473},
{"x":124,"s1":-0.004019910645752843,"s2":0.0072021844681701514,"s3":-0.00022169389433046287},
{"x":125,"s1":0.0023802771183835973,"s2":-0.006155343107986805,"s3":0.007167139414267265},
{"x":126,"s1":0.0016002262157290923,"s2":0.0029673479138759284,"s3":-0.0016582906714513116},
{"x":127,"s1":0.00041309220156379516,"s2":0.0014925516794529509,"s3":0.0028352022262463994},
{"x":128,"s1":0.0016864484981018182,"s2":-0.00814669892841504,"s3":0.008509952965999119},
{"x":129,"s1":0.002161692730715891,"s2":0.005635180791953362,"s3":-0.003769825654684289},
{"x":130,"s1":-0.001967984480358886,"s2":-0.00456231135839909,"s3":0.011073841436549627},
{"x":131,"s1":0.007669084917818714,"s2":-0.0049743020529329565,"s3":0.002409562701340305},
{"x":132,"s1":-0.0044653962504258805,"s2":0.0032015913142270287,"s3":0.003581598394723551},
{"x":133,"s1":0.005553863316299382,"s2":-0.008495741444851228,"s3":0.008142542304708062},
{"x":134,"s1":0.0041576604949759245,"s2":-0.0020444000140275474,"s3":-1.977176095414538e-5},
{"x":135,"s1":-9.026688861205222e-5,"s2":-0.00027765478387627293,"s3":0.003921867269999082},
{"x":136,"s1":-0.0038484452290137895,"s2":0.0021610259784281276,"s3":0.0072889739691091},
{"x":137,"s1":0.004165843139345475,"s2":-0.0016726912338774574,"s3":0.0005218942501258345},
{"x":138,"s1":-0.004657962250439072,"s2":-0.0004649901297069322,"s3":0.00919970250741139},
{"x":139,"s1":0.0021041520045933662,"s2":0.004433173599201864,"s3":-0.002043386179766621},
{"x":140,"s1":-0.0017211806547074663,"s2":-0.006514044318554941,"s3":0.010393090609689203},
{"x":141,"s1":0.0035209300437699558,"s2":0.0049241112646832026,"s3":-0.003587407863085175},
{"x":142,"s1":-0.005805470867597962,"s2":0.00010633399652967349,"s3":0.015442629743803666},
{"x":143,"s1":0.00405543922052006,"s2":0.0013280564400594385,"s3":-0.006984188928959532},
{"x":144,"s1":-0.003057323299079514,"s2":0.0029113791025599882,"s3":0.0033965507876774466},
{"x":145,"s1":0.0009256620664357451,"s2":-0.003542907884430431,"s3":0.01107930331620698},
{"x":146,"s1":0.0008830336478420854,"s2":0.003710486694248233,"s3":-0.002754224464394043},
{"x":147,"s1":-0.0016667422480387208,"s2":0.0006633707178677944,"s3":0.007013062549032843},
{"x":148,"s1":-0.0014862811962784328,"s2":0.0006703184110110904,"s3":0.0020702340600703586},
{"x":149,"s1":0.004330921601039884,"s2":-0.0035241165942629105,"s3":0.0036029122867366273},
{"x":150,"s1":-0.006593643624424758,"s2":0.0009158077605609461,"s3":0.009749866972656661},
{"x":151,"s1":0.00721991204766761,"s2":-0.0026884346272189738,"s3":0.0001821267224440837},
{"x":152,"s1":-0.00556374960982019,"s2":0.0006643731696419913,"s3":0.010036114038956087},
{"x":153,"s1":0.00401865396954971,"s2":-0.0021474995116481355,"s3":0.004206510252555152},
{"x":154,"s1":-0.001034473603138875,"s2":0.0007507586056510362,"s3":-0.0025146168776792772},
{"x":155,"s1":0.003205237771071244,"s2":-0.0007650553973788289,"s3":0.004373483788868931},
{"x":156,"s1":-0.004887982307268073,"s2":0.003635165976379148,"s3":0.009338337096933786},
{"x":157,"s1":0.006239993616360158,"s2":-0.008259597676795885,"s3":0.0036179421898318033},
{"x":158,"s1":-0.004844366696919395,"s2":0.004465675273905262,"s3":0.0013607610572328548},
{"x":159,"s1":0.0006427042739880931,"s2":0.006342538401586826,"s3":0.0028580570388986367},
{"x":160,"s1":-0.0006960676686157262,"s2":-0.004261231660869303,"s3":0.005494999520738899},
{"x":161,"s1":-0.00016115699397281714,"s2":0.005457473006818997,"s3":-0.0007523985487522172},
{"x":162,"s1":-0.003533184354457309,"s2":-0.0006570154723220375,"s3":0.008747496284262952},
{"x":163,"s1":0.006164760505938705,"s2":-0.0027847128098659963,"s3":0.0045462692795804},
{"x":164,"s1":-0.005181191808122954,"s2":0.004999673993021474,"s3":0.0007044440673401878},
{"x":165,"s1":0.0006049366176759486,"s2":-0.0002703736310367071,"s3":0.002446356649651294},
{"x":166,"s1":-0.00046812200631270856,"s2":0.00503901803702954,"s3":0.000443925230038832},
{"x":167,"s1":0.0008979357041865013,"s2":0.0015573212178510887,"s3":0.005356601969692121},
{"x":168,"s1":9.677910205362596e-5,"s2":-0.002693948205791991,"s3":0.003682749246242863},
{"x":169,"s1":0.0027561040920720784,"s2":6.61920458548907e-5,"s3":-0.0021796547557001293},
{"x":170,"s1":-0.002161937602754345,"s2":-0.003771046116328934,"s3":0.01136591991604379},
{"x":171,"s1":0.005590938573779304,"s2":0.0028473592323020177,"s3":2.548161154783174e-5},
{"x":172,"s1":-0.0014387746151138384,"s2":-0.002140933139852492,"s3":0.0010574638916363282},
{"x":173,"s1":0.00029352407355289617,"s2":0.004517549339190225,"s3":0.001917379507873387},
{"x":174,"s1":-0.000909208339749849,"s2":-0.0019007756353206986,"s3":0.006737981461324554},
{"x":175,"s1":0.0037759173877611025,"s2":0.0012314829328415574,"s3":0.002059439444704644},
{"x":176,"s1":-0.005385653408571422,"s2":0.00538586819163264,"s3":0.004204749053892037},
{"x":177,"s1":0.0014019384477284773,"s2":-0.003920985149119691,"s3":0.008250738175985532},
{"x":178,"s1":-0.0023550979494387234,"s2":0.007035453127990789,"s3":0.0010841745754768747},
{"x":179,"s1":0.002843029438002941,"s2":-0.0012870619643766722,"s3":-0.00015286619207091162},
{"x":180,"s1":0.0031066663999587854,"s2":-0.0009100191439873033,"s3":0.0013704992925723763},
{"x":181,"s1":0.001229689079028064,"s2":0.00407890120566779,"s3":0.0010655933191424777},
{"x":182,"s1":-0.001189487375528624,"s2":0.00169566595125198,"s3":0.004039080878875315},
{"x":183,"s1":0.011309529392652803,"s2":-0.002603801283658965,"s3":-0.005305496928861982},
{"x":184,"s1":0.0017833729358445593,"s2":0.0009265304026275974,"s3":0.0019679474164722354},
{"x":185,"s1":0.008041981496291381,"s2":-0.0055948494559114725,"s3":0.0015944171057850239},
{"x":186,"s1":0.005230651004034308,"s2":-0.0010876796282081407,"s3":-0.00029265214212139236},
{"x":187,"s1":0.00786088659406616,"s2":-0.008246576328839277,"s3":0.007579369998192859},
{"x":188,"s1":0.002121984751283754,"s2":0.0035380237519900435,"s3":-0.0004877331039119349},
{"x":189,"s1":0.006032782415794635,"s2":-0.005723891530024358,"s3":0.0005126309322265863},
{"x":190,"s1":0.00417899046801193,"s2":-0.00699694324201743,"s3":0.0011874424864647517},
{"x":191,"s1":0.005968564150324917,"s2":-0.0025734560824653857,"s3":0.003390410971240322},
{"x":192,"s1":0.003906253885506898,"s2":-0.004857300444944591,"s3":0.007933843692408047},
{"x":193,"s1":0.0017625352361346173,"s2":0.0031165575255171457,"s3":0.001904429542471996},
{"x":194,"s1":0.0008283070915769359,"s2":-0.0035691346908715373,"s3":0.00789134222443085},
{"x":195,"s1":0.0031299315970325483,"s2":0.0017301737480224593,"s3":-0.0011627826604206767},
{"x":196,"s1":-0.002698132092534095,"s2":0.006410740657252838,"s3":-0.0038514492713772226},
{"x":197,"s1":0.0073068104327801055,"s2":-0.009672244134477672,"s3":0.008703870913099689},
{"x":198,"s1":0.002623371463735113,"s2":0.005058562260160633,"s3":-0.0012932946906441297},
{"x":199,"s1":-5.335303771684657e-5,"s2":-0.0010356068177966716,"s3":0.007399436405046494},
{"x":200,"s1":0.007482492889706344,"s2":-0.001184009109594522,"s3":-0.004333860922521553},
{"x":201,"s1":0.004521939653408246,"s2":0.0009610914994740396,"s3":-0.0006729013469590349},
{"x":202,"s1":0.002729081366600823,"s2":-0.0024245987209248502,"s3":0.003222286599813841},
{"x":203,"s1":0.008622197176814977,"s2":-0.002598388296194743,"s3":0.0012268799931517398},
{"x":204,"s1":5.252205220484347e-5,"s2":0.0005295396043831847,"s3":0.003101787411631466},
{"x":205,"s1":0.006783271961375683,"s2":-0.0023311500125988522,"s3":-0.002459110155936841},
{"x":206,"s1":0.005008174684184635,"s2":-0.006736089935789999,"s3":0.005200732854686373},
{"x":207,"s1":0.002981682854389135,"s2":-0.003853627550529648,"s3":0.008202553008610102},
{"x":208,"s1":0.002084143356995865,"s2":-2.3512894360267087e-5,"s3":0.004272263658488354},
{"x":209,"s1":0.005555627789665245,"s2":-0.004596376360790501,"s3":0.0031757917660546627},
{"x":210,"s1":0.003001169880418179,"s2":-0.0028301175857250015,"s3":-0.0008251235328389118},
{"x":211,"s1":-0.002106729408390851,"s2":0.006764002132646177,"s3":-0.0003251294206500344},
{"x":212,"s1":0.0037197116798359984,"s2":-0.007514280095897387,"s3":0.012815376546444093},
{"x":213,"s1":0.00037922132285727933,"s2":0.006474282857686158,"s3":-0.002667544767269067},
{"x":214,"s1":-0.003629780255110602,"s2":-0.0017128324907261408,"s3":0.00904242660610879},
{"x":215,"s1":0.0027417270499759897,"s2":0.0036224045936277026,"s3":-0.005106830397315626},
{"x":216,"s1":-0.004155417535854246,"s2":0.00487139870794851,"s3":0.004633674329644488},
{"x":217,"s1":0.0017404758607753406,"s2":-0.0032572497330435163,"s3":0.011991771418675218},
{"x":218,"s1":-0.000476904314921199,"s2":0.0077096945703243516,"s3":-0.003038451149645463},
{"x":219,"s1":-0.0004020248498790003,"s2":-0.0017390261315327396,"s3":0.01440235341379556},
{"x":220,"s1":0.0030752055616910215,"s2":0.0017518154914938622,"s3":-0.012698823455955795},
{"x":221,"s1":0.0017941918623399801,"s2":0.0011400493167575455,"s3":-0.004595412667520524},
{"x":222,"s1":-0.004068418524252634,"s2":0.0030446360025417857,"s3":0.01008407159366941},
{"x":223,"s1":0.005745666635744181,"s2":0.00026896366344404644,"s3":0.004696516716340024},
{"x":224,"s1":-0.005009839717385025,"s2":-0.0007143048373943605,"s3":0.0045857402441807655},
{"x":225,"s1":0.006441507487481614,"s2":-0.0013606670484135517,"s3":0.0006494905225972427},
{"x":226,"s1":-0.0005844736662239852,"s2":-0.0036309241825116683,"s3":0.011784026988380982},
{"x":227,"s1":0.0015982495677220247,"s2":-0.00026972263867572766,"s3":0.0014660477688300682},
{"x":228,"s1":6.592568575215354e-5,"s2":0.0018512464405014205,"s3":0.0019325467350917694},
{"x":229,"s1":0.0032390693161137483,"s2":-0.0058867227034305365,"s3":0.010411951172828735},
{"x":230,"s1":-0.0005479982581537873,"s2":0.0021233992877342954,"s3":0.0016553291269134345},
{"x":231,"s1":6.310133903972882e-5,"s2":-0.000825925920001598,"s3":-0.003698942032415257},
{"x":232,"s1":0.0007858369371936286,"s2":0.0006417849408305133,"s3":0.003399649275162203},
{"x":233,"s1":0.0009864511440980366,"s2":0.0016514601125961238,"s3":0.007216098030806273},
{"x":234,"s1":-0.003212699632578849,"s2":0.0017218789707372003,"s3":0.010771479988995953},
{"x":235,"s1":0.005709845283111378,"s2":-0.00236585252120712,"s3":-0.0022949003451764862},
{"x":236,"s1":-0.00592168340701727,"s2":0.006850382446121128,"s3":0.0056378833774115705},
{"x":237,"s1":0.0008463710577639282,"s2":-0.00021281998596107705,"s3":0.005600758834804314},
{"x":238,"s1":-0.00202347880054589,"s2":0.004743679355855952,"s3":-0.0006399262569986495},
{"x":239,"s1":-0.0007473818725800184,"s2":0.0038245856309749734,"s3":0.0027779404242053766},
{"x":240,"s1":0.0020936969126487052,"s2":-0.0020018796245422623,"s3":0.0024337418596413647},
{"x":241,"s1":0.004168110919183339,"s2":0.0026449597781860166,"s3":-0.0024752784504044104},
{"x":242,"s1":-0.0033211192629896066,"s2":-0.0014354996397112384,"s3":0.00738424026483009},
{"x":243,"s1":0.004649513463021242,"s2":-1.9892876845086216e-5,"s3":0.004066610192600262},
{"x":244,"s1":-0.0008175036570939065,"s2":0.002988497928413553,"s3":0.0010710264966498615},
{"x":245,"s1":0.0039020350484295224,"s2":-0.001857134976231168,"s3":0.00742129503265693},
{"x":246,"s1":0.0032102350538817928,"s2":-0.006481302016808199,"s3":0.002532892729636129}];
    const series = [{"name":"INDPRO","color":"#1f77b4","key":"s1","dash":""},{"name":"UNRATE","color":"#ff7f0e","key":"s2","dash":""},{"name":"CPI","color":"#2ca02c","key":"s3","dash":""}];
    const mode = 'stacked';

    const container = d3.select('#bhd_bar_59');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    const keys = series.map(s => s.key);
    const x = d3.scaleBand().domain(data.map(d=>d.x)).range([0,w]).padding(0.15);

    let yMin = 0, yMax = 0;
    if(mode === 'stacked') {
        const stack = d3.stack().keys(keys).order(d3.stackOrderNone).offset(d3.stackOffsetDiverging);
        const stacked = stack(data);
        stacked.forEach(layer => layer.forEach(d => {
            yMin = Math.min(yMin, d[0], d[1]);
            yMax = Math.max(yMax, d[0], d[1]);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.layer').data(stacked).join('g').attr('class','layer')
            .attr('fill', (d,i) => series[i].color)
            .selectAll('rect').data(d => d).join('rect')
            .attr('x', d => x(d.data.x))
            .attr('y', d => y(Math.max(d[0], d[1])))
            .attr('height', d => Math.abs(y(d[0]) - y(d[1])))
            .attr('width', x.bandwidth());

        // Zero line
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    } else {
        // Grouped
        data.forEach(d => keys.forEach(k => {
            yMin = Math.min(yMin, d[k]||0);
            yMax = Math.max(yMax, d[k]||0);
        }));
        const yPad = (yMax - yMin) * 0.08 || 1;
        const y = d3.scaleLinear().domain([yMin - yPad, yMax + yPad]).range([h, 0]);
        const x1 = d3.scaleBand().domain(keys).range([0, x.bandwidth()]).padding(0.05);

        g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));
        g.selectAll('.group').data(data).join('g').attr('class','group')
            .attr('transform', d => 'translate('+x(d.x)+',0)')
            .selectAll('rect').data(d => keys.map(k => ({key:k, val:d[k]||0})))
            .join('rect')
            .attr('x', d => x1(d.key))
            .attr('y', d => y(Math.max(0, d.val)))
            .attr('height', d => Math.abs(y(0) - y(d.val)))
            .attr('width', x1.bandwidth())
            .attr('fill', d => series.find(s=>s.key===d.key).color);

        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(0)).attr('y2',y(0))
            .attr('stroke','#333').attr('stroke-width',0.8);

        g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
            .call(d3.axisBottom(x).tickValues(x.domain().filter((d,i) =>
                i % Math.max(1,Math.floor(data.length/8)) === 0)));
        g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));
    }

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Contribution') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Contribution');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*90)+',0)');
            gi.append('rect').attr('width',12).attr('height',12).attr('y',-6).attr('fill',s.color);
            gi.append('text').attr('x',16).attr('y',4).attr('font-size','10px').attr('fill','#555').text(s.name);
        });
    }

    // Tooltip
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const bands = x.domain();
            const idx = Math.min(Math.floor(mx / (w / bands.length)), bands.length-1);
            const d = data[Math.max(0,idx)];
            if(!d) return;
            let html = '<b>'+d.x+'</b>';
            series.forEach(s => { if(d[s.key]!==undefined) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"actual":-0.0017753334383439068,"recon":-0.0017753334383439066},
{"x":2,"actual":0.0017443643377621498,"recon":0.0017443643377621498},
{"x":3,"actual":-0.0008905957739751003,"recon":-0.0008905957739750998},
{"x":4,"actual":-0.0008813491066348433,"recon":-0.0008813491066348436},
{"x":5,"actual":0.0008601214828241055,"recon":0.0008601214828241058},
{"x":6,"actual":-0.0017406235464711983,"recon":-0.0017406235464711994},
{"x":7,"actual":0.0017226327038093459,"recon":0.0017226327038093467},
{"x":8,"actual":-0.001731581556640549,"recon":-0.0017315815566405495},
{"x":9,"actual":0.0008557752764977167,"recon":0.0008557752764977192},
{"x":10,"actual":0.0034121755492124706,"recon":0.0034121755492124706},
{"x":11,"actual":-0.003434147695855927,"recon":-0.003434147695855928},
{"x":12,"actual":0.0016898344401505838,"recon":0.0016898344401505847},
{"x":13,"actual":-1.795477193056172e-5,"recon":-1.7954771930562695e-5},
{"x":14,"actual":-1.7803573177488374e-5,"recon":-1.780357317748924e-5},
{"x":15,"actual":-1.7654276307510486e-5,"recon":-1.765427630751016e-5},
{"x":16,"actual":-0.0008511875981334072,"recon":-0.0008511875981334075},
{"x":17,"actual":-1.1129714737379004e-5,"recon":-1.1129714737378137e-5},
{"x":18,"actual":-1.1055824312933282e-5,"recon":-1.1055824312933716e-5},
{"x":19,"actual":0.0008144404088756829,"recon":0.0008144404088756828},
{"x":20,"actual":-0.000839049634874911,"recon":-0.0008390496348749116},
{"x":21,"actual":0.0016271813085753095,"recon":0.001627181308575309},
{"x":22,"actual":0.0024159092474844712,"recon":0.0024159092474844704},
{"x":23,"actual":-0.0024757402448782884,"recon":-0.0024757402448782884},
{"x":24,"actual":-0.001633833395915829,"recon":-0.0016338333959158295},
{"x":25,"actual":-1.0389117917952717e-5,"recon":-1.0389117917953584e-5},
{"x":26,"actual":-0.0032180236942007667,"recon":-0.0032180236942007667},
{"x":27,"actual":0.002406740030565402,"recon":0.002406740030565402},
{"x":28,"actual":0.0023894322329276463,"recon":0.0023894322329276463},
{"x":29,"actual":-0.0008168594120121497,"recon":-0.0008168594120121504},
{"x":30,"actual":-0.0008072245453369931,"recon":-0.0008072245453369924},
{"x":31,"actual":0.006284246935892135,"recon":0.006284246935892136},
{"x":32,"actual":-0.005542435920900424,"recon":-0.005542435920900424},
{"x":33,"actual":0.0007626485627660884,"recon":0.0007626485627660884},
{"x":34,"actual":-0.002346449742278267,"recon":-0.0023464497422782666},
{"x":35,"actual":-0.0007797102341688955,"recon":-0.0007797102341688955},
{"x":36,"actual":0.004627237916502658,"recon":0.004627237916502659},
{"x":37,"actual":-0.0015693227377626684,"recon":-0.0015693227377626682},
{"x":38,"actual":0.0037854890422739373,"recon":0.0037854890422739356},
{"x":39,"actual":-0.0015781655934086203,"recon":-0.0015781655934086194},
{"x":40,"actual":-4.613847981271846e-5,"recon":-4.6138479812717374e-5},
{"x":41,"actual":-0.004523137428873447,"recon":-0.004523137428873448},
{"x":42,"actual":0.001486389803310395,"recon":0.0014863898033103964},
{"x":43,"actual":-1.3881550946948096e-5,"recon":-1.388155094694983e-5},
{"x":44,"actual":-0.0029767438168493143,"recon":-0.0029767438168493156},
{"x":45,"actual":-0.0007421150618878158,"recon":-0.0007421150618878141},
{"x":46,"actual":0.0022230464879466894,"recon":0.0022230464879466902},
{"x":47,"actual":0.001471084052194982,"recon":0.0014710840521949833},
{"x":48,"actual":-0.0007486203103841405,"recon":-0.00074862031038414},
{"x":49,"actual":-0.001476002250398345,"recon":-0.0014760022503983432},
{"x":50,"actual":0.0014630454419188865,"recon":0.001463045441918887},
{"x":51,"actual":-8.574729842614204e-6,"recon":-8.574729842612903e-6},
{"x":52,"actual":-0.0014651892277761647,"recon":-0.0014651892277761649},
{"x":53,"actual":0.0029048538241145394,"recon":0.0029048538241145403},
{"x":54,"actual":-0.0014650905337623144,"recon":-0.0014650905337623141},
{"x":55,"actual":-0.0021752254168685425,"recon":-0.002175225416868543},
{"x":56,"actual":0.001443520747947069,"recon":0.0014435207479470708},
{"x":57,"actual":0.001434164088504275,"recon":0.0014341640885042724},
{"x":58,"actual":-0.0014466127765677683,"recon":-0.0014466127765677696},
{"x":59,"actual":-4.63146053419905e-6,"recon":-4.631460534196882e-6},
{"x":60,"actual":0.0007094191435532693,"recon":0.0007094191435532697},
{"x":61,"actual":-8.151649206311617e-6,"recon":-8.151649206311184e-6},
{"x":62,"actual":-0.0007180804806976582,"recon":-0.000718080480697656},
{"x":63,"actual":-4.539815315673934e-6,"recon":-4.539815315673934e-6},
{"x":64,"actual":0.002114872703040227,"recon":0.0021148727030402266},
{"x":65,"actual":-0.0014243994314462327,"recon":-0.0014243994314462301},
{"x":66,"actual":-0.0014124184136683482,"recon":-0.0014124184136683488},
{"x":67,"actual":0.0021010748169265625,"recon":0.0021010748169265634},
{"x":68,"actual":-0.0014089081527579594,"recon":-0.0014089081527579592},
{"x":69,"actual":-0.0007019883851988595,"recon":-0.00070198838519886},
{"x":70,"actual":0.0020864621810989803,"recon":0.0020864621810989786},
{"x":71,"actual":-0.0007053308889179988,"recon":-0.0007053308889179944},
{"x":72,"actual":-0.00208453863492597,"recon":-0.0020845386349259715},
{"x":73,"actual":0.000691800843685364,"recon":0.0006918008436853636},
{"x":74,"actual":0.0006889306264676875,"recon":0.0006889306264676871},
{"x":75,"actual":-0.0006937099301715932,"recon":-0.0006937099301715936},
{"x":76,"actual":0.002749130873053396,"recon":0.0027491308730533954},
{"x":77,"actual":-0.0013859073962603219,"recon":-0.001385907396260321},
{"x":78,"actual":-0.0006907996280087758,"recon":-0.0006907996280087762},
{"x":79,"actual":-0.002052686317742136,"recon":-0.0020526863177421357},
{"x":80,"actual":0.002730377122857064,"recon":0.0027303771228570648},
{"x":81,"actual":-7.434664400562951e-6,"recon":-7.434664400563819e-6},
{"x":82,"actual":-0.002043363771072393,"recon":-0.0020433637710723924},
{"x":83,"actual":0.0013563907977145462,"recon":0.0013563907977145453},
{"x":84,"actual":0.0006722244517805009,"recon":0.0006722244517805009},
{"x":85,"actual":0.0006667670796467462,"recon":0.0006667670796467471},
{"x":86,"actual":0.0006600141956534245,"recon":0.0006600141956534245},
{"x":87,"actual":-0.0020235766124940824,"recon":-0.002023576612494083},
{"x":88,"actual":-0.0013418304461128017,"recon":-0.0013418304461127995},
{"x":89,"actual":0.002004230230830295,"recon":0.0020042302308302955},
{"x":90,"actual":-0.000673130828106494,"recon":-0.000673130828106494},
{"x":91,"actual":0.0006606779932178952,"recon":0.0006606779932178944},
{"x":92,"actual":-7.063964640785514e-6,"recon":-7.0639646407859476e-6},
{"x":93,"actual":-0.0006681836132438335,"recon":-0.000668183613243833},
{"x":94,"actual":0.001974303244467457,"recon":0.001974303244467457},
{"x":95,"actual":-0.0019860669123801244,"recon":-0.0019860669123801236},
{"x":96,"actual":-3.890316417454187e-6,"recon":-3.890316417452452e-6},
{"x":97,"actual":-0.0006589683894890896,"recon":-0.0006589683894890879},
{"x":98,"actual":0.0006525184868495515,"recon":0.0006525184868495524},
{"x":99,"actual":-0.0006568043560379877,"recon":-0.000656804356037989},
{"x":100,"actual":0.0013020746349914347,"recon":0.0013020746349914365},
{"x":101,"actual":-0.0013071808463145373,"recon":-0.0013071808463145378},
{"x":102,"actual":-1.6932170154859705e-6,"recon":-1.6932170154859705e-6},
{"x":103,"actual":0.00388432643390324,"recon":0.0038843264339032384},
{"x":104,"actual":-0.00324735739395976,"recon":-0.003247357393959761},
{"x":105,"actual":0.0012832553598149943,"recon":0.0012832553598149925},
{"x":106,"actual":0.0006304812020561101,"recon":0.0006304812020561093},
{"x":107,"actual":-0.0019310953122735341,"recon":-0.0019310953122735337},
{"x":108,"actual":-3.6793390600919906e-6,"recon":-3.6793390600924243e-6},
{"x":109,"actual":-3.665264431518267e-6,"recon":-3.665264431518267e-6},
{"x":110,"actual":-0.0006395813395343453,"recon":-0.000639581339534344},
{"x":111,"actual":0.0019025393270881708,"recon":0.0019025393270881686},
{"x":112,"actual":-1.0052609325406081e-5,"recon":-1.0052609325406081e-5},
{"x":113,"actual":-9.989165751456142e-6,"recon":-9.989165751458744e-6},
{"x":114,"actual":-0.000638264387432308,"recon":-0.0006382643874323058},
{"x":115,"actual":-0.0006334767990034962,"recon":-0.0006334767990034975},
{"x":116,"actual":-3.5421475219621357e-6,"recon":-3.5421475219612683e-6},
{"x":117,"actual":-0.0012543107536444609,"recon":-0.0012543107536444617},
{"x":118,"actual":-3.916034732043272e-7,"recon":-3.9160347320302616e-7},
{"x":119,"actual":-0.0006255865077342548,"recon":-0.0006255865077342544},
{"x":120,"actual":0.0018744147943507983,"recon":0.001874414794350797},
{"x":121,"actual":-0.0006267539961957169,"recon":-0.0006267539961957143},
{"x":122,"actual":0.0012430005142967104,"recon":0.00124300051429671},
{"x":123,"actual":-6.187984790351209e-6,"recon":-6.187984790352076e-6},
{"x":124,"actual":-0.00062516073747787,"recon":-0.0006251607374778722},
{"x":125,"actual":-0.0006216886698338087,"recon":-0.0006216886698338095},
{"x":126,"actual":-0.0006193858790188855,"recon":-0.0006193858790188855},
{"x":127,"actual":0.0006170925666610927,"recon":0.0006170925666610936},
{"x":128,"actual":-0.001235330607991969,"recon":-0.00123533060799197},
{"x":129,"actual":0.0,"recon":0.0},
{"x":130,"actual":0.001233806448929009,"recon":0.0012338064489290095},
{"x":131,"actual":0.001229248983468878,"recon":0.0012292489834688793},
{"x":132,"actual":-0.0012337989776680658,"recon":-0.001233798977668065},
{"x":133,"actual":0.0012247325068361903,"recon":0.0012247325068361885},
{"x":134,"actual":-0.0012292490656697908,"recon":-0.001229249065669792},
{"x":135,"actual":-0.0006129319844907499,"recon":-0.0006129319844907504},
{"x":136,"actual":0.0018316875010704337,"recon":0.0018316875010704354},
{"x":137,"actual":-0.001223983066214629,"recon":-0.001223983066214628},
{"x":138,"actual":0.0006069721797734573,"recon":0.0006069721797734577},
{"x":139,"actual":-3.3299645201267936e-6,"recon":-3.329964520125926e-6},
{"x":140,"actual":-0.001823154561514606,"recon":-0.001823154561514607},
{"x":141,"actual":0.0006069802917769707,"recon":0.0006069802917769715},
{"x":142,"actual":0.006045599429250537,"recon":0.006045599429250539},
{"x":143,"actual":-0.006049988560882902,"recon":-0.0060499885608829},
{"x":144,"actual":-0.0006025911601446055,"recon":-0.0006025911601446033},
{"x":145,"actual":0.0042080014002046084,"recon":0.004208001400204606},
{"x":146,"actual":-0.0018113555556045213,"recon":-0.0018113555556045218},
{"x":147,"actual":0.0017837125871578152,"recon":0.0017837125871578144},
{"x":148,"actual":-0.0023941120502941615,"recon":-0.002394112050294161},
{"x":149,"actual":-3.1849878077139238e-6,"recon":-3.1849878077156585e-6},
{"x":150,"actual":0.0005894189599748856,"recon":0.000589418959974886},
{"x":151,"actual":0.0005852266236017201,"recon":0.0005852266236017201},
{"x":152,"actual":0.0011684409339398627,"recon":0.0011684409339398636},
{"x":153,"actual":0.001738971541225709,"recon":0.001738971541225709},
{"x":154,"actual":-0.006450085833512809,"recon":-0.006450085833512808},
{"x":155,"actual":0.0023388399672104043,"recon":0.0023388399672104043},
{"x":156,"actual":0.00407025469989275,"recon":0.004070254699892752},
{"x":157,"actual":-0.0029247351269861,"recon":-0.0029247351269861004},
{"x":158,"actual":-0.00289939315900245,"recon":-0.00289939315900245},
{"x":159,"actual":0.00519781707361755,"recon":0.005197817073617552},
{"x":160,"actual":-0.003471197939630244,"recon":-0.003471197939630243},
{"x":161,"actual":-2.976075822225255e-6,"recon":-2.9760758222243874e-6},
{"x":162,"actual":0.0005699359289339512,"recon":0.0005699359289339503},
{"x":163,"actual":0.0034174588084159296,"recon":0.0034174588084159305},
{"x":164,"actual":-0.003435723958379988,"recon":-0.003435723958379984},
{"x":165,"actual":-0.0017072933731263618,"recon":-0.0017072933731263592},
{"x":166,"actual":0.0011341076065223277,"recon":0.0011341076065223277},
{"x":167,"actual":0.003386941436940738,"recon":0.003386941436940738},
{"x":168,"actual":-0.0028355474270282954,"recon":-0.0028355474270282963},
{"x":169,"actual":-0.003943187365570644,"recon":-0.003943187365570645},
{"x":170,"actual":0.001689665285127262,"recon":0.0016896652851272607},
{"x":171,"actual":0.003938120420137636,"recon":0.003938120420137636},
{"x":172,"actual":-0.0067494801576843955,"recon":-0.0067494801576843955},
{"x":173,"actual":0.002248138094947727,"recon":0.002248138094947727},
{"x":174,"actual":-3.1739739281277934e-7,"recon":-3.173973928110446e-7},
{"x":175,"actual":0.002253204325119107,"recon":0.002253204325119108},
{"x":176,"actual":-2.850153648203957e-6,"recon":-2.8501536482048243e-6},
{"x":177,"actual":0.001118235796129241,"recon":0.0011182357961292393},
{"x":178,"actual":0.0016667284637854607,"recon":0.001666728463785459},
{"x":179,"actual":-0.0033569520741476566,"recon":-0.0033569520741476566},
{"x":180,"actual":-0.000557879377479864,"recon":-0.0005578793774798662},
{"x":181,"actual":0.0016677470823447393,"recon":0.0016677470823447402},
{"x":182,"actual":0.0005492318606146185,"recon":0.0005492318606146167},
{"x":183,"actual":-0.0011132566975851077,"recon":-0.0011132566975851077},
{"x":184,"actual":0.0005492754656621912,"recon":0.0005492754656621921},
{"x":185,"actual":-0.000555685554776808,"recon":-0.000555685554776808},
{"x":186,"actual":-2.7320575526346147e-6,"recon":-2.732057552630278e-6},
{"x":187,"actual":0.0027392583790168956,"recon":0.0027392583790168974},
{"x":188,"actual":0.0010707236080316207,"recon":0.0010707236080316207},
{"x":189,"actual":-0.0038288566016362324,"recon":-0.0038288566016362337},
{"x":190,"actual":-0.005446332794130981,"recon":-0.005446332794130984},
{"x":191,"actual":0.0021747825270352905,"recon":0.0021747825270352905},
{"x":192,"actual":0.002731793126854676,"recon":0.002731793126854674},
{"x":193,"actual":0.0021786442569711184,"recon":0.0021786442569711193},
{"x":194,"actual":0.0010739307188858405,"recon":0.0010739307188858413},
{"x":195,"actual":-0.0010987151606309808,"recon":-0.0010987151606309808},
{"x":196,"actual":-0.004327837285243774,"recon":-0.004327837285243772},
{"x":197,"actual":0.0016217678716188288,"recon":0.0016217678716188271},
{"x":198,"actual":0.0021583702839196306,"recon":0.0021583702839196323},
{"x":199,"actual":0.0016043385908881547,"recon":0.0016043385908881538},
{"x":200,"actual":-0.0021586226199197256,"recon":-0.002158622619919729},
{"x":201,"actual":-4.590207765886589e-6,"recon":-4.590207765886589e-6},
{"x":202,"actual":-0.0005380462080903925,"recon":-0.0005380462080903921},
{"x":203,"actual":0.002657720822680787,"recon":0.002657720822680787},
{"x":204,"actual":-0.0005473099907735701,"recon":-0.000547309990773571},
{"x":205,"actual":-0.00265434619923699,"recon":-0.0026543461992369908},
{"x":206,"actual":-0.0005295202035817681,"recon":-0.0005295202035817672},
{"x":207,"actual":0.0026375486046843477,"recon":0.0026375486046843503},
{"x":208,"actual":0.0020886432803086663,"recon":0.0020886432803086663},
{"x":209,"actual":-0.0005489818009465353,"recon":-0.0005489818009465344},
{"x":210,"actual":-0.0047058910374122576,"recon":-0.004705891037412256},
{"x":211,"actual":-0.0005217845148388633,"recon":-0.0005217845148388633},
{"x":212,"actual":0.004688457209685026,"recon":0.004688457209685026},
{"x":213,"actual":-0.0005350214919834784,"recon":-0.0005350214919834792},
{"x":214,"actual":-0.0005292702243808733,"recon":-0.0005292702243808742},
{"x":215,"actual":-0.0036187765489552604,"recon":-0.0036187765489552595},
{"x":216,"actual":0.0010327911409468982,"recon":0.0010327911409468982},
{"x":217,"actual":0.005659640530090826,"recon":0.005659640530090826},
{"x":218,"actual":-3.7909411778613844e-5,"recon":-3.7909411778613844e-5},
{"x":219,"actual":0.007536434331387731,"recon":0.0075364343313877305},
{"x":220,"actual":-0.012166644172496355,"recon":-0.012166644172496357},
{"x":221,"actual":-0.006543174213322622,"recon":-0.00654317421332262},
{"x":222,"actual":0.005035257365645585,"recon":0.005035257365645581},
{"x":223,"actual":0.006039273514243604,"recon":0.006039273514243602},
{"x":224,"actual":-0.005537643205254739,"recon":-0.005537643205254738},
{"x":225,"actual":0.0010017525850427589,"recon":0.0010017525850427597},
{"x":226,"actual":0.003491632486491092,"recon":0.0034916324864910885},
{"x":227,"actual":-0.0020099385370686562,"recon":-0.002009938537068657},
{"x":228,"actual":-0.0005043015696912789,"recon":-0.0005043015696912781},
{"x":229,"actual":0.0029553636384971327,"recon":0.002955363638497131},
{"x":230,"actual":-0.0010102649554042387,"recon":-0.0010102649554042382},
{"x":231,"actual":-0.009344723028451796,"recon":-0.009344723028451796},
{"x":232,"actual":0.00047110267335970235,"recon":0.00047110267335970235},
{"x":233,"actual":0.0049429184806495385,"recon":0.0049429184806495385},
{"x":234,"actual":0.0049355991027209,"recon":0.0049355991027208975},
{"x":235,"actual":-0.0037728651289015147,"recon":-0.003772865128901513},
{"x":236,"actual":0.002212943077307017,"recon":0.0022129430773070195},
{"x":237,"actual":0.0013157983596601142,"recon":0.0013157983596601133},
{"x":238,"actual":-0.0021904780112009803,"recon":-0.00219047801120098},
{"x":239,"actual":0.0011283071749250695,"recon":0.0011283071749250695},
{"x":240,"actual":-0.001810404477464722,"recon":-0.0018104044774647234},
{"x":241,"actual":-0.0005350597127780077,"recon":-0.0005350597127780068},
{"x":242,"actual":-0.001470779266562694,"recon":-0.0014707792665626931},
{"x":243,"actual":0.003920367045320283,"recon":0.003920367045320284},
{"x":244,"actual":-0.0011501058443394996,"recon":-0.0011501058443395005},
{"x":245,"actual":0.004749669681774371,"recon":0.004749669681774369},
{"x":246,"actual":-0.004934340679924709,"recon":-0.004934340679924711}];
    const series = [{"name":"Actual","color":"#1f77b4","key":"actual","dash":""},{"name":"Reconstructed","color":"#ff7f0e","key":"recon","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#bhd_line_60');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>