<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hamilton (2018) Filter (h=8, p=4)</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">Hamilton (2018) Filter (h=8, p=4)</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">Trend-Cycle Decomposition</div>
<div id="filt_tc_63"></div>
</div>
<div class="panel">
<div class="panel-title">Cyclical Component</div>
<div id="filt_cy_64"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":12,"trend":4.077037572850251,"cycle":0.024108804490778013,"orig":4.101146377341029,"zero":0},
{"x":13,"trend":4.0805404537439,"cycle":0.020408915308070874,"orig":4.100949369051971,"zero":0},
{"x":14,"trend":4.08770626792605,"cycle":0.01824237246656324,"orig":4.105948640392613,"zero":0},
{"x":15,"trend":4.0945821668093325,"cycle":0.013831296008227412,"orig":4.10841346281756,"zero":0},
{"x":16,"trend":4.103124780978603,"cycle":0.011073060851598981,"orig":4.114197841830202,"zero":0},
{"x":17,"trend":4.1061653446140545,"cycle":0.006014224132959711,"orig":4.112179568747014,"zero":0},
{"x":18,"trend":4.122929471517359,"cycle":-0.007852975376176907,"orig":4.115076496141182,"zero":0},
{"x":19,"trend":4.127787318223483,"cycle":-0.012563910650042587,"orig":4.11522340757344,"zero":0},
{"x":20,"trend":4.1323057533379925,"cycle":-0.012080666486315117,"orig":4.120225086851677,"zero":0},
{"x":21,"trend":4.124024667310897,"cycle":-0.006929213818092528,"orig":4.117095453492804,"zero":0},
{"x":22,"trend":4.128088024195736,"cycle":-0.006691034312319211,"orig":4.121396989883417,"zero":0},
{"x":23,"trend":4.129771085685092,"cycle":-0.005958340213954472,"orig":4.123812745471137,"zero":0},
{"x":24,"trend":4.1386251805334,"cycle":-0.010293125884185628,"orig":4.128332054649214,"zero":0},
{"x":25,"trend":4.132706606464317,"cycle":-0.0014292026826243642,"orig":4.131277403781692,"zero":0},
{"x":26,"trend":4.134344738670689,"cycle":-0.007502331730926848,"orig":4.126842406939762,"zero":0},
{"x":27,"trend":4.132194185619939,"cycle":-0.0028541702505959776,"orig":4.129340015369343,"zero":0},
{"x":28,"trend":4.140953378792539,"cycle":-0.011763044144839974,"orig":4.129190334647699,"zero":0},
{"x":29,"trend":4.1348534326621005,"cycle":-0.011364393501531289,"orig":4.123489039160569,"zero":0},
{"x":30,"trend":4.140171465052878,"cycle":-0.016758512083430155,"orig":4.123412952969447,"zero":0},
{"x":31,"trend":4.142720817745016,"cycle":-0.029001824464824466,"orig":4.113718993280192,"zero":0},
{"x":32,"trend":4.151339309823026,"cycle":-0.027869696373681307,"orig":4.123469613449345,"zero":0},
{"x":33,"trend":4.153850104257037,"cycle":-0.03351945739723927,"orig":4.120330646859798,"zero":0},
{"x":34,"trend":4.144476088044305,"cycle":-0.025494199312925403,"orig":4.11898188873138,"zero":0},
{"x":35,"trend":4.14457764884378,"cycle":-0.022222407671185884,"orig":4.1223552411725946,"zero":0},
{"x":36,"trend":4.1441044558455244,"cycle":-0.016279986382820688,"orig":4.127824469462704,"zero":0},
{"x":37,"trend":4.136600229372202,"cycle":-0.013846392676422958,"orig":4.122753836695779,"zero":0},
{"x":38,"trend":4.134167385661641,"cycle":-0.002372907992702622,"orig":4.131794477668938,"zero":0},
{"x":39,"trend":4.119592580005939,"cycle":0.017171100654747917,"orig":4.136763680660687,"zero":0},
{"x":40,"trend":4.137512061490274,"cycle":-0.003371631035469669,"orig":4.134140430454805,"zero":0},
{"x":41,"trend":4.136267484326538,"cycle":0.0009098494479955477,"orig":4.137177333774534,"zero":0},
{"x":42,"trend":4.136762975698093,"cycle":0.0038001931033910807,"orig":4.140563168801484,"zero":0},
{"x":43,"trend":4.137262412087112,"cycle":0.0015518835588386182,"orig":4.13881429564595,"zero":0},
{"x":44,"trend":4.148988949119035,"cycle":-0.006687903476080059,"orig":4.142301045642955,"zero":0},
{"x":45,"trend":4.1414172676437655,"cycle":0.0009600291132079164,"orig":4.142377296756973,"zero":0},
{"x":46,"trend":4.15229197462055,"cycle":-0.015774331007254005,"orig":4.136517643613296,"zero":0},
{"x":47,"trend":4.160018294249702,"cycle":-0.036297794401211725,"orig":4.12372049984849,"zero":0},
{"x":48,"trend":4.157185233022216,"cycle":-0.040831329761859436,"orig":4.116353903260356,"zero":0},
{"x":49,"trend":4.155357435362864,"cycle":-0.042264723179071595,"orig":4.113092712183793,"zero":0},
{"x":50,"trend":4.159207609951515,"cycle":-0.0535308338327507,"orig":4.105676776118765,"zero":0},
{"x":51,"trend":4.157622789488037,"cycle":-0.057717052635563704,"orig":4.099905736852473,"zero":0},
{"x":52,"trend":4.160534422118171,"cycle":-0.05799354167158466,"orig":4.102540880446586,"zero":0},
{"x":53,"trend":4.1596807143358205,"cycle":-0.047769683288036546,"orig":4.111911031047784,"zero":0},
{"x":54,"trend":4.150155877539724,"cycle":-0.030174433242885712,"orig":4.1199814442968385,"zero":0},
{"x":55,"trend":4.126020530706998,"cycle":-0.003242394544590965,"orig":4.122778136162407,"zero":0},
{"x":56,"trend":4.11319749044808,"cycle":0.009569306036714131,"orig":4.122766796484794,"zero":0},
{"x":57,"trend":4.113150158759895,"cycle":0.01751829667602145,"orig":4.1306684554359165,"zero":0},
{"x":58,"trend":4.1095597513255395,"cycle":0.020562102272082328,"orig":4.130121853597622,"zero":0},
{"x":59,"trend":4.1038940957749785,"cycle":0.024644142117100643,"orig":4.128538237892079,"zero":0},
{"x":60,"trend":4.111039771457905,"cycle":0.012624082124651714,"orig":4.123663853582556,"zero":0},
{"x":61,"trend":4.132657044448088,"cycle":-0.014244454892287095,"orig":4.118412589555801,"zero":0},
{"x":62,"trend":4.150183083239974,"cycle":-0.024735604091882912,"orig":4.125447479148091,"zero":0},
{"x":63,"trend":4.15227351695397,"cycle":-0.018336515805380316,"orig":4.13393700114859,"zero":0},
{"x":64,"trend":4.1453092066036685,"cycle":-0.0038107387882817534,"orig":4.141498467815387,"zero":0},
{"x":65,"trend":4.1530350113721575,"cycle":-0.008250852391987529,"orig":4.14478415898017,"zero":0},
{"x":66,"trend":4.15176366161946,"cycle":-0.006467780143307067,"orig":4.145295881476153,"zero":0},
{"x":67,"trend":4.14713408860184,"cycle":0.007326730947244897,"orig":4.154460819549085,"zero":0},
{"x":68,"trend":4.134384067684711,"cycle":0.014469197287742652,"orig":4.148853264972454,"zero":0},
{"x":69,"trend":4.125627744963364,"cycle":0.026518635180991623,"orig":4.152146380144355,"zero":0},
{"x":70,"trend":4.138545790684879,"cycle":0.020329480144274825,"orig":4.158875270829154,"zero":0},
{"x":71,"trend":4.157804118048512,"cycle":0.004856197578936516,"orig":4.162660315627448,"zero":0},
{"x":72,"trend":4.1729742563154355,"cycle":-0.008626444321587101,"orig":4.164347811993848,"zero":0},
{"x":73,"trend":4.173465323788717,"cycle":-0.00528496930762401,"orig":4.168180354481093,"zero":0},
{"x":74,"trend":4.1680770507500435,"cycle":0.004907697610374129,"orig":4.172984748360418,"zero":0},
{"x":75,"trend":4.178150651210866,"cycle":-0.006039816582816826,"orig":4.172110834628049,"zero":0},
{"x":76,"trend":4.168293514145944,"cycle":0.006556725485741488,"orig":4.174850239631685,"zero":0},
{"x":77,"trend":4.1703243656504565,"cycle":0.0007342936393488486,"orig":4.171058659289805,"zero":0},
{"x":78,"trend":4.178050345554339,"cycle":-0.004739038914999938,"orig":4.173311306639339,"zero":0},
{"x":79,"trend":4.18781304507176,"cycle":-0.011808621935108121,"orig":4.176004423136652,"zero":0},
{"x":80,"trend":4.18765627606883,"cycle":-0.012858321285007968,"orig":4.174797954783822,"zero":0},
{"x":81,"trend":4.1894508206328185,"cycle":-0.009361377533261717,"orig":4.180089443099557,"zero":0},
{"x":82,"trend":4.195405919363667,"cycle":-0.008012823841807126,"orig":4.18739309552186,"zero":0},
{"x":83,"trend":4.192806758727014,"cycle":-0.0008546576519048443,"orig":4.191952101075109,"zero":0},
{"x":84,"trend":4.193813498895428,"cycle":0.00404387302671072,"orig":4.197857371922138,"zero":0},
{"x":85,"trend":4.185407802044296,"cycle":0.01532324934477014,"orig":4.2007310513890666,"zero":0},
{"x":86,"trend":4.1883733612473755,"cycle":0.012940421971967986,"orig":4.2013137832193435,"zero":0},
{"x":87,"trend":4.1925276632227,"cycle":0.018936010603274767,"orig":4.211463673825975,"zero":0},
{"x":88,"trend":4.192597920721768,"cycle":0.024761891146859227,"orig":4.2173598118686275,"zero":0},
{"x":89,"trend":4.199204076852734,"cycle":0.022746230974441062,"orig":4.221950307827175,"zero":0},
{"x":90,"trend":4.210862944104839,"cycle":0.017815813409471914,"orig":4.228678757514311,"zero":0},
{"x":91,"trend":4.218965119630632,"cycle":0.01104314356317726,"orig":4.23000826319381,"zero":0},
{"x":92,"trend":4.2246145019139245,"cycle":0.012075618792811937,"orig":4.2366901207067365,"zero":0},
{"x":93,"trend":4.224966752865264,"cycle":0.014863917103024704,"orig":4.239830669968288,"zero":0},
{"x":94,"trend":4.222307370238581,"cycle":0.025536230967565743,"orig":4.247843601206147,"zero":0},
{"x":95,"trend":4.235080015604749,"cycle":0.019576208558083508,"orig":4.254656224162832,"zero":0},
{"x":96,"trend":4.244635246682978,"cycle":0.0201874034020868,"orig":4.264822650085065,"zero":0},
{"x":97,"trend":4.250346901770795,"cycle":0.016176284512207317,"orig":4.266523186283003,"zero":0},
{"x":98,"trend":4.254898725402954,"cycle":0.010495773575036615,"orig":4.265394498977991,"zero":0},
{"x":99,"trend":4.253631534492729,"cycle":0.013423265643549342,"orig":4.267054800136278,"zero":0},
{"x":100,"trend":4.2606019846687,"cycle":0.004725089677362071,"orig":4.265327074346062,"zero":0},
{"x":101,"trend":4.2626394361771425,"cycle":0.007586545154038227,"orig":4.270225981331181,"zero":0},
{"x":102,"trend":4.273994711908718,"cycle":-0.0004598791453336304,"orig":4.273534832763384,"zero":0},
{"x":103,"trend":4.281903443844322,"cycle":-0.012558503821043843,"orig":4.269344940023278,"zero":0},
{"x":104,"trend":4.296029923279928,"cycle":-0.013515660264198814,"orig":4.282514263015729,"zero":0},
{"x":105,"trend":4.294153098832499,"cycle":-0.0076136596292908365,"orig":4.286539439203208,"zero":0},
{"x":106,"trend":4.286133421599269,"cycle":-0.0013530898069662456,"orig":4.2847803317923026,"zero":0},
{"x":107,"trend":4.282410858955086,"cycle":0.005001478731848863,"orig":4.287412337686935,"zero":0},
{"x":108,"trend":4.279106471402446,"cycle":0.011770690707573195,"orig":4.290877162110019,"zero":0},
{"x":109,"trend":4.287187474423934,"cycle":-0.0020503911052829338,"orig":4.285137083318651,"zero":0},
{"x":110,"trend":4.292898149898225,"cycle":0.006768093346892101,"orig":4.299666243245117,"zero":0},
{"x":111,"trend":4.286289530346746,"cycle":0.012151670269330062,"orig":4.298441200616076,"zero":0},
{"x":112,"trend":4.303780953651052,"cycle":0.004561465225545014,"orig":4.308342418876597,"zero":0},
{"x":113,"trend":4.311630433481428,"cycle":0.004157569018093277,"orig":4.315788002499521,"zero":0},
{"x":114,"trend":4.308561160941086,"cycle":0.014820219799618783,"orig":4.323381380740705,"zero":0},
{"x":115,"trend":4.304043654741638,"cycle":0.01949147203477697,"orig":4.323535126776415,"zero":0},
{"x":116,"trend":4.308295335751762,"cycle":0.02034502630922841,"orig":4.32864036206099,"zero":0},
{"x":117,"trend":4.299717754276903,"cycle":0.03516223990230127,"orig":4.334879994179205,"zero":0},
{"x":118,"trend":4.320487056999584,"cycle":0.014689031229639049,"orig":4.335176088229223,"zero":0},
{"x":119,"trend":4.3201515176192595,"cycle":0.024169355782031943,"orig":4.3443208734012915,"zero":0},
{"x":120,"trend":4.336113027391677,"cycle":0.014594494102071032,"orig":4.350707521493748,"zero":0},
{"x":121,"trend":4.3418970071082805,"cycle":0.010394384759335296,"orig":4.352291391867616,"zero":0},
{"x":122,"trend":4.353927998420198,"cycle":0.010231210247014566,"orig":4.364159208667212,"zero":0},
{"x":123,"trend":4.347839441963475,"cycle":0.022645846863847297,"orig":4.3704852888273225,"zero":0},
{"x":124,"trend":4.3501538142809775,"cycle":0.02150298906171333,"orig":4.371656803342691,"zero":0},
{"x":125,"trend":4.356857870782874,"cycle":0.020323293537384046,"orig":4.377181164320258,"zero":0},
{"x":126,"trend":4.356997148761314,"cycle":0.024769452106707668,"orig":4.381766600868022,"zero":0},
{"x":127,"trend":4.367701929393275,"cycle":0.022570614134457934,"orig":4.3902725435277326,"zero":0},
{"x":128,"trend":4.376034539364212,"cycle":0.024192950257106105,"orig":4.400227489621318,"zero":0},
{"x":129,"trend":4.377259398177133,"cycle":0.03208566690075898,"orig":4.409345065077892,"zero":0},
{"x":130,"trend":4.390302492488036,"cycle":0.02787042257185135,"orig":4.418172915059888,"zero":0},
{"x":131,"trend":4.398565197492338,"cycle":0.027452006462578282,"orig":4.426017203954916,"zero":0},
{"x":132,"trend":4.397688869720189,"cycle":0.03257777781764393,"orig":4.430266647537833,"zero":0},
{"x":133,"trend":4.398610602939575,"cycle":0.03602982887420403,"orig":4.434640431813779,"zero":0},
{"x":134,"trend":4.40312752135826,"cycle":0.033130400073787314,"orig":4.4362579214320474,"zero":0},
{"x":135,"trend":4.415900598084298,"cycle":0.020708914359874875,"orig":4.436609512444173,"zero":0},
{"x":136,"trend":4.429403286478465,"cycle":0.010631609146321885,"orig":4.440034895624787,"zero":0},
{"x":137,"trend":4.441334466052317,"cycle":0.00527014210588117,"orig":4.446604608158198,"zero":0},
{"x":138,"trend":4.45003403181386,"cycle":-0.00944607894180649,"orig":4.440587952872053,"zero":0},
{"x":139,"trend":4.456427163418391,"cycle":-0.01969219723985205,"orig":4.436734966178539,"zero":0},
{"x":140,"trend":4.457271168430966,"cycle":-4.430119414866596e-5,"orig":4.457226867236817,"zero":0},
{"x":141,"trend":4.458161235922209,"cycle":-0.0014666966003531456,"orig":4.456694539321856,"zero":0},
{"x":142,"trend":4.455956146444452,"cycle":0.00755139197225585,"orig":4.4635075384167076,"zero":0},
{"x":143,"trend":4.453268909855075,"cycle":0.009480201397099819,"orig":4.462749111252175,"zero":0},
{"x":144,"trend":4.456069473346901,"cycle":0.0111997874987253,"orig":4.467269260845626,"zero":0},
{"x":145,"trend":4.466460664139602,"cycle":0.005119841811002779,"orig":4.471580505950604,"zero":0},
{"x":146,"trend":4.4565016112356375,"cycle":0.02114197436531473,"orig":4.477643585600952,"zero":0},
{"x":147,"trend":4.4455920993149505,"cycle":0.03431753897544709,"orig":4.479909638290398,"zero":0},
{"x":148,"trend":4.476565144069943,"cycle":0.005640480311960516,"orig":4.482205624381904,"zero":0},
{"x":149,"trend":4.483336872553238,"cycle":0.0051713990870512205,"orig":4.488508271640289,"zero":0},
{"x":150,"trend":4.491750641786119,"cycle":-0.004027048057838378,"orig":4.487723593728281,"zero":0},
{"x":151,"trend":4.479855527402233,"cycle":0.013637568644059073,"orig":4.493493096046292,"zero":0},
{"x":152,"trend":4.485859896432529,"cycle":0.01164044277738796,"orig":4.497500339209917,"zero":0},
{"x":153,"trend":4.489954374891457,"cycle":0.0035007032730067777,"orig":4.493455078164464,"zero":0},
{"x":154,"trend":4.500002564342205,"cycle":0.005601397721058277,"orig":4.5056039620632635,"zero":0},
{"x":155,"trend":4.50104371712381,"cycle":0.00939592104087783,"orig":4.510439638164688,"zero":0},
{"x":156,"trend":4.501228189076524,"cycle":0.016894982923311375,"orig":4.518123171999835,"zero":0},
{"x":157,"trend":4.5079620052226295,"cycle":0.008792181391891418,"orig":4.516754186614521,"zero":0},
{"x":158,"trend":4.505787702833312,"cycle":0.014084909492199316,"orig":4.5198726123255115,"zero":0},
{"x":159,"trend":4.512345051828816,"cycle":0.011076973026375114,"orig":4.523422024855191,"zero":0},
{"x":160,"trend":4.516435056855958,"cycle":0.012921549410280342,"orig":4.529356606266238,"zero":0},
{"x":161,"trend":4.509418292521461,"cycle":0.02264234579818325,"orig":4.532060638319645,"zero":0},
{"x":162,"trend":4.524570168289841,"cycle":0.00788092675618568,"orig":4.532451095046027,"zero":0},
{"x":163,"trend":4.533160790995464,"cycle":-0.002662428403025885,"orig":4.530498362592438,"zero":0},
{"x":164,"trend":4.546010495149573,"cycle":-0.01823876594988949,"orig":4.527771729199683,"zero":0},
{"x":165,"trend":4.536754378527916,"cycle":-0.004378566303351761,"orig":4.532375812224564,"zero":0},
{"x":166,"trend":4.53702733637759,"cycle":-0.008544908870733003,"orig":4.528482427506857,"zero":0},
{"x":167,"trend":4.5392858036542,"cycle":-0.010523771672497517,"orig":4.528762031981702,"zero":0},
{"x":168,"trend":4.549696313281018,"cycle":-0.024202652019623017,"orig":4.525493661261395,"zero":0},
{"x":169,"trend":4.5524382226002365,"cycle":-0.0317154306897649,"orig":4.5207227919104715,"zero":0},
{"x":170,"trend":4.550010327886635,"cycle":-0.03582230111053342,"orig":4.514188026776101,"zero":0},
{"x":171,"trend":4.5427499055256195,"cycle":-0.03061429050476061,"orig":4.512135615020859,"zero":0},
{"x":172,"trend":4.536271359062554,"cycle":-0.02773212471403408,"orig":4.50853923434852,"zero":0},
{"x":173,"trend":4.543710899503733,"cycle":-0.03995900994084334,"orig":4.503751889562889,"zero":0},
{"x":174,"trend":4.539789315549193,"cycle":-0.041331669903641455,"orig":4.498457645645551,"zero":0},
{"x":175,"trend":4.5400895158798455,"cycle":-0.04805667350574705,"orig":4.4920328423740985,"zero":0},
{"x":176,"trend":4.533014467205795,"cycle":-0.04213006439678679,"orig":4.490884402809008,"zero":0},
{"x":177,"trend":4.5267862030251464,"cycle":-0.04097967622090248,"orig":4.485806526804244,"zero":0},
{"x":178,"trend":4.515856079027639,"cycle":-0.03279477167773681,"orig":4.483061307349902,"zero":0},
{"x":179,"trend":4.514482655880923,"cycle":-0.03748680861633957,"orig":4.476995847264583,"zero":0},
{"x":180,"trend":4.51256088421149,"cycle":-0.03599254675430785,"orig":4.4765683374571825,"zero":0},
{"x":181,"trend":4.508349832620885,"cycle":-0.025148430322532,"orig":4.483201402298353,"zero":0},
{"x":182,"trend":4.500898002190068,"cycle":-0.01758137520910541,"orig":4.483316626980963,"zero":0},
{"x":183,"trend":4.4926786251085336,"cycle":-0.0021496654326478293,"orig":4.490528959675886,"zero":0},
{"x":184,"trend":4.493824260079716,"cycle":0.0015757017618485136,"orig":4.4953999618415645,"zero":0},
{"x":185,"trend":4.489869282731504,"cycle":0.009540307577421636,"orig":4.499409590308925,"zero":0},
{"x":186,"trend":4.488519417081102,"cycle":0.019105192464270893,"orig":4.507624609545373,"zero":0},
{"x":187,"trend":4.479952866452047,"cycle":0.027349772453826304,"orig":4.507302638905873,"zero":0},
{"x":188,"trend":4.48189374485865,"cycle":0.02429774052365996,"orig":4.50619148538231,"zero":0},
{"x":189,"trend":4.495870403288123,"cycle":0.01116973079078587,"orig":4.507040134078909,"zero":0},
{"x":190,"trend":4.5007183729265945,"cycle":0.004236924815379517,"orig":4.504955297741974,"zero":0},
{"x":191,"trend":4.511298938396757,"cycle":-0.0007570647374643968,"orig":4.510541873659292,"zero":0},
{"x":192,"trend":4.5166352540236465,"cycle":-0.011670007655273373,"orig":4.504965246368373,"zero":0},
{"x":193,"trend":4.5222114138277885,"cycle":-0.008760761735516098,"orig":4.513450652092272,"zero":0},
{"x":194,"trend":4.531079863739245,"cycle":-0.01644179071904528,"orig":4.514638073020199,"zero":0},
{"x":195,"trend":4.528048847507752,"cycle":-0.01604274583518084,"orig":4.512006101672571,"zero":0},
{"x":196,"trend":4.521835730751554,"cycle":-0.015804344388068436,"orig":4.506031386363485,"zero":0},
{"x":197,"trend":4.518394659723983,"cycle":-0.012636052791306973,"orig":4.505758606932676,"zero":0},
{"x":198,"trend":4.5155360610544815,"cycle":-0.008500339410254298,"orig":4.507035721644227,"zero":0},
{"x":199,"trend":4.524886692361812,"cycle":-0.012725835166985888,"orig":4.512160857194826,"zero":0},
{"x":200,"trend":4.516558729064009,"cycle":-0.006582029689157665,"orig":4.509976699374851,"zero":0},
{"x":201,"trend":4.529561219412413,"cycle":-0.013157768335422482,"orig":4.51640345107699,"zero":0},
{"x":202,"trend":4.530997604307553,"cycle":-0.013363296472144626,"orig":4.517634307835408,"zero":0},
{"x":203,"trend":4.527981345949001,"cycle":-0.0036644460643957544,"orig":4.524316899884605,"zero":0},
{"x":204,"trend":4.512484246263622,"cycle":0.012128599650393035,"orig":4.524612845914015,"zero":0},
{"x":205,"trend":4.5110462107898694,"cycle":0.015087261343179392,"orig":4.526133472133049,"zero":0},
{"x":206,"trend":4.516096738509274,"cycle":0.0160510397329352,"orig":4.5321477782422095,"zero":0},
{"x":207,"trend":4.52829953197077,"cycle":-0.00016050957732893778,"orig":4.528139022393441,"zero":0},
{"x":208,"trend":4.525339902013326,"cycle":0.006506619555922022,"orig":4.531846521569248,"zero":0},
{"x":209,"trend":4.533640460014445,"cycle":0.005403812261540075,"orig":4.539044272275985,"zero":0},
{"x":210,"trend":4.534262237734016,"cycle":-0.003050804264218776,"orig":4.531211433469797,"zero":0},
{"x":211,"trend":4.545208059807593,"cycle":-0.0065527466541297485,"orig":4.5386553131534635,"zero":0},
{"x":212,"trend":4.542736910991337,"cycle":-0.0034106311185055915,"orig":4.5393262798728315,"zero":0},
{"x":213,"trend":4.542956758755744,"cycle":-0.0023602945247578333,"orig":4.540596464230986,"zero":0},
{"x":214,"trend":4.549213998462459,"cycle":-0.00012222149424001572,"orig":4.549091776968219,"zero":0},
{"x":215,"trend":4.542987174464942,"cycle":0.008584957954271388,"orig":4.5515721324192135,"zero":0},
{"x":216,"trend":4.546142145199971,"cycle":0.0133662282201783,"orig":4.559508373420149,"zero":0},
{"x":217,"trend":4.556140217554075,"cycle":0.006958234981944145,"orig":4.563098452536019,"zero":0},
{"x":218,"trend":4.545726487489433,"cycle":0.024604811109357527,"orig":4.5703312985987905,"zero":0},
{"x":219,"trend":4.552907782863247,"cycle":0.01607133595592547,"orig":4.568979118819173,"zero":0},
{"x":220,"trend":4.552944739983665,"cycle":0.018184574279330512,"orig":4.571129314262995,"zero":0},
{"x":221,"trend":4.557862694440682,"cycle":0.014166340349165196,"orig":4.572029034789847,"zero":0},
{"x":222,"trend":4.567654308853497,"cycle":0.00886225509381422,"orig":4.576516563947311,"zero":0},
{"x":223,"trend":4.572401461568111,"cycle":0.0009436360909829133,"orig":4.573345097659094,"zero":0},
{"x":224,"trend":4.583117146812348,"cycle":-0.0065182608066916,"orig":4.576598886005656,"zero":0},
{"x":225,"trend":4.584794105807677,"cycle":-0.027759048571566858,"orig":4.55703505723611,"zero":0},
{"x":226,"trend":4.593957930102961,"cycle":-0.02485854345964089,"orig":4.5690993866433205,"zero":0},
{"x":227,"trend":4.587397732041,"cycle":-0.007120828776185029,"orig":4.580276903264815,"zero":0},
{"x":228,"trend":4.586901187308352,"cycle":-0.001472590479305147,"orig":4.585428596829047,"zero":0},
{"x":229,"trend":4.584878604890031,"cycle":0.0021265921399313825,"orig":4.587005197029963,"zero":0},
{"x":230,"trend":4.5927030917391205,"cycle":-0.005276394528819672,"orig":4.587426697210301,"zero":0},
{"x":231,"trend":4.586700614242108,"cycle":0.0029781976279386058,"orig":4.589678811870047,"zero":0},
{"x":232,"trend":4.589968630646137,"cycle":0.0027422596671806687,"orig":4.592710890313318,"zero":0},
{"x":233,"trend":4.556288627616053,"cycle":0.03667637725367623,"orig":4.592965004869729,"zero":0},
{"x":234,"trend":4.574203771682627,"cycle":0.021922642403526815,"orig":4.596126414086154,"zero":0},
{"x":235,"trend":4.597500072444352,"cycle":-0.001886404863729929,"orig":4.595613667580622,"zero":0},
{"x":236,"trend":4.6161520613739775,"cycle":-0.01615925491502157,"orig":4.599992806458956,"zero":0},
{"x":237,"trend":4.609871089458183,"cycle":-0.01154124535616674,"orig":4.598329844102016,"zero":0},
{"x":238,"trend":4.6030984010050995,"cycle":-0.005916032859209608,"orig":4.59718236814589,"zero":0},
{"x":239,"trend":4.60352881026178,"cycle":-0.006766874744227103,"orig":4.596761935517553,"zero":0},
{"x":240,"trend":4.607887394170127,"cycle":-0.0009837115558841703,"orig":4.606903682614242,"zero":0},
{"x":241,"trend":4.6079928681811495,"cycle":-0.004478051561223495,"orig":4.603514816619926,"zero":0},
{"x":242,"trend":4.611222254798073,"cycle":0.0016710311295273783,"orig":4.6128932859276,"zero":0},
{"x":243,"trend":4.6090579638927185,"cycle":0.005613937484184817,"orig":4.614671901376903,"zero":0},
{"x":244,"trend":4.615304762273751,"cycle":0.006067459004905018,"orig":4.621372221278656,"zero":0},
{"x":245,"trend":4.611541774751846,"cycle":0.010786368001620694,"orig":4.622328142753466,"zero":0},
{"x":246,"trend":4.608607659304748,"cycle":0.01429733123242638,"orig":4.622904990537174,"zero":0},
{"x":247,"trend":4.605605543799796,"cycle":0.016099190027385468,"orig":4.6217047338271815,"zero":0},
{"x":248,"trend":4.623563018401626,"cycle":6.575481040460573e-5,"orig":4.6236287732120305,"zero":0},
{"x":249,"trend":4.620321658254047,"cycle":0.005527241742401046,"orig":4.625848899996448,"zero":0},
{"x":250,"trend":4.633072911415352,"cycle":-0.01004807263341867,"orig":4.623024838781934,"zero":0},
{"x":251,"trend":4.632461256451929,"cycle":-0.00411570587328125,"orig":4.628345550578648,"zero":0},
{"x":252,"trend":4.643498522586081,"cycle":-0.014804211301120418,"orig":4.628694311284961,"zero":0}];
    const series = [{"name":"Original","color":"#1f77b4","key":"orig","dash":""},{"name":"Trend","color":"#ff7f0e","key":"trend","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#filt_tc_63');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":12,"trend":4.077037572850251,"cycle":0.024108804490778013,"orig":4.101146377341029,"zero":0},
{"x":13,"trend":4.0805404537439,"cycle":0.020408915308070874,"orig":4.100949369051971,"zero":0},
{"x":14,"trend":4.08770626792605,"cycle":0.01824237246656324,"orig":4.105948640392613,"zero":0},
{"x":15,"trend":4.0945821668093325,"cycle":0.013831296008227412,"orig":4.10841346281756,"zero":0},
{"x":16,"trend":4.103124780978603,"cycle":0.011073060851598981,"orig":4.114197841830202,"zero":0},
{"x":17,"trend":4.1061653446140545,"cycle":0.006014224132959711,"orig":4.112179568747014,"zero":0},
{"x":18,"trend":4.122929471517359,"cycle":-0.007852975376176907,"orig":4.115076496141182,"zero":0},
{"x":19,"trend":4.127787318223483,"cycle":-0.012563910650042587,"orig":4.11522340757344,"zero":0},
{"x":20,"trend":4.1323057533379925,"cycle":-0.012080666486315117,"orig":4.120225086851677,"zero":0},
{"x":21,"trend":4.124024667310897,"cycle":-0.006929213818092528,"orig":4.117095453492804,"zero":0},
{"x":22,"trend":4.128088024195736,"cycle":-0.006691034312319211,"orig":4.121396989883417,"zero":0},
{"x":23,"trend":4.129771085685092,"cycle":-0.005958340213954472,"orig":4.123812745471137,"zero":0},
{"x":24,"trend":4.1386251805334,"cycle":-0.010293125884185628,"orig":4.128332054649214,"zero":0},
{"x":25,"trend":4.132706606464317,"cycle":-0.0014292026826243642,"orig":4.131277403781692,"zero":0},
{"x":26,"trend":4.134344738670689,"cycle":-0.007502331730926848,"orig":4.126842406939762,"zero":0},
{"x":27,"trend":4.132194185619939,"cycle":-0.0028541702505959776,"orig":4.129340015369343,"zero":0},
{"x":28,"trend":4.140953378792539,"cycle":-0.011763044144839974,"orig":4.129190334647699,"zero":0},
{"x":29,"trend":4.1348534326621005,"cycle":-0.011364393501531289,"orig":4.123489039160569,"zero":0},
{"x":30,"trend":4.140171465052878,"cycle":-0.016758512083430155,"orig":4.123412952969447,"zero":0},
{"x":31,"trend":4.142720817745016,"cycle":-0.029001824464824466,"orig":4.113718993280192,"zero":0},
{"x":32,"trend":4.151339309823026,"cycle":-0.027869696373681307,"orig":4.123469613449345,"zero":0},
{"x":33,"trend":4.153850104257037,"cycle":-0.03351945739723927,"orig":4.120330646859798,"zero":0},
{"x":34,"trend":4.144476088044305,"cycle":-0.025494199312925403,"orig":4.11898188873138,"zero":0},
{"x":35,"trend":4.14457764884378,"cycle":-0.022222407671185884,"orig":4.1223552411725946,"zero":0},
{"x":36,"trend":4.1441044558455244,"cycle":-0.016279986382820688,"orig":4.127824469462704,"zero":0},
{"x":37,"trend":4.136600229372202,"cycle":-0.013846392676422958,"orig":4.122753836695779,"zero":0},
{"x":38,"trend":4.134167385661641,"cycle":-0.002372907992702622,"orig":4.131794477668938,"zero":0},
{"x":39,"trend":4.119592580005939,"cycle":0.017171100654747917,"orig":4.136763680660687,"zero":0},
{"x":40,"trend":4.137512061490274,"cycle":-0.003371631035469669,"orig":4.134140430454805,"zero":0},
{"x":41,"trend":4.136267484326538,"cycle":0.0009098494479955477,"orig":4.137177333774534,"zero":0},
{"x":42,"trend":4.136762975698093,"cycle":0.0038001931033910807,"orig":4.140563168801484,"zero":0},
{"x":43,"trend":4.137262412087112,"cycle":0.0015518835588386182,"orig":4.13881429564595,"zero":0},
{"x":44,"trend":4.148988949119035,"cycle":-0.006687903476080059,"orig":4.142301045642955,"zero":0},
{"x":45,"trend":4.1414172676437655,"cycle":0.0009600291132079164,"orig":4.142377296756973,"zero":0},
{"x":46,"trend":4.15229197462055,"cycle":-0.015774331007254005,"orig":4.136517643613296,"zero":0},
{"x":47,"trend":4.160018294249702,"cycle":-0.036297794401211725,"orig":4.12372049984849,"zero":0},
{"x":48,"trend":4.157185233022216,"cycle":-0.040831329761859436,"orig":4.116353903260356,"zero":0},
{"x":49,"trend":4.155357435362864,"cycle":-0.042264723179071595,"orig":4.113092712183793,"zero":0},
{"x":50,"trend":4.159207609951515,"cycle":-0.0535308338327507,"orig":4.105676776118765,"zero":0},
{"x":51,"trend":4.157622789488037,"cycle":-0.057717052635563704,"orig":4.099905736852473,"zero":0},
{"x":52,"trend":4.160534422118171,"cycle":-0.05799354167158466,"orig":4.102540880446586,"zero":0},
{"x":53,"trend":4.1596807143358205,"cycle":-0.047769683288036546,"orig":4.111911031047784,"zero":0},
{"x":54,"trend":4.150155877539724,"cycle":-0.030174433242885712,"orig":4.1199814442968385,"zero":0},
{"x":55,"trend":4.126020530706998,"cycle":-0.003242394544590965,"orig":4.122778136162407,"zero":0},
{"x":56,"trend":4.11319749044808,"cycle":0.009569306036714131,"orig":4.122766796484794,"zero":0},
{"x":57,"trend":4.113150158759895,"cycle":0.01751829667602145,"orig":4.1306684554359165,"zero":0},
{"x":58,"trend":4.1095597513255395,"cycle":0.020562102272082328,"orig":4.130121853597622,"zero":0},
{"x":59,"trend":4.1038940957749785,"cycle":0.024644142117100643,"orig":4.128538237892079,"zero":0},
{"x":60,"trend":4.111039771457905,"cycle":0.012624082124651714,"orig":4.123663853582556,"zero":0},
{"x":61,"trend":4.132657044448088,"cycle":-0.014244454892287095,"orig":4.118412589555801,"zero":0},
{"x":62,"trend":4.150183083239974,"cycle":-0.024735604091882912,"orig":4.125447479148091,"zero":0},
{"x":63,"trend":4.15227351695397,"cycle":-0.018336515805380316,"orig":4.13393700114859,"zero":0},
{"x":64,"trend":4.1453092066036685,"cycle":-0.0038107387882817534,"orig":4.141498467815387,"zero":0},
{"x":65,"trend":4.1530350113721575,"cycle":-0.008250852391987529,"orig":4.14478415898017,"zero":0},
{"x":66,"trend":4.15176366161946,"cycle":-0.006467780143307067,"orig":4.145295881476153,"zero":0},
{"x":67,"trend":4.14713408860184,"cycle":0.007326730947244897,"orig":4.154460819549085,"zero":0},
{"x":68,"trend":4.134384067684711,"cycle":0.014469197287742652,"orig":4.148853264972454,"zero":0},
{"x":69,"trend":4.125627744963364,"cycle":0.026518635180991623,"orig":4.152146380144355,"zero":0},
{"x":70,"trend":4.138545790684879,"cycle":0.020329480144274825,"orig":4.158875270829154,"zero":0},
{"x":71,"trend":4.157804118048512,"cycle":0.004856197578936516,"orig":4.162660315627448,"zero":0},
{"x":72,"trend":4.1729742563154355,"cycle":-0.008626444321587101,"orig":4.164347811993848,"zero":0},
{"x":73,"trend":4.173465323788717,"cycle":-0.00528496930762401,"orig":4.168180354481093,"zero":0},
{"x":74,"trend":4.1680770507500435,"cycle":0.004907697610374129,"orig":4.172984748360418,"zero":0},
{"x":75,"trend":4.178150651210866,"cycle":-0.006039816582816826,"orig":4.172110834628049,"zero":0},
{"x":76,"trend":4.168293514145944,"cycle":0.006556725485741488,"orig":4.174850239631685,"zero":0},
{"x":77,"trend":4.1703243656504565,"cycle":0.0007342936393488486,"orig":4.171058659289805,"zero":0},
{"x":78,"trend":4.178050345554339,"cycle":-0.004739038914999938,"orig":4.173311306639339,"zero":0},
{"x":79,"trend":4.18781304507176,"cycle":-0.011808621935108121,"orig":4.176004423136652,"zero":0},
{"x":80,"trend":4.18765627606883,"cycle":-0.012858321285007968,"orig":4.174797954783822,"zero":0},
{"x":81,"trend":4.1894508206328185,"cycle":-0.009361377533261717,"orig":4.180089443099557,"zero":0},
{"x":82,"trend":4.195405919363667,"cycle":-0.008012823841807126,"orig":4.18739309552186,"zero":0},
{"x":83,"trend":4.192806758727014,"cycle":-0.0008546576519048443,"orig":4.191952101075109,"zero":0},
{"x":84,"trend":4.193813498895428,"cycle":0.00404387302671072,"orig":4.197857371922138,"zero":0},
{"x":85,"trend":4.185407802044296,"cycle":0.01532324934477014,"orig":4.2007310513890666,"zero":0},
{"x":86,"trend":4.1883733612473755,"cycle":0.012940421971967986,"orig":4.2013137832193435,"zero":0},
{"x":87,"trend":4.1925276632227,"cycle":0.018936010603274767,"orig":4.211463673825975,"zero":0},
{"x":88,"trend":4.192597920721768,"cycle":0.024761891146859227,"orig":4.2173598118686275,"zero":0},
{"x":89,"trend":4.199204076852734,"cycle":0.022746230974441062,"orig":4.221950307827175,"zero":0},
{"x":90,"trend":4.210862944104839,"cycle":0.017815813409471914,"orig":4.228678757514311,"zero":0},
{"x":91,"trend":4.218965119630632,"cycle":0.01104314356317726,"orig":4.23000826319381,"zero":0},
{"x":92,"trend":4.2246145019139245,"cycle":0.012075618792811937,"orig":4.2366901207067365,"zero":0},
{"x":93,"trend":4.224966752865264,"cycle":0.014863917103024704,"orig":4.239830669968288,"zero":0},
{"x":94,"trend":4.222307370238581,"cycle":0.025536230967565743,"orig":4.247843601206147,"zero":0},
{"x":95,"trend":4.235080015604749,"cycle":0.019576208558083508,"orig":4.254656224162832,"zero":0},
{"x":96,"trend":4.244635246682978,"cycle":0.0201874034020868,"orig":4.264822650085065,"zero":0},
{"x":97,"trend":4.250346901770795,"cycle":0.016176284512207317,"orig":4.266523186283003,"zero":0},
{"x":98,"trend":4.254898725402954,"cycle":0.010495773575036615,"orig":4.265394498977991,"zero":0},
{"x":99,"trend":4.253631534492729,"cycle":0.013423265643549342,"orig":4.267054800136278,"zero":0},
{"x":100,"trend":4.2606019846687,"cycle":0.004725089677362071,"orig":4.265327074346062,"zero":0},
{"x":101,"trend":4.2626394361771425,"cycle":0.007586545154038227,"orig":4.270225981331181,"zero":0},
{"x":102,"trend":4.273994711908718,"cycle":-0.0004598791453336304,"orig":4.273534832763384,"zero":0},
{"x":103,"trend":4.281903443844322,"cycle":-0.012558503821043843,"orig":4.269344940023278,"zero":0},
{"x":104,"trend":4.296029923279928,"cycle":-0.013515660264198814,"orig":4.282514263015729,"zero":0},
{"x":105,"trend":4.294153098832499,"cycle":-0.0076136596292908365,"orig":4.286539439203208,"zero":0},
{"x":106,"trend":4.286133421599269,"cycle":-0.0013530898069662456,"orig":4.2847803317923026,"zero":0},
{"x":107,"trend":4.282410858955086,"cycle":0.005001478731848863,"orig":4.287412337686935,"zero":0},
{"x":108,"trend":4.279106471402446,"cycle":0.011770690707573195,"orig":4.290877162110019,"zero":0},
{"x":109,"trend":4.287187474423934,"cycle":-0.0020503911052829338,"orig":4.285137083318651,"zero":0},
{"x":110,"trend":4.292898149898225,"cycle":0.006768093346892101,"orig":4.299666243245117,"zero":0},
{"x":111,"trend":4.286289530346746,"cycle":0.012151670269330062,"orig":4.298441200616076,"zero":0},
{"x":112,"trend":4.303780953651052,"cycle":0.004561465225545014,"orig":4.308342418876597,"zero":0},
{"x":113,"trend":4.311630433481428,"cycle":0.004157569018093277,"orig":4.315788002499521,"zero":0},
{"x":114,"trend":4.308561160941086,"cycle":0.014820219799618783,"orig":4.323381380740705,"zero":0},
{"x":115,"trend":4.304043654741638,"cycle":0.01949147203477697,"orig":4.323535126776415,"zero":0},
{"x":116,"trend":4.308295335751762,"cycle":0.02034502630922841,"orig":4.32864036206099,"zero":0},
{"x":117,"trend":4.299717754276903,"cycle":0.03516223990230127,"orig":4.334879994179205,"zero":0},
{"x":118,"trend":4.320487056999584,"cycle":0.014689031229639049,"orig":4.335176088229223,"zero":0},
{"x":119,"trend":4.3201515176192595,"cycle":0.024169355782031943,"orig":4.3443208734012915,"zero":0},
{"x":120,"trend":4.336113027391677,"cycle":0.014594494102071032,"orig":4.350707521493748,"zero":0},
{"x":121,"trend":4.3418970071082805,"cycle":0.010394384759335296,"orig":4.352291391867616,"zero":0},
{"x":122,"trend":4.353927998420198,"cycle":0.010231210247014566,"orig":4.364159208667212,"zero":0},
{"x":123,"trend":4.347839441963475,"cycle":0.022645846863847297,"orig":4.3704852888273225,"zero":0},
{"x":124,"trend":4.3501538142809775,"cycle":0.02150298906171333,"orig":4.371656803342691,"zero":0},
{"x":125,"trend":4.356857870782874,"cycle":0.020323293537384046,"orig":4.377181164320258,"zero":0},
{"x":126,"trend":4.356997148761314,"cycle":0.024769452106707668,"orig":4.381766600868022,"zero":0},
{"x":127,"trend":4.367701929393275,"cycle":0.022570614134457934,"orig":4.3902725435277326,"zero":0},
{"x":128,"trend":4.376034539364212,"cycle":0.024192950257106105,"orig":4.400227489621318,"zero":0},
{"x":129,"trend":4.377259398177133,"cycle":0.03208566690075898,"orig":4.409345065077892,"zero":0},
{"x":130,"trend":4.390302492488036,"cycle":0.02787042257185135,"orig":4.418172915059888,"zero":0},
{"x":131,"trend":4.398565197492338,"cycle":0.027452006462578282,"orig":4.426017203954916,"zero":0},
{"x":132,"trend":4.397688869720189,"cycle":0.03257777781764393,"orig":4.430266647537833,"zero":0},
{"x":133,"trend":4.398610602939575,"cycle":0.03602982887420403,"orig":4.434640431813779,"zero":0},
{"x":134,"trend":4.40312752135826,"cycle":0.033130400073787314,"orig":4.4362579214320474,"zero":0},
{"x":135,"trend":4.415900598084298,"cycle":0.020708914359874875,"orig":4.436609512444173,"zero":0},
{"x":136,"trend":4.429403286478465,"cycle":0.010631609146321885,"orig":4.440034895624787,"zero":0},
{"x":137,"trend":4.441334466052317,"cycle":0.00527014210588117,"orig":4.446604608158198,"zero":0},
{"x":138,"trend":4.45003403181386,"cycle":-0.00944607894180649,"orig":4.440587952872053,"zero":0},
{"x":139,"trend":4.456427163418391,"cycle":-0.01969219723985205,"orig":4.436734966178539,"zero":0},
{"x":140,"trend":4.457271168430966,"cycle":-4.430119414866596e-5,"orig":4.457226867236817,"zero":0},
{"x":141,"trend":4.458161235922209,"cycle":-0.0014666966003531456,"orig":4.456694539321856,"zero":0},
{"x":142,"trend":4.455956146444452,"cycle":0.00755139197225585,"orig":4.4635075384167076,"zero":0},
{"x":143,"trend":4.453268909855075,"cycle":0.009480201397099819,"orig":4.462749111252175,"zero":0},
{"x":144,"trend":4.456069473346901,"cycle":0.0111997874987253,"orig":4.467269260845626,"zero":0},
{"x":145,"trend":4.466460664139602,"cycle":0.005119841811002779,"orig":4.471580505950604,"zero":0},
{"x":146,"trend":4.4565016112356375,"cycle":0.02114197436531473,"orig":4.477643585600952,"zero":0},
{"x":147,"trend":4.4455920993149505,"cycle":0.03431753897544709,"orig":4.479909638290398,"zero":0},
{"x":148,"trend":4.476565144069943,"cycle":0.005640480311960516,"orig":4.482205624381904,"zero":0},
{"x":149,"trend":4.483336872553238,"cycle":0.0051713990870512205,"orig":4.488508271640289,"zero":0},
{"x":150,"trend":4.491750641786119,"cycle":-0.004027048057838378,"orig":4.487723593728281,"zero":0},
{"x":151,"trend":4.479855527402233,"cycle":0.013637568644059073,"orig":4.493493096046292,"zero":0},
{"x":152,"trend":4.485859896432529,"cycle":0.01164044277738796,"orig":4.497500339209917,"zero":0},
{"x":153,"trend":4.489954374891457,"cycle":0.0035007032730067777,"orig":4.493455078164464,"zero":0},
{"x":154,"trend":4.500002564342205,"cycle":0.005601397721058277,"orig":4.5056039620632635,"zero":0},
{"x":155,"trend":4.50104371712381,"cycle":0.00939592104087783,"orig":4.510439638164688,"zero":0},
{"x":156,"trend":4.501228189076524,"cycle":0.016894982923311375,"orig":4.518123171999835,"zero":0},
{"x":157,"trend":4.5079620052226295,"cycle":0.008792181391891418,"orig":4.516754186614521,"zero":0},
{"x":158,"trend":4.505787702833312,"cycle":0.014084909492199316,"orig":4.5198726123255115,"zero":0},
{"x":159,"trend":4.512345051828816,"cycle":0.011076973026375114,"orig":4.523422024855191,"zero":0},
{"x":160,"trend":4.516435056855958,"cycle":0.012921549410280342,"orig":4.529356606266238,"zero":0},
{"x":161,"trend":4.509418292521461,"cycle":0.02264234579818325,"orig":4.532060638319645,"zero":0},
{"x":162,"trend":4.524570168289841,"cycle":0.00788092675618568,"orig":4.532451095046027,"zero":0},
{"x":163,"trend":4.533160790995464,"cycle":-0.002662428403025885,"orig":4.530498362592438,"zero":0},
{"x":164,"trend":4.546010495149573,"cycle":-0.01823876594988949,"orig":4.527771729199683,"zero":0},
{"x":165,"trend":4.536754378527916,"cycle":-0.004378566303351761,"orig":4.532375812224564,"zero":0},
{"x":166,"trend":4.53702733637759,"cycle":-0.008544908870733003,"orig":4.528482427506857,"zero":0},
{"x":167,"trend":4.5392858036542,"cycle":-0.010523771672497517,"orig":4.528762031981702,"zero":0},
{"x":168,"trend":4.549696313281018,"cycle":-0.024202652019623017,"orig":4.525493661261395,"zero":0},
{"x":169,"trend":4.5524382226002365,"cycle":-0.0317154306897649,"orig":4.5207227919104715,"zero":0},
{"x":170,"trend":4.550010327886635,"cycle":-0.03582230111053342,"orig":4.514188026776101,"zero":0},
{"x":171,"trend":4.5427499055256195,"cycle":-0.03061429050476061,"orig":4.512135615020859,"zero":0},
{"x":172,"trend":4.536271359062554,"cycle":-0.02773212471403408,"orig":4.50853923434852,"zero":0},
{"x":173,"trend":4.543710899503733,"cycle":-0.03995900994084334,"orig":4.503751889562889,"zero":0},
{"x":174,"trend":4.539789315549193,"cycle":-0.041331669903641455,"orig":4.498457645645551,"zero":0},
{"x":175,"trend":4.5400895158798455,"cycle":-0.04805667350574705,"orig":4.4920328423740985,"zero":0},
{"x":176,"trend":4.533014467205795,"cycle":-0.04213006439678679,"orig":4.490884402809008,"zero":0},
{"x":177,"trend":4.5267862030251464,"cycle":-0.04097967622090248,"orig":4.485806526804244,"zero":0},
{"x":178,"trend":4.515856079027639,"cycle":-0.03279477167773681,"orig":4.483061307349902,"zero":0},
{"x":179,"trend":4.514482655880923,"cycle":-0.03748680861633957,"orig":4.476995847264583,"zero":0},
{"x":180,"trend":4.51256088421149,"cycle":-0.03599254675430785,"orig":4.4765683374571825,"zero":0},
{"x":181,"trend":4.508349832620885,"cycle":-0.025148430322532,"orig":4.483201402298353,"zero":0},
{"x":182,"trend":4.500898002190068,"cycle":-0.01758137520910541,"orig":4.483316626980963,"zero":0},
{"x":183,"trend":4.4926786251085336,"cycle":-0.0021496654326478293,"orig":4.490528959675886,"zero":0},
{"x":184,"trend":4.493824260079716,"cycle":0.0015757017618485136,"orig":4.4953999618415645,"zero":0},
{"x":185,"trend":4.489869282731504,"cycle":0.009540307577421636,"orig":4.499409590308925,"zero":0},
{"x":186,"trend":4.488519417081102,"cycle":0.019105192464270893,"orig":4.507624609545373,"zero":0},
{"x":187,"trend":4.479952866452047,"cycle":0.027349772453826304,"orig":4.507302638905873,"zero":0},
{"x":188,"trend":4.48189374485865,"cycle":0.02429774052365996,"orig":4.50619148538231,"zero":0},
{"x":189,"trend":4.495870403288123,"cycle":0.01116973079078587,"orig":4.507040134078909,"zero":0},
{"x":190,"trend":4.5007183729265945,"cycle":0.004236924815379517,"orig":4.504955297741974,"zero":0},
{"x":191,"trend":4.511298938396757,"cycle":-0.0007570647374643968,"orig":4.510541873659292,"zero":0},
{"x":192,"trend":4.5166352540236465,"cycle":-0.011670007655273373,"orig":4.504965246368373,"zero":0},
{"x":193,"trend":4.5222114138277885,"cycle":-0.008760761735516098,"orig":4.513450652092272,"zero":0},
{"x":194,"trend":4.531079863739245,"cycle":-0.01644179071904528,"orig":4.514638073020199,"zero":0},
{"x":195,"trend":4.528048847507752,"cycle":-0.01604274583518084,"orig":4.512006101672571,"zero":0},
{"x":196,"trend":4.521835730751554,"cycle":-0.015804344388068436,"orig":4.506031386363485,"zero":0},
{"x":197,"trend":4.518394659723983,"cycle":-0.012636052791306973,"orig":4.505758606932676,"zero":0},
{"x":198,"trend":4.5155360610544815,"cycle":-0.008500339410254298,"orig":4.507035721644227,"zero":0},
{"x":199,"trend":4.524886692361812,"cycle":-0.012725835166985888,"orig":4.512160857194826,"zero":0},
{"x":200,"trend":4.516558729064009,"cycle":-0.006582029689157665,"orig":4.509976699374851,"zero":0},
{"x":201,"trend":4.529561219412413,"cycle":-0.013157768335422482,"orig":4.51640345107699,"zero":0},
{"x":202,"trend":4.530997604307553,"cycle":-0.013363296472144626,"orig":4.517634307835408,"zero":0},
{"x":203,"trend":4.527981345949001,"cycle":-0.0036644460643957544,"orig":4.524316899884605,"zero":0},
{"x":204,"trend":4.512484246263622,"cycle":0.012128599650393035,"orig":4.524612845914015,"zero":0},
{"x":205,"trend":4.5110462107898694,"cycle":0.015087261343179392,"orig":4.526133472133049,"zero":0},
{"x":206,"trend":4.516096738509274,"cycle":0.0160510397329352,"orig":4.5321477782422095,"zero":0},
{"x":207,"trend":4.52829953197077,"cycle":-0.00016050957732893778,"orig":4.528139022393441,"zero":0},
{"x":208,"trend":4.525339902013326,"cycle":0.006506619555922022,"orig":4.531846521569248,"zero":0},
{"x":209,"trend":4.533640460014445,"cycle":0.005403812261540075,"orig":4.539044272275985,"zero":0},
{"x":210,"trend":4.534262237734016,"cycle":-0.003050804264218776,"orig":4.531211433469797,"zero":0},
{"x":211,"trend":4.545208059807593,"cycle":-0.0065527466541297485,"orig":4.5386553131534635,"zero":0},
{"x":212,"trend":4.542736910991337,"cycle":-0.0034106311185055915,"orig":4.5393262798728315,"zero":0},
{"x":213,"trend":4.542956758755744,"cycle":-0.0023602945247578333,"orig":4.540596464230986,"zero":0},
{"x":214,"trend":4.549213998462459,"cycle":-0.00012222149424001572,"orig":4.549091776968219,"zero":0},
{"x":215,"trend":4.542987174464942,"cycle":0.008584957954271388,"orig":4.5515721324192135,"zero":0},
{"x":216,"trend":4.546142145199971,"cycle":0.0133662282201783,"orig":4.559508373420149,"zero":0},
{"x":217,"trend":4.556140217554075,"cycle":0.006958234981944145,"orig":4.563098452536019,"zero":0},
{"x":218,"trend":4.545726487489433,"cycle":0.024604811109357527,"orig":4.5703312985987905,"zero":0},
{"x":219,"trend":4.552907782863247,"cycle":0.01607133595592547,"orig":4.568979118819173,"zero":0},
{"x":220,"trend":4.552944739983665,"cycle":0.018184574279330512,"orig":4.571129314262995,"zero":0},
{"x":221,"trend":4.557862694440682,"cycle":0.014166340349165196,"orig":4.572029034789847,"zero":0},
{"x":222,"trend":4.567654308853497,"cycle":0.00886225509381422,"orig":4.576516563947311,"zero":0},
{"x":223,"trend":4.572401461568111,"cycle":0.0009436360909829133,"orig":4.573345097659094,"zero":0},
{"x":224,"trend":4.583117146812348,"cycle":-0.0065182608066916,"orig":4.576598886005656,"zero":0},
{"x":225,"trend":4.584794105807677,"cycle":-0.027759048571566858,"orig":4.55703505723611,"zero":0},
{"x":226,"trend":4.593957930102961,"cycle":-0.02485854345964089,"orig":4.5690993866433205,"zero":0},
{"x":227,"trend":4.587397732041,"cycle":-0.007120828776185029,"orig":4.580276903264815,"zero":0},
{"x":228,"trend":4.586901187308352,"cycle":-0.001472590479305147,"orig":4.585428596829047,"zero":0},
{"x":229,"trend":4.584878604890031,"cycle":0.0021265921399313825,"orig":4.587005197029963,"zero":0},
{"x":230,"trend":4.5927030917391205,"cycle":-0.005276394528819672,"orig":4.587426697210301,"zero":0},
{"x":231,"trend":4.586700614242108,"cycle":0.0029781976279386058,"orig":4.589678811870047,"zero":0},
{"x":232,"trend":4.589968630646137,"cycle":0.0027422596671806687,"orig":4.592710890313318,"zero":0},
{"x":233,"trend":4.556288627616053,"cycle":0.03667637725367623,"orig":4.592965004869729,"zero":0},
{"x":234,"trend":4.574203771682627,"cycle":0.021922642403526815,"orig":4.596126414086154,"zero":0},
{"x":235,"trend":4.597500072444352,"cycle":-0.001886404863729929,"orig":4.595613667580622,"zero":0},
{"x":236,"trend":4.6161520613739775,"cycle":-0.01615925491502157,"orig":4.599992806458956,"zero":0},
{"x":237,"trend":4.609871089458183,"cycle":-0.01154124535616674,"orig":4.598329844102016,"zero":0},
{"x":238,"trend":4.6030984010050995,"cycle":-0.005916032859209608,"orig":4.59718236814589,"zero":0},
{"x":239,"trend":4.60352881026178,"cycle":-0.006766874744227103,"orig":4.596761935517553,"zero":0},
{"x":240,"trend":4.607887394170127,"cycle":-0.0009837115558841703,"orig":4.606903682614242,"zero":0},
{"x":241,"trend":4.6079928681811495,"cycle":-0.004478051561223495,"orig":4.603514816619926,"zero":0},
{"x":242,"trend":4.611222254798073,"cycle":0.0016710311295273783,"orig":4.6128932859276,"zero":0},
{"x":243,"trend":4.6090579638927185,"cycle":0.005613937484184817,"orig":4.614671901376903,"zero":0},
{"x":244,"trend":4.615304762273751,"cycle":0.006067459004905018,"orig":4.621372221278656,"zero":0},
{"x":245,"trend":4.611541774751846,"cycle":0.010786368001620694,"orig":4.622328142753466,"zero":0},
{"x":246,"trend":4.608607659304748,"cycle":0.01429733123242638,"orig":4.622904990537174,"zero":0},
{"x":247,"trend":4.605605543799796,"cycle":0.016099190027385468,"orig":4.6217047338271815,"zero":0},
{"x":248,"trend":4.623563018401626,"cycle":6.575481040460573e-5,"orig":4.6236287732120305,"zero":0},
{"x":249,"trend":4.620321658254047,"cycle":0.005527241742401046,"orig":4.625848899996448,"zero":0},
{"x":250,"trend":4.633072911415352,"cycle":-0.01004807263341867,"orig":4.623024838781934,"zero":0},
{"x":251,"trend":4.632461256451929,"cycle":-0.00411570587328125,"orig":4.628345550578648,"zero":0},
{"x":252,"trend":4.643498522586081,"cycle":-0.014804211301120418,"orig":4.628694311284961,"zero":0}];
    const series = [{"name":"Cycle","color":"#2ca02c","key":"cycle","dash":""}];
    const bands = [];
    const refLines = [{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#filt_cy_64');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Cycle') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Cycle');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>