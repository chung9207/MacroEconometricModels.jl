<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Panel VAR · MacroEconometricModels.jl</title><meta name="title" content="Panel VAR · MacroEconometricModels.jl"/><meta property="og:title" content="Panel VAR · MacroEconometricModels.jl"/><meta property="twitter:title" content="Panel VAR · MacroEconometricModels.jl"/><meta name="description" content="Documentation for MacroEconometricModels.jl."/><meta property="og:description" content="Documentation for MacroEconometricModels.jl."/><meta property="twitter:description" content="Documentation for MacroEconometricModels.jl."/><meta property="og:url" content="https://FriedmanJP.github.io/MacroEconometricModels.jl/pvar/"/><meta property="twitter:url" content="https://FriedmanJP.github.io/MacroEconometricModels.jl/pvar/"/><link rel="canonical" href="https://FriedmanJP.github.io/MacroEconometricModels.jl/pvar/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../assets/theme-toggle.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MacroEconometricModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../data/">Data Management</a></li><li><span class="tocitem">Univariate Models</span><ul><li><a class="tocitem" href="../filters/">Time Series Filters</a></li><li><a class="tocitem" href="../arima/">ARIMA</a></li><li><a class="tocitem" href="../volatility/">Volatility Models</a></li></ul></li><li><span class="tocitem">Multivariate Models</span><ul><li><a class="tocitem" href="../manual/">VAR</a></li><li><a class="tocitem" href="../bayesian/">Bayesian VAR</a></li><li><a class="tocitem" href="../vecm/">VECM</a></li><li><a class="tocitem" href="../lp/">Local Projections</a></li><li><a class="tocitem" href="../factormodels/">Factor Models</a></li></ul></li><li><span class="tocitem">Panel Models</span><ul><li class="is-active"><a class="tocitem" href>Panel VAR</a><ul class="internal"><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Model-Specification"><span>Model Specification</span></a></li><li><a class="tocitem" href="#Panel-Data-Preparation"><span>Panel Data Preparation</span></a></li><li><a class="tocitem" href="#GMM-Estimation"><span>GMM Estimation</span></a></li><li><a class="tocitem" href="#Fixed-Effects-OLS"><span>Fixed-Effects OLS</span></a></li><li><a class="tocitem" href="#Structural-Analysis"><span>Structural Analysis</span></a></li><li><a class="tocitem" href="#Bootstrap-Confidence-Intervals"><span>Bootstrap Confidence Intervals</span></a></li><li><a class="tocitem" href="#Specification-Tests"><span>Specification Tests</span></a></li><li><a class="tocitem" href="#Lag-Selection"><span>Lag Selection</span></a></li><li><a class="tocitem" href="#Complete-Example"><span>Complete Example</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../innovation_accounting/">Innovation Accounting</a></li><li><a class="tocitem" href="../nowcast/">Nowcasting</a></li><li><a class="tocitem" href="../nongaussian/">Statistical Identification</a></li><li><a class="tocitem" href="../hypothesis_tests/">Hypothesis Tests</a></li><li><a class="tocitem" href="../plotting/">Visualization</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api/">Overview</a></li><li><a class="tocitem" href="../api_types/">Types</a></li><li><a class="tocitem" href="../api_functions/">Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Panel Models</a></li><li class="is-active"><a href>Panel VAR</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Panel VAR</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FriedmanJP/MacroEconometricModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FriedmanJP/MacroEconometricModels.jl/blob/main/docs/src/pvar.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Panel-VAR"><a class="docs-heading-anchor" href="#Panel-VAR">Panel VAR</a><a id="Panel-VAR-1"></a><a class="docs-heading-anchor-permalink" href="#Panel-VAR" title="Permalink"></a></h1><p>This page documents the Panel VAR (PVAR) implementation in <strong>MacroEconometricModels.jl</strong>, providing estimation via GMM (Arellano-Bond first-difference and Blundell-Bond system) and fixed-effects OLS.</p><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><pre><code class="language-julia hljs">using MacroEconometricModels

# Load Penn World Table: 38 OECD countries, 1950–2023
pwt = load_example(:pwt)

# Convert to growth rates (log first difference) for stationarity
pd = apply_tcode(pwt, 5)

# FD-GMM (Arellano-Bond) — GDP, employment, human capital growth spillovers
model = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;], steps=:twostep)

# System GMM (Blundell-Bond)
model_sys = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;],
                          system_instruments=true, steps=:twostep)

# Fixed-effects OLS
model_fe = estimate_pvar_feols(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;])</code></pre><hr/><h2 id="Model-Specification"><a class="docs-heading-anchor" href="#Model-Specification">Model Specification</a><a id="Model-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Specification" title="Permalink"></a></h2><p>The Panel VAR(p) model for entity <span>$i$</span> at time <span>$t$</span> is:</p><p class="math-container">\[\mathbf{y}_{i,t} = \boldsymbol{\mu}_i + \sum_{l=1}^{p} \mathbf{A}_l \mathbf{y}_{i,t-l} + \boldsymbol{\varepsilon}_{i,t}, \quad i = 1, \ldots, N, \quad t = 1, \ldots, T_i\]</p><p>where:</p><ul><li><span>$\mathbf{y}_{i,t} \in \mathbb{R}^m$</span> is the vector of endogenous variables for entity <span>$i$</span></li><li><span>$\boldsymbol{\mu}_i \in \mathbb{R}^m$</span> is an entity-specific <strong>fixed effect</strong></li><li><span>$\mathbf{A}_l$</span> is the <span>$m \times m$</span> coefficient matrix for lag <span>$l$</span></li><li><span>$\boldsymbol{\varepsilon}_{i,t} \sim (0, \Sigma)$</span> are i.i.d. innovations</li></ul><p>The key econometric challenge is that <span>$\boldsymbol{\mu}_i$</span> is correlated with <span>$\mathbf{y}_{i,t-l}$</span> by construction. OLS on the level equation is inconsistent. Two strategies are available:</p><ol><li><strong>Transform away the fixed effect</strong> (first-differencing or forward orthogonal deviations) and estimate by GMM using lagged levels as instruments.</li><li><strong>Demean within groups</strong> (within estimator) and estimate by OLS. This is consistent for large <span>$T$</span> but Nickell-biased when <span>$T$</span> is small relative to <span>$N$</span>.</li></ol><div class="admonition is-info" id="Fixed-Effects-and-Nickell-Bias-9e0890c2083b7974"><header class="admonition-header">Fixed Effects and Nickell Bias<a class="admonition-anchor" href="#Fixed-Effects-and-Nickell-Bias-9e0890c2083b7974" title="Permalink"></a></header><div class="admonition-body"><p>The within estimator (FE-OLS) is biased of order <span>$O(1/T)$</span> in dynamic panels (Nickell, 1981). For panels with small <span>$T$</span> (e.g., <span>$T &lt; 20$</span>), GMM estimation is strongly preferred. For larger <span>$T$</span>, FE-OLS and GMM converge.</p></div></div><hr/><h2 id="Panel-Data-Preparation"><a class="docs-heading-anchor" href="#Panel-Data-Preparation">Panel Data Preparation</a><a id="Panel-Data-Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Panel-Data-Preparation" title="Permalink"></a></h2><p>Panel VAR estimation requires a <code>PanelData</code> object. The built-in Penn World Table provides a balanced panel of 38 OECD countries:</p><pre><code class="language-julia hljs">using MacroEconometricModels

# Load PWT — already a PanelData object
pwt = load_example(:pwt)
println(ngroups(pwt), &quot; countries × &quot;, nvars(pwt), &quot; variables&quot;)

# Convert to growth rates for stationarity
pd = apply_tcode(pwt, 5)  # tcode 5 = log first difference</code></pre><p>All numeric columns are treated as potential endogenous variables. Use the <code>dependent_vars</code> keyword to select a subset:</p><pre><code class="language-julia hljs">model = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;])</code></pre><hr/><h2 id="GMM-Estimation"><a class="docs-heading-anchor" href="#GMM-Estimation">GMM Estimation</a><a id="GMM-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#GMM-Estimation" title="Permalink"></a></h2><h3 id="First-Difference-GMM-(Arellano-Bond)"><a class="docs-heading-anchor" href="#First-Difference-GMM-(Arellano-Bond)">First-Difference GMM (Arellano-Bond)</a><a id="First-Difference-GMM-(Arellano-Bond)-1"></a><a class="docs-heading-anchor-permalink" href="#First-Difference-GMM-(Arellano-Bond)" title="Permalink"></a></h3><p>The default estimator transforms the model by first-differencing to remove <span>$\boldsymbol{\mu}_i$</span>:</p><p class="math-container">\[\Delta \mathbf{y}_{i,t} = \sum_{l=1}^{p} \mathbf{A}_l \Delta \mathbf{y}_{i,t-l} + \Delta \boldsymbol{\varepsilon}_{i,t}\]</p><p>Lagged <strong>levels</strong> <span>$\mathbf{y}_{i,t-2}, \mathbf{y}_{i,t-3}, \ldots$</span> serve as instruments for <span>$\Delta \mathbf{y}_{i,t-l}$</span> (Holtz-Eakin, Newey &amp; Rosen, 1988; Arellano &amp; Bond, 1991). The instrument matrix is block-diagonal, with the number of instruments growing with <span>$t$</span>.</p><pre><code class="language-julia hljs"># One-step GMM (heteroskedasticity-robust SEs)
m1 = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;], steps=:onestep)

# Two-step GMM (Windmeijer-corrected SEs)
m2 = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;], steps=:twostep)

# Forward orthogonal deviations (Arellano &amp; Bover, 1995)
m3 = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;],
                   transformation=:fod, steps=:twostep)</code></pre><div class="admonition is-info" id="One-Step-vs-Two-Step-58e0a8ff17515e3a"><header class="admonition-header">One-Step vs Two-Step<a class="admonition-anchor" href="#One-Step-vs-Two-Step-58e0a8ff17515e3a" title="Permalink"></a></header><div class="admonition-body"><p>The two-step estimator is asymptotically efficient but its naive standard errors are severely downward-biased in finite samples. The package automatically applies the Windmeijer (2005) correction for two-step GMM, which restores proper inference.</p></div></div><h3 id="System-GMM-(Blundell-Bond)"><a class="docs-heading-anchor" href="#System-GMM-(Blundell-Bond)">System GMM (Blundell-Bond)</a><a id="System-GMM-(Blundell-Bond)-1"></a><a class="docs-heading-anchor-permalink" href="#System-GMM-(Blundell-Bond)" title="Permalink"></a></h3><p>System GMM adds level equations instrumented by lagged <strong>differences</strong>, improving efficiency when the data are persistent (Blundell &amp; Bond, 1998):</p><pre><code class="language-julia hljs">m_sys = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;],
                      system_instruments=true, steps=:twostep)</code></pre><p>The system estimator stacks transformed equations (instrumented by lagged levels) with level equations (instrumented by lagged differences). This exploits additional moment conditions but requires the assumption that first differences are uncorrelated with fixed effects.</p><h3 id="Instrument-Management"><a class="docs-heading-anchor" href="#Instrument-Management">Instrument Management</a><a id="Instrument-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Instrument-Management" title="Permalink"></a></h3><p>When the number of instruments is large relative to <span>$N$</span>, standard errors can be unreliable. Several options control instrument proliferation:</p><pre><code class="language-julia hljs"># Restrict instrument lags
m = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;],
                  min_lag_endo=2, max_lag_endo=4)

# Collapse instruments (one column per lag distance)
m = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;], collapse=true)

# PCA instrument reduction
m = estimate_pvar(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;], pca_instruments=true)</code></pre><div class="admonition is-warning" id="Instrument-Proliferation-ac2b3c8e125a9636"><header class="admonition-header">Instrument Proliferation<a class="admonition-anchor" href="#Instrument-Proliferation-ac2b3c8e125a9636" title="Permalink"></a></header><div class="admonition-body"><p>A rule of thumb: the number of instruments should not exceed <span>$N$</span> (the number of groups). When it does, consider collapsing instruments or restricting lag depth.</p></div></div><hr/><h2 id="Fixed-Effects-OLS"><a class="docs-heading-anchor" href="#Fixed-Effects-OLS">Fixed-Effects OLS</a><a id="Fixed-Effects-OLS-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed-Effects-OLS" title="Permalink"></a></h2><p>For panels with large <span>$T$</span>, the within (FE-OLS) estimator provides a simpler alternative:</p><pre><code class="language-julia hljs">m_fe = estimate_pvar_feols(pd, 2; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;])</code></pre><p>The estimator demeans each country&#39;s data (removing <span>$\boldsymbol{\mu}_i$</span>) and runs pooled OLS on the stacked system. Standard errors are clustered at the group level.</p><hr/><h2 id="Structural-Analysis"><a class="docs-heading-anchor" href="#Structural-Analysis">Structural Analysis</a><a id="Structural-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Structural-Analysis" title="Permalink"></a></h2><h3 id="Orthogonalized-Impulse-Response-Functions"><a class="docs-heading-anchor" href="#Orthogonalized-Impulse-Response-Functions">Orthogonalized Impulse Response Functions</a><a id="Orthogonalized-Impulse-Response-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Orthogonalized-Impulse-Response-Functions" title="Permalink"></a></h3><p>OIRF uses the Cholesky decomposition of the residual covariance <span>$\Sigma = PP&#39;$</span>:</p><pre><code class="language-julia hljs">irfs = pvar_oirf(model, 20)   # 20-period horizon
# irfs[h+1] is m × m: response of variable i to shock j at horizon h</code></pre><p>The impulse responses are computed from the companion form <span>$\Phi_h = J A^h J&#39;$</span> and the Cholesky factor <span>$P$</span>:</p><p class="math-container">\[\Psi_h = \Phi_h P\]</p><h3 id="Generalized-Impulse-Response-Functions"><a class="docs-heading-anchor" href="#Generalized-Impulse-Response-Functions">Generalized Impulse Response Functions</a><a id="Generalized-Impulse-Response-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Generalized-Impulse-Response-Functions" title="Permalink"></a></h3><p>GIRF (Pesaran &amp; Shin, 1998) does not depend on variable ordering:</p><pre><code class="language-julia hljs">girfs = pvar_girf(model, 20)</code></pre><p class="math-container">\[\text{GIRF}_h(\mathbf{e}_j) = \frac{\Phi_h \Sigma \mathbf{e}_j}{\sqrt{\sigma_{jj}}}\]</p><h3 id="Forecast-Error-Variance-Decomposition"><a class="docs-heading-anchor" href="#Forecast-Error-Variance-Decomposition">Forecast Error Variance Decomposition</a><a id="Forecast-Error-Variance-Decomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Forecast-Error-Variance-Decomposition" title="Permalink"></a></h3><p>FEVD based on the orthogonalized IRF:</p><pre><code class="language-julia hljs">decomp = pvar_fevd(model, 20)
# decomp[h+1] is m × m: share of FEV of variable i due to shock j at horizon h</code></pre><p>Each row sums to 1 (100% of forecast error variance accounted for).</p><h3 id="Stability-Analysis"><a class="docs-heading-anchor" href="#Stability-Analysis">Stability Analysis</a><a id="Stability-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Stability-Analysis" title="Permalink"></a></h3><p>Check whether all eigenvalues of the companion matrix lie inside the unit circle:</p><pre><code class="language-julia hljs">stab = pvar_stability(model)
stab.is_stable      # true if all |λ| &lt; 1
stab.moduli          # moduli of eigenvalues</code></pre><hr/><h2 id="Bootstrap-Confidence-Intervals"><a class="docs-heading-anchor" href="#Bootstrap-Confidence-Intervals">Bootstrap Confidence Intervals</a><a id="Bootstrap-Confidence-Intervals-1"></a><a class="docs-heading-anchor-permalink" href="#Bootstrap-Confidence-Intervals" title="Permalink"></a></h2><p>Group-level block bootstrap preserves the within-group time structure:</p><pre><code class="language-julia hljs">boot = pvar_bootstrap_irf(model, 20;
    irf_type=:oirf,   # or :girf
    n_draws=500,
    ci=0.95
)
# boot.lower[h+1], boot.upper[h+1] are m × m CI bounds</code></pre><p>For each bootstrap draw, <span>$N$</span> groups are resampled with replacement, the PVAR is re-estimated, and IRFs are computed. Quantile-based confidence intervals are constructed from the bootstrap distribution.</p><hr/><h2 id="Specification-Tests"><a class="docs-heading-anchor" href="#Specification-Tests">Specification Tests</a><a id="Specification-Tests-1"></a><a class="docs-heading-anchor-permalink" href="#Specification-Tests" title="Permalink"></a></h2><h3 id="Hansen-J-Test"><a class="docs-heading-anchor" href="#Hansen-J-Test">Hansen J-Test</a><a id="Hansen-J-Test-1"></a><a class="docs-heading-anchor-permalink" href="#Hansen-J-Test" title="Permalink"></a></h3><p>The Hansen (1982) J-test evaluates whether the overidentifying restrictions (moment conditions) are valid:</p><pre><code class="language-julia hljs">j = pvar_hansen_j(model)
j.statistic     # J-statistic
j.pvalue        # p-value (χ² distribution)
j.df            # degrees of freedom = instruments - parameters</code></pre><p>Under <span>$H_0$</span>: all moment conditions are valid. Rejection suggests instrument invalidity or model misspecification.</p><div class="admonition is-warning" id="J-Test-and-Instrument-Count-70fdf11805d3a8a4"><header class="admonition-header">J-Test and Instrument Count<a class="admonition-anchor" href="#J-Test-and-Instrument-Count-70fdf11805d3a8a4" title="Permalink"></a></header><div class="admonition-body"><p>The J-test has low power when the number of instruments is large relative to <span>$N$</span>. A non-rejection does not necessarily validate the instruments.</p></div></div><h3 id="Andrews-Lu-MMSC"><a class="docs-heading-anchor" href="#Andrews-Lu-MMSC">Andrews-Lu MMSC</a><a id="Andrews-Lu-MMSC-1"></a><a class="docs-heading-anchor-permalink" href="#Andrews-Lu-MMSC" title="Permalink"></a></h3><p>Andrews-Lu (2001) Model and Moment Selection Criteria extend information criteria to GMM settings:</p><pre><code class="language-julia hljs">mmsc = pvar_mmsc(model)
mmsc.bic     # MMSC-BIC
mmsc.aic     # MMSC-AIC
mmsc.hqic    # MMSC-HQIC</code></pre><p class="math-container">\[\text{MMSC-BIC} = J - (c - b) \ln(n), \quad
\text{MMSC-AIC} = J - 2(c - b)\]</p><p>where <span>$c$</span> = number of instruments, <span>$b$</span> = number of parameters, <span>$n$</span> = observations. Lower values are preferred.</p><hr/><h2 id="Lag-Selection"><a class="docs-heading-anchor" href="#Lag-Selection">Lag Selection</a><a id="Lag-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Lag-Selection" title="Permalink"></a></h2><p>Select the optimal lag order by comparing MMSC criteria across candidate models:</p><pre><code class="language-julia hljs">sel = pvar_lag_selection(pd, 4; dependent_vars=[&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;])
sel.best_bic    # optimal lag by BIC
sel.best_aic    # optimal lag by AIC
sel.best_hqic   # optimal lag by HQIC
sel.table       # comparison table</code></pre><hr/><h2 id="Complete-Example"><a class="docs-heading-anchor" href="#Complete-Example">Complete Example</a><a id="Complete-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using MacroEconometricModels

# Load Penn World Table and convert to growth rates
pwt = load_example(:pwt)
pd = apply_tcode(pwt, 5)  # log first difference → growth rates
dep_vars = [&quot;rgdpna&quot;, &quot;emp&quot;, &quot;hc&quot;]

# Estimate via two-step FD-GMM: cross-country growth spillovers
model = estimate_pvar(pd, 1; dependent_vars=dep_vars, steps=:twostep)

# Specification tests
j = pvar_hansen_j(model)
println(&quot;Hansen J: stat=$(round(j.statistic, digits=3)), p=$(round(j.pvalue, digits=3))&quot;)

# Stability
stab = pvar_stability(model)
println(&quot;Stable: $(stab.is_stable)&quot;)

# Structural analysis: orthogonalized IRFs for GDP → employment → human capital
irfs = pvar_oirf(model, 10)
decomp = pvar_fevd(model, 10)

# Bootstrap confidence intervals
using Random; Random.seed!(42)
boot = pvar_bootstrap_irf(model, 10; n_draws=200, ci=0.90)

# Lag selection
sel = pvar_lag_selection(pd, 3; dependent_vars=dep_vars)
println(&quot;Best lag (BIC): $(sel.best_bic)&quot;)

# References
refs(model)</code></pre><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Arellano, Manuel, and Stephen Bond. 1991. &quot;Some Tests of Specification for Panel Data.&quot; <em>Review of Economic Studies</em> 58 (2): 277–297. <a href="https://doi.org/10.2307/2297968">https://doi.org/10.2307/2297968</a></li><li>Andrews, Donald W. K., and Biao Lu. 2001. &quot;Consistent Model and Moment Selection Procedures for GMM Estimation.&quot; <em>Journal of Econometrics</em> 101 (1): 123–164. <a href="https://doi.org/10.1016/S0304-4076(00)00077-4">https://doi.org/10.1016/S0304-4076(00)00077-4</a></li><li>Blundell, Richard, and Stephen Bond. 1998. &quot;Initial Conditions and Moment Restrictions in Dynamic Panel Data Models.&quot; <em>Journal of Econometrics</em> 87 (1): 115–143. <a href="https://doi.org/10.1016/S0304-4076(98)00009-8">https://doi.org/10.1016/S0304-4076(98)00009-8</a></li><li>Hansen, Lars Peter. 1982. &quot;Large Sample Properties of Generalized Method of Moments Estimators.&quot; <em>Econometrica</em> 50 (4): 1029–1054. <a href="https://doi.org/10.2307/1912775">https://doi.org/10.2307/1912775</a></li><li>Holtz-Eakin, Douglas, Whitney Newey, and Harvey S. Rosen. 1988. &quot;Estimating Vector Autoregressions with Panel Data.&quot; <em>Econometrica</em> 56 (6): 1371–1395. <a href="https://doi.org/10.2307/1913103">https://doi.org/10.2307/1913103</a></li><li>Pesaran, M. Hashem, and Yongcheol Shin. 1998. &quot;Generalized Impulse Response Analysis in Linear Multivariate Models.&quot; <em>Economics Letters</em> 58 (1): 17–29. <a href="https://doi.org/10.1016/S0165-1765(97)00214-0">https://doi.org/10.1016/S0165-1765(97)00214-0</a></li><li>Windmeijer, Frank. 2005. &quot;A Finite Sample Correction for the Variance of Linear Efficient Two-Step GMM Estimators.&quot; <em>Journal of Econometrics</em> 126 (1): 25–51. <a href="https://doi.org/10.1016/j.jeconom.2004.02.005">https://doi.org/10.1016/j.jeconom.2004.02.005</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../factormodels/">« Factor Models</a><a class="docs-footer-nextpage" href="../innovation_accounting/">Innovation Accounting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 20 February 2026 19:11">Friday 20 February 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
