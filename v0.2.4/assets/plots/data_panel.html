<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Penn World Table 10.01, OECD Countries (Feenstra, Inklaar & Timmer 2015)</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(33% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">Penn World Table 10.01, OECD Countries (Feenstra, Inklaar & Timmer 2015)</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">rgdpna</div>
<div id="pd_92"></div>
</div>
<div class="panel">
<div class="panel-title">pop</div>
<div id="pd_93"></div>
</div>
<div class="panel">
<div class="panel-title">emp</div>
<div id="pd_94"></div>
</div>
<div class="panel">
<div class="panel-title">hc</div>
<div id="pd_95"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":1950,"g1":148707.890625,"g2":67078.9296875,"g3":101448.75,"g4":216816.78125,"g5":133874.484375,"g6":null,"g7":49730.36328125,"g8":4156.4208984375,"g9":null,"g10":573505.0625},
{"x":1951,"g1":152490.171875,"g2":71235.234375,"g3":105264.96875,"g4":226292.734375,"g5":144721.203125,"g6":34934.203125,"g7":50900.3203125,"g8":4298.7109375,"g9":null,"g10":629154.75},
{"x":1952,"g1":146248.40625,"g2":70958.046875,"g3":107826.1484375,"g4":245247.203125,"g5":145916.1875,"g6":36610.296875,"g7":54268.15625,"g8":4836.4033203125,"g9":null,"g10":687880.0625},
{"x":1953,"g1":162114.296875,"g2":73289.2265625,"g3":111387.453125,"g4":257327.609375,"g5":151082.1875,"g6":39937.421875,"g7":58528.79296875,"g8":5680.8486328125,"g9":null,"g10":749155.25},
{"x":1954,"g1":175074.5625,"g2":79337.4609375,"g3":116298.125,"g4":254440.046875,"g5":159538.96875,"g6":37714.0703125,"g7":63028.14453125,"g8":5906.3447265625,"g9":null,"g10":807354.8125},
{"x":1955,"g1":181980.1875,"g2":88421.90625,"g3":120430.1875,"g4":277947.1875,"g5":170312.171875,"g6":39610.91796875,"g7":65726.6015625,"g8":6532.6298828125,"g9":null,"g10":905063.8125},
{"x":1956,"g1":182397.890625,"g2":93872.5703125,"g3":124222.96875,"g4":303683.03125,"g5":181600.140625,"g6":39855.56640625,"g7":67412.375,"g8":6449.6201171875,"g9":null,"g10":974961.125},
{"x":1957,"g1":186392.984375,"g2":99323.234375,"g3":126638.6484375,"g4":311403.8125,"g5":188825.171875,"g6":42928.05078125,"g7":67763.21875,"g8":6888.0322265625,"g9":null,"g10":1.0341070625e6},
{"x":1958,"g1":199036.453125,"g2":102957.0078125,"g3":125966.6640625,"g4":316550.96875,"g5":184780.609375,"g6":44931.01953125,"g7":68437.703125,"g8":7691.20947265625,"g9":null,"g10":1.080214625e6},
{"x":1959,"g1":211228.671875,"g2":105985.1484375,"g3":130397.953125,"g4":329418.90625,"g5":196454.671875,"g6":44229.40625,"g7":73020.859375,"g8":7917.64208984375,"g9":null,"g10":1.165148125e6},
{"x":1960,"g1":216140.953125,"g2":115675.21875,"g3":137849.265625,"g4":339713.21875,"g5":210187.734375,"g6":48892.7265625,"g7":77214.6328125,"g8":8574.880859375,"g9":null,"g10":1.265407e6},
{"x":1961,"g1":219088.328125,"g2":121731.515625,"g3":144828.984375,"g4":349327.78125,"g5":227229.984375,"g6":51245.8515625,"g7":81723.546875,"g8":8512.615234375,"g9":null,"g10":1.32867725e6},
{"x":1962,"g1":232842.765625,"g2":124154.03125,"g3":152506.671875,"g4":373364.0625,"g5":238113.484375,"g6":53598.98046875,"g7":85689.84375,"g8":9122.0498046875,"g9":null,"g10":1.391947625e6},
{"x":1963,"g1":248562.109375,"g2":129604.703125,"g3":159137.390625,"g4":392593.125,"g5":249732.375,"g6":56997.94140625,"g7":88255.4375,"g8":9702.181640625,"g9":null,"g10":1.42990975e6},
{"x":1964,"g1":264281.46875,"g2":137477.875,"g3":170304.9375,"g4":418231.875,"g5":262858.78125,"g6":58305.23046875,"g7":95229.9375,"g8":10154.2841796875,"g9":null,"g10":1.518488375e6},
{"x":1965,"g1":270176.1875,"g2":141111.65625,"g3":176237.6875,"g4":445473.03125,"g5":271223.65625,"g6":58828.14453125,"g7":96211.046875,"g8":11273.255859375,"g9":null,"g10":1.60706675e6},
{"x":1966,"g1":286878.0,"g2":148984.84375,"g3":181472.453125,"g4":475919.0,"g5":277897.15625,"g6":65364.609375,"g7":101569.0703125,"g8":11944.5439453125,"g9":null,"g10":1.645029e6},
{"x":1967,"g1":301614.90625,"g2":153829.890625,"g3":188452.171875,"g4":488738.375,"g5":286390.71875,"g6":67456.265625,"g7":105590.2734375,"g8":12621.439453125,"g9":null,"g10":1.645029e6},
{"x":1968,"g1":323228.96875,"g2":160491.8125,"g3":197176.8125,"g4":514377.09375,"g5":296667.53125,"g6":69809.3984375,"g7":112503.65625,"g8":13679.9580078125,"g9":null,"g10":1.7336075e6},
{"x":1969,"g1":346807.96875,"g2":170787.5,"g3":209391.296875,"g4":541618.25,"g5":313378.84375,"g6":72423.984375,"g7":119906.234375,"g8":14443.205078125,"g9":null,"g10":1.86014825e6},
{"x":1970,"g1":360562.40625,"g2":182900.09375,"g3":223350.734375,"g4":556040.0625,"g5":333362.59375,"g6":73992.734375,"g7":128314.8984375,"g8":15526.7939453125,"g9":null,"g10":1.948726625e6},
{"x":1971,"g1":374662.03125,"g2":192252.015625,"g3":231733.125,"g4":578386.4375,"g5":346948.59375,"g6":80618.953125,"g7":135963.40625,"g8":16576.955078125,"g9":null,"g10":2.0097745e6},
{"x":1972,"g1":384476.6875,"g2":204186.734375,"g3":243912.21875,"g4":610311.4375,"g5":358052.6875,"g6":79640.9140625,"g7":146390.640625,"g8":17933.53125,"g9":null,"g10":2.09620175e6},
{"x":1973,"g1":400267.59375,"g2":214165.96875,"g3":258845.296875,"g4":651377.125,"g5":368972.96875,"g6":75208.8828125,"g7":156232.421875,"g8":19315.177734375,"g9":null,"g10":2.1963475e6},
{"x":1974,"g1":405614.21875,"g2":222612.140625,"g3":269715.875,"g4":673248.9375,"g5":374341.1875,"g6":75941.7578125,"g7":165209.140625,"g8":20387.62109375,"g9":null,"g10":2.2158965e6},
{"x":1975,"g1":416113.34375,"g2":221805.609375,"g3":266136.71875,"g4":683653.375,"g5":347077.28125,"g6":66137.5546875,"g7":169047.390625,"g8":20816.6015625,"g9":null,"g10":2.1966905e6},
{"x":1976,"g1":431073.09375,"g2":231957.640625,"g3":281180.8125,"g4":723915.5625,"g5":342205.4375,"g6":68464.2578125,"g7":177040.5625,"g8":21964.2578125,"g9":null,"g10":2.30541025e6},
{"x":1977,"g1":434924.65625,"g2":243741.046875,"g3":282941.34375,"g4":749504.75,"g5":350533.53125,"g6":75214.109375,"g7":184402.8125,"g8":23919.732421875,"g9":null,"g10":2.38257725e6},
{"x":1978,"g1":452540.96875,"g2":243227.59375,"g3":291081.0,"g4":777506.0625,"g5":351967.5,"g6":81394.6953125,"g7":200021.546875,"g8":25418.37109375,"g9":null,"g10":2.454257e6},
{"x":1979,"g1":466278.5625,"g2":256256.578125,"g3":297895.4375,"g4":806469.75,"g5":360736.84375,"g6":88135.3984375,"g7":210780.921875,"g8":26674.6640625,"g9":null,"g10":2.55611775e6},
{"x":1980,"g1":481852.09375,"g2":260693.625,"g3":311134.0625,"g4":824028.125,"g5":377337.84375,"g6":95137.734375,"g7":219396.3125,"g8":26875.2265625,"g9":null,"g10":2.592129e6},
{"x":1981,"g1":497875.53125,"g2":260317.46875,"g3":310265.125,"g4":852169.25,"g5":383380.25,"g6":101048.0703125,"g7":224391.671875,"g8":26267.96875,"g9":null,"g10":2.6058475e6},
{"x":1982,"g1":486801.0,"g2":265553.09375,"g3":312111.15625,"g4":825188.25,"g5":378360.25,"g6":87317.578125,"g7":226519.84375,"g8":24354.279296875,"g9":null,"g10":2.5955585e6},
{"x":1983,"g1":509163.40625,"g2":273448.21875,"g3":313084.4375,"g4":846331.75,"g5":380778.25,"g6":84870.8984375,"g7":230085.171875,"g8":25050.673828125,"g9":null,"g10":2.6363715e6},
{"x":1984,"g1":536039.375,"g2":273588.4375,"g3":320806.3125,"g4":896253.1875,"g5":392233.8125,"g6":89865.9296875,"g7":237794.59375,"g8":27061.859375,"g9":null,"g10":2.71079475e6},
{"x":1985,"g1":557300.5,"g2":280424.53125,"g3":326105.375,"g4":938714.75,"g5":406642.90625,"g6":91634.8671875,"g7":245183.125,"g8":27256.849609375,"g9":null,"g10":2.7739005e6},
{"x":1986,"g1":571565.1875,"g2":286878.21875,"g3":332049.5,"g4":958629.4375,"g5":414200.875,"g6":96762.9609375,"g7":259462.765625,"g8":28763.845703125,"g9":null,"g10":2.83734875e6},
{"x":1987,"g1":604474.9375,"g2":290771.625,"g3":339708.71875,"g4":997664.9375,"g5":420767.9375,"g6":103143.7734375,"g7":273393.15625,"g8":30134.34765625,"g9":null,"g10":2.877133e6},
{"x":1988,"g1":627888.4375,"g2":300355.125,"g3":355753.90625,"g4":1.041670375e6,"g5":434559.0,"g6":110684.921875,"g7":284504.34375,"g8":31170.58203125,"g9":null,"g10":2.983795e6},
{"x":1989,"g1":650350.5625,"g2":312030.125,"g3":368095.59375,"g4":1.066017625e6,"g5":453378.84375,"g6":122373.5,"g7":294217.59375,"g8":32936.63671875,"g9":null,"g10":3.10006025e6},
{"x":1990,"g1":647864.5625,"g2":325589.84375,"g3":379644.25,"g4":1.068181125e6,"g5":470038.875,"g6":126898.3515625,"g7":306815.96875,"g8":34106.578125,"g9":270506.4375,"g10":3.2629685e6},
{"x":1991,"g1":650639.25,"g2":336795.4375,"g3":386603.40625,"g4":1.045844875e6,"g5":465734.1875,"g6":137012.03125,"g7":312957.21875,"g8":34878.1796875,"g9":239087.265625,"g10":3.4296495e6},
{"x":1992,"g1":676968.875,"g2":343846.3125,"g3":392520.96875,"g4":1.055157625e6,"g5":465530.5,"g6":153834.390625,"g7":325616.09375,"g8":38087.359375,"g9":237876.203125,"g10":3.498729e6},
{"x":1993,"g1":703914.875,"g2":345657.75,"g3":388745.375,"g4":1.083200625e6,"g5":464944.0,"g6":164581.671875,"g7":344209.34375,"g8":40790.4921875,"g9":238023.453125,"g10":3.4646755e6},
{"x":1994,"g1":731268.4375,"g2":353960.84375,"g3":401290.125,"g4":1.13188025e6,"g5":470847.65625,"g6":173976.203125,"g7":361926.96875,"g8":42633.828125,"g9":244948.296875,"g10":3.5546735e6},
{"x":1995,"g1":759523.875,"g2":363404.46875,"g3":410859.90625,"g4":1.162241125e6,"g5":473111.8125,"g6":192465.65625,"g7":380756.0,"g8":44404.81640625,"g9":260187.515625,"g10":3.60818575e6},
{"x":1996,"g1":789245.9375,"g2":371456.6875,"g3":416289.15625,"g4":1.181870875e6,"g5":475341.46875,"g6":206734.09375,"g7":388583.8125,"g8":45004.48046875,"g9":271033.65625,"g10":3.645644e6},
{"x":1997,"g1":826050.1875,"g2":379427.53125,"g3":432081.78125,"g4":1.232456875e6,"g5":486090.5,"g6":222015.34375,"g7":401913.40625,"g8":47469.0078125,"g9":269418.71875,"g10":3.71326425e6},
{"x":1998,"g1":867581.375,"g2":392680.46875,"g3":440558.5,"g4":1.280435e6,"g5":500818.90625,"g6":231297.5625,"g7":404203.40625,"g8":50865.55859375,"g9":268359.5,"g10":3.7911005e6},
{"x":1999,"g1":901603.5,"g2":407452.78125,"g3":456166.25,"g4":1.34626225e6,"g5":509146.03125,"g6":230664.65625,"g7":387210.65625,"g8":53009.44140625,"g9":272058.5,"g10":3.87185525e6},
{"x":2000,"g1":919862.0,"g2":420448.625,"g3":473120.625,"g4":1.4154405e6,"g5":529301.6875,"g6":242132.4375,"g7":398536.0,"g8":55060.23046875,"g9":282969.84375,"g10":3.98325825e6},
{"x":2001,"g1":956468.75,"g2":425985.875,"g3":478323.03125,"g4":1.441981375e6,"g5":537641.6875,"g6":249769.375,"g7":405223.03125,"g8":56982.4765625,"g9":291224.6875,"g10":4.0484455e6},
{"x":2002,"g1":986030.875,"g2":432309.0625,"g3":486487.5,"g4":1.485230125e6,"g5":537248.0625,"g6":257768.96875,"g7":415369.71875,"g8":58929.49609375,"g9":295632.25,"g10":4.0392025e6},
{"x":2003,"g1":1.0276836875e6,"g2":437244.15625,"g3":491537.0625,"g4":1.512059125e6,"g5":537074.0,"g6":269944.03125,"g7":431645.03125,"g8":61473.58984375,"g9":305390.59375,"g10":4.017798e6},
{"x":2004,"g1":1.0600985e6,"g2":448460.59375,"g3":509090.875,"g4":1.558817375e6,"g5":551584.125,"g6":287960.8125,"g7":454664.78125,"g8":64193.55078125,"g9":319854.9375,"g10":4.06449925e6},
{"x":2005,"g1":1.089307875e6,"g2":458866.5,"g3":520910.625,"g4":1.6088625e6,"g5":566751.0625,"g6":304769.1875,"g7":476063.84375,"g8":66746.3125,"g9":340245.8125,"g10":4.1004985e6},
{"x":2006,"g1":1.130410875e6,"g2":473868.40625,"g3":534206.0,"g4":1.6513035e6,"g5":589838.375,"g6":323207.71875,"g7":508040.375,"g8":71636.609375,"g9":362780.84375,"g10":4.258603e6},
{"x":2007,"g1":1.170950625e6,"g2":491758.03125,"g3":553848.375,"g4":1.6851535e6,"g5":612938.6875,"g6":339911.84375,"g7":542273.125,"g8":77521.65625,"g9":382693.25,"g10":4.381681e6},
{"x":2008,"g1":1.193111375e6,"g2":498904.78125,"g3":556323.5625,"g4":1.701927625e6,"g5":630149.875,"g6":352792.40625,"g7":560078.4375,"g8":81194.7734375,"g9":392690.25,"g10":4.421572e6},
{"x":2009,"g1":1.21959825e6,"g2":481012.6875,"g3":545717.5625,"g4":1.652315e6,"g5":615673.0,"g6":348848.09375,"g7":566461.3125,"g8":80485.5703125,"g9":373847.65625,"g10":4.17638875e6},
{"x":2010,"g1":1.248954875e6,"g2":489714.15625,"g3":560508.25,"g4":1.703384875e6,"g5":635641.6875,"g6":369261.40625,"g7":591921.8125,"g8":84799.875,"g9":383996.40625,"g10":4.3495735e6},
{"x":2011,"g1":1.297872875e6,"g2":504050.375,"g3":571332.5,"g4":1.756823375e6,"g5":647166.5625,"g6":392243.90625,"g7":633047.9375,"g8":88533.7421875,"g9":390802.28125,"g10":4.5130295e6},
{"x":2012,"g1":1.331646e6,"g2":507217.0625,"g3":572565.5,"g4":1.78766725e6,"g5":654798.375,"g6":416387.84375,"g7":657816.75,"g8":92856.484375,"g9":387790.5,"g10":4.5344345e6},
{"x":2013,"g1":1.366206125e6,"g2":505945.3125,"g3":574314.625,"g4":1.829245125e6,"g5":666533.3125,"g6":430164.0625,"g7":691589.0625,"g8":95173.0390625,"g9":387628.34375,"g10":4.5519475e6},
{"x":2014,"g1":1.39612825e6,"g2":509769.25,"g3":584454.375,"g4":1.881807875e6,"g5":682196.0625,"g6":437875.40625,"g7":722703.875,"g8":98544.171875,"g9":396331.4375,"g10":4.650702e6},
{"x":2015,"g1":1.434652875e6,"g2":516414.1875,"g3":593070.1875,"g4":1.894039125e6,"g5":693415.5625,"g6":447298.21875,"g7":744066.3125,"g8":102143.078125,"g9":415984.53125,"g10":4.727565e6},
{"x":2016,"g1":1.467357125e6,"g2":527347.8125,"g3":600148.5,"g4":1.913709625e6,"g5":707760.1875,"g6":455139.5,"g7":759597.75,"g8":106437.5078125,"g9":426720.5625,"g10":4.8360485e6},
{"x":2017,"g1":1.5095945e6,"g2":539330.4375,"g3":608997.5,"g4":1.97176825e6,"g5":717405.5625,"g6":461318.9375,"g7":769923.4375,"g8":110862.859375,"g9":448797.21875,"g10":4.9673975e6},
{"x":2018,"g1":1.542376e6,"g2":552728.625,"g3":620434.25,"g4":2.02585325e6,"g5":737926.5625,"g6":479725.6875,"g7":789666.8125,"g8":113762.9296875,"g9":461499.53125,"g10":5.022855e6},
{"x":2019,"g1":1.540531375e6,"g2":562428.875,"g3":635590.75,"g4":2.064515375e6,"g5":746353.5,"g6":482768.9375,"g7":814832.3125,"g8":116513.15625,"g9":477955.59375,"g10":5.072476e6},
{"x":2020,"g1":1.573054625e6,"g2":526893.1875,"g3":605127.0625,"g4":1.96050025e6,"g5":730368.5625,"g6":453110.15625,"g7":756279.1875,"g8":111534.140625,"g9":452600.65625,"g10":4.864751e6},
{"x":2021,"g1":1.63978975e6,"g2":552159.5,"g3":642660.375,"g4":2.064151e6,"g5":770974.375,"g6":504465.4375,"g7":837966.375,"g8":120385.2265625,"g9":470836.0,"g10":5.043287e6},
{"x":2022,"g1":1.69623125e6,"g2":581301.875,"g3":669866.9375,"g4":2.14299875e6,"g5":794443.3125,"g6":514851.0625,"g7":899044.75,"g8":125864.5390625,"g9":484241.5,"g10":5.112367e6},
{"x":2023,"g1":1.72050625e6,"g2":575750.625,"g3":678251.6875,"g4":2.16976325e6,"g5":799871.8125,"g6":515977.5,"g7":906207.25,"g8":132298.65625,"g9":483828.3125,"g10":5.098745e6}];
    const series = [{"name":"AUS","color":"#1f77b4","key":"g1","dash":""},{"name":"AUT","color":"#ff7f0e","key":"g2","dash":""},{"name":"BEL","color":"#2ca02c","key":"g3","dash":""},{"name":"CAN","color":"#d62728","key":"g4","dash":""},{"name":"CHE","color":"#9467bd","key":"g5","dash":""},{"name":"CHL","color":"#8c564b","key":"g6","dash":""},{"name":"COL","color":"#e377c2","key":"g7","dash":""},{"name":"CRI","color":"#7f7f7f","key":"g8","dash":""},{"name":"CZE","color":"#bcbd22","key":"g9","dash":""},{"name":"DEU","color":"#17becf","key":"g10","dash":""}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#pd_92');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Time') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Time');
    if('') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1950,"g1":8.22766649539222,"g2":6.93438787296552,"g3":8.63282864830933,"g4":13.8117417797784,"g5":4.62952696846788,"g6":null,"g7":11.257437789049,"g8":0.918648536697223,"g9":null,"g10":68.4075791471299},
{"x":1951,"g1":8.46976245504914,"g2":6.93473878907264,"g3":8.67181583465529,"g4":14.1264449915337,"g5":4.68377183610909,"g6":6.57010742455453,"g7":11.620015796168,"g8":0.948692241322874,"g9":null,"g10":68.7457352509051},
{"x":1952,"g1":8.64950741082625,"g2":6.92706059207647,"g3":8.72379557327543,"g4":14.5748712865016,"g5":4.74886530104836,"g6":6.70218953166488,"g7":11.9946637448643,"g8":0.981519514277519,"g9":null,"g10":69.1189075192724},
{"x":1953,"g1":8.81542020996216,"g2":6.93177125938411,"g3":8.77122782330438,"g4":14.9669931748581,"g5":4.81099971560617,"g6":6.8232052486066,"g7":12.3820114356497,"g8":1.0160368604836,"g9":null,"g10":69.5150904100859},
{"x":1954,"g1":9.02052411958149,"g2":6.9394961816228,"g3":8.81270316822361,"g4":15.4134086317357,"g5":4.86129933950135,"g6":6.94864371322213,"g7":12.7825052859462,"g8":1.05300923387317,"g9":null,"g10":69.9302820759636},
{"x":1955,"g1":9.23257163136818,"g2":6.94617169305744,"g3":8.86176115495342,"g4":15.8216181648978,"g5":4.91159896339653,"g6":7.08644843289024,"g7":13.1966130152516,"g8":1.09326960814252,"g9":null,"g10":70.3584797458328},
{"x":1956,"g1":9.45501746263896,"g2":6.95164522146753,"g3":8.91708956811452,"g4":16.2107242661604,"g5":4.97570623497122,"g6":7.23943110455152,"g7":13.624816235722,"g8":1.13551765002656,"g9":null,"g10":70.8016843433842},
{"x":1957,"g1":9.66596402055549,"g2":6.96514452546359,"g3":8.9823058148092,"g4":16.767738638254,"g5":5.05559354095458,"g6":7.40713572317729,"g7":14.06832175628,"g8":1.17858597111052,"g9":null,"g10":71.2648981778454},
{"x":1958,"g1":9.86768914071121,"g2":6.9866405209661,"g3":9.04585344194746,"g4":17.2131482060448,"g5":5.12759082973361,"g6":7.5872131112132,"g7":14.5269878718101,"g8":1.22320327338151,"g9":null,"g10":71.7551244821349},
{"x":1959,"g1":10.083112594667,"g2":7.01361052166688,"g3":9.09683734536689,"g4":17.617335122943,"g5":5.1867666641977,"g6":7.77643565504413,"g7":15.0013573221654,"g8":1.27166909223133,"g9":null,"g10":72.2803669510164},
{"x":1960,"g1":10.3115548281376,"g2":7.04671344884318,"g3":9.11179679128151,"g4":18.0064412242057,"g5":5.28835210535263,"g6":7.97138381805939,"g7":15.4927656549023,"g8":1.32239604720028,"g9":null,"g10":72.8486292792539},
{"x":1961,"g1":10.5479561988109,"g2":7.0855712094611,"g3":9.15886120170521,"g4":18.3694054902113,"g5":5.43629192665671,"g6":8.16891467329204,"g7":16.0010711649055,"g8":1.37385524093146,"g9":null,"g10":73.458911005002},
{"x":1962,"g1":10.7431686073656,"g2":7.12913200877563,"g3":9.21142128830356,"g4":18.7152771624077,"g5":5.5881765214191,"g6":8.3664234799299,"g7":16.5194432951515,"g8":1.42535144448795,"g9":null,"g10":74.1032084334967},
{"x":1963,"g1":10.9486929674716,"g2":7.17507388830619,"g3":9.27607243425755,"g4":19.0671804087918,"g5":5.70948724072872,"g6":8.56198549586839,"g7":17.0401160496207,"g8":1.47648108656643,"g9":null,"g10":74.7585109422917},
{"x":1964,"g1":11.1644732823371,"g2":7.22305928201493,"g3":9.35990841682468,"g4":19.4301465549639,"g5":5.80614124477305,"g6":8.75437652299203,"g7":17.5684149473486,"g8":1.52600970633835,"g9":null,"g10":75.3978060615589},
{"x":1965,"g1":11.3844932187008,"g2":7.27014211568184,"g3":9.4409474842587,"g4":19.7850655884418,"g5":5.86137183549111,"g6":8.94303933317786,"g7":18.1085540947023,"g8":1.57625667039882,"g9":null,"g10":75.9990836306976},
{"x":1966,"g1":11.5991564450273,"g2":7.32131388485789,"g3":9.50060230106691,"g4":20.1570790958953,"g5":5.91364384611544,"g6":9.12800098606495,"g7":18.6480930792152,"g8":1.63012327116282,"g9":null,"g10":76.5543399549438},
{"x":1967,"g1":11.8152955189987,"g2":7.37624036102256,"g3":9.54926576552583,"g4":20.5230591489947,"g5":5.97972397470701,"g6":9.3097565728273,"g7":19.1941745796351,"g8":1.68339430426012,"g9":null,"g10":77.062574572452},
{"x":1968,"g1":12.0435906422539,"g2":7.41464135855539,"g3":9.58254000256245,"g4":20.8417849770138,"g5":6.04777601974001,"g6":9.48915797099101,"g7":19.7357344828497,"g8":1.73611865297533,"g9":null,"g10":77.5137828647674},
{"x":1969,"g1":12.3199822640646,"g2":7.44029065597256,"g3":9.60542324722723,"g4":21.1424104419706,"g5":6.12667713235879,"g6":9.66728556170098,"g7":20.2674250415703,"g8":1.78764037183801,"g9":null,"g10":77.8969597515895},
{"x":1970,"g1":12.599411,"g2":7.466319,"g3":9.630504,"g4":21.440022,"g5":6.180922,"g6":9.845344,"g7":20.811782,"g8":1.838949,"g9":null,"g10":78.205102},
{"x":1971,"g1":12.997964,"g2":7.499635,"g3":9.666531,"g4":21.895691,"g5":6.21353,"g6":10.009701,"g7":21.319096,"g8":1.888539,"g9":null,"g10":78.345872},
{"x":1972,"g1":13.304896,"g2":7.543259,"g3":9.694853,"g4":22.23088,"g5":6.261081,"g6":10.174678,"g7":21.819563,"g8":1.938248,"g9":null,"g10":78.719918},
{"x":1973,"g1":13.518685,"g2":7.585105,"g3":9.718035,"g4":22.512227,"g5":6.307403,"g6":10.340362,"g7":22.325374,"g8":1.988343,"g9":null,"g10":78.966971},
{"x":1974,"g1":13.719495,"g2":7.597967,"g3":9.735806,"g4":22.824082,"g5":6.341377,"g6":10.505817,"g7":22.833469,"g8":2.039643,"g9":null,"g10":78.996693},
{"x":1975,"g1":13.893989,"g2":7.57783,"g3":9.748476,"g4":23.148986,"g5":6.3386,"g6":10.671559,"g7":23.344644,"g8":2.092719,"g9":null,"g10":78.701865},
{"x":1976,"g1":14.046755,"g2":7.564457,"g3":9.758901,"g4":23.455781,"g5":6.302555,"g6":10.838251,"g7":23.85881,"g8":2.147774,"g9":null,"g10":78.364505},
{"x":1977,"g1":14.203508,"g2":7.567336,"g3":9.774014,"g4":23.73034,"g5":6.281359,"g6":11.005519,"g7":24.393494,"g8":2.205025,"g9":null,"g10":78.185559},
{"x":1978,"g1":14.367098,"g2":7.561204,"g3":9.791817,"g4":23.978738,"g5":6.282038,"g6":11.172695,"g7":24.950337,"g8":2.26451,"g9":null,"g10":78.11536},
{"x":1979,"g1":14.533035,"g2":7.548341,"g3":9.811365,"g4":24.237173,"g5":6.294715,"g6":11.339779,"g7":25.515626,"g8":2.32649,"g9":null,"g10":78.147901},
{"x":1980,"g1":14.721347,"g2":7.548406,"g3":9.833093,"g4":24.533776,"g5":6.319846,"g6":11.50855,"g7":26.104498,"g8":2.390633,"g9":null,"g10":78.315375},
{"x":1981,"g1":14.949202,"g2":7.567556,"g3":9.850669,"g4":24.844974,"g5":6.354556,"g6":11.678717,"g7":26.713267,"g8":2.456637,"g9":null,"g10":78.44804},
{"x":1982,"g1":15.192485,"g2":7.573078,"g3":9.862327,"g4":25.140164,"g5":6.391804,"g6":11.850214,"g7":27.338331,"g8":2.524806,"g9":null,"g10":78.393674},
{"x":1983,"g1":15.414893,"g2":7.561163,"g3":9.869132,"g4":25.412608,"g5":6.419311,"g6":12.026138,"g7":27.988173,"g8":2.595153,"g9":null,"g10":78.224133},
{"x":1984,"g1":15.620653,"g2":7.560715,"g3":9.874586,"g4":25.670375,"g5":6.442422,"g6":12.207733,"g7":28.64269,"g8":2.667595,"g9":null,"g10":77.998198},
{"x":1985,"g1":15.835747,"g2":7.564309,"g3":9.880337,"g4":25.927465,"g5":6.470957,"g6":12.395274,"g7":29.26847,"g8":2.741894,"g9":null,"g10":77.863424},
{"x":1986,"g1":16.069633,"g2":7.569395,"g3":9.886984,"g4":26.211031,"g5":6.50475,"g6":12.588914,"g7":29.879112,"g8":2.817216,"g9":null,"g10":77.923807},
{"x":1987,"g1":16.322269,"g2":7.574315,"g3":9.899147,"g4":26.540921,"g5":6.545773,"g6":12.79015,"g7":30.499467,"g8":2.892699,"g9":null,"g10":78.062324},
{"x":1988,"g1":16.594099,"g2":7.585342,"g3":9.916565,"g4":26.927945,"g5":6.594143,"g6":12.999424,"g7":31.130524,"g8":2.968103,"g9":null,"g10":78.385992},
{"x":1989,"g1":16.869362,"g2":7.620407,"g3":9.936573,"g4":27.36605,"g5":6.647788,"g6":13.215005,"g7":31.776279,"g8":3.043827,"g9":null,"g10":79.007065},
{"x":1990,"g1":17.126298,"g2":7.679624,"g3":9.960968,"g4":27.789443,"g5":6.713173,"g6":13.437176,"g7":32.440069,"g8":3.121706,"g9":10.301988,"g10":79.707959},
{"x":1991,"g1":17.353193,"g2":7.75714,"g3":9.998961,"g4":28.157158,"g5":6.796943,"g6":13.662491,"g7":33.098372,"g8":3.202176,"g9":10.304426,"g10":80.303196},
{"x":1992,"g1":17.549288,"g2":7.842712,"g3":10.045987,"g4":28.500059,"g5":6.875051,"g6":13.884577,"g7":33.760571,"g8":3.284258,"g9":10.312448,"g10":80.934898},
{"x":1993,"g1":17.722911,"g2":7.907495,"g3":10.084931,"g4":28.830637,"g5":6.938106,"g6":14.102276,"g7":34.441473,"g8":3.367434,"g9":10.320398,"g10":81.486773},
{"x":1994,"g1":17.897433,"g2":7.938155,"g3":10.116005,"g4":29.147381,"g5":6.993587,"g6":14.316256,"g7":35.12741,"g8":3.451122,"g9":10.322329,"g10":81.773617},
{"x":1995,"g1":18.095344,"g2":7.950322,"g3":10.137265,"g4":29.459131,"g5":7.040477,"g6":14.527381,"g7":35.804662,"g8":3.535176,"g9":10.312042,"g10":82.01989},
{"x":1996,"g1":18.305307,"g2":7.960914,"g3":10.156969,"g4":29.767206,"g5":7.071883,"g6":14.734046,"g7":36.462745,"g8":3.619013,"g9":10.296128,"g10":82.263189},
{"x":1997,"g1":18.504912,"g2":7.969803,"g3":10.181464,"g4":30.059089,"g5":7.089163,"g6":14.932434,"g7":37.121149,"g8":3.701711,"g9":10.280051,"g10":82.389638},
{"x":1998,"g1":18.701717,"g2":7.978466,"g3":10.203182,"g4":30.329969,"g5":7.110291,"g6":15.127799,"g7":37.792165,"g8":3.782838,"g9":10.265426,"g10":82.011939},
{"x":1999,"g1":18.909981,"g2":7.993892,"g3":10.226682,"g4":30.599456,"g5":7.144121,"g6":15.319313,"g7":38.454863,"g8":3.862101,"g9":10.251378,"g10":81.678287},
{"x":2000,"g1":19.132471,"g2":8.012928,"g3":10.251717,"g4":30.891803,"g5":7.184007,"g6":15.503635,"g7":39.089934,"g8":3.937739,"g9":10.236804,"g10":81.797258},
{"x":2001,"g1":19.365433,"g2":8.042233,"g3":10.287004,"g4":31.213577,"g5":7.226391,"g6":15.683849,"g7":39.709262,"g8":4.008947,"g9":10.231936,"g10":81.933885},
{"x":2002,"g1":19.595355,"g2":8.081636,"g3":10.332973,"g4":31.535577,"g5":7.278752,"g6":15.857925,"g7":40.32468,"g8":4.075705,"g9":10.239468,"g10":82.068326},
{"x":2003,"g1":19.819454,"g2":8.122602,"g3":10.37626,"g4":31.836482,"g5":7.333447,"g6":16.024752,"g7":40.937429,"g8":4.138784,"g9":10.248912,"g10":82.111615},
{"x":2004,"g1":20.046677,"g2":8.173491,"g3":10.421292,"g4":32.132678,"g5":7.384194,"g6":16.187322,"g7":41.543171,"g8":4.200078,"g9":10.26145,"g10":82.092708},
{"x":2005,"g1":20.29449,"g2":8.229204,"g3":10.478886,"g4":32.440173,"g5":7.431823,"g6":16.348778,"g7":42.128977,"g8":4.26124,"g9":10.280153,"g10":82.046731},
{"x":2006,"g1":20.590559,"g2":8.269898,"g3":10.548442,"g4":32.759171,"g5":7.478509,"g6":16.509195,"g7":42.691084,"g8":4.32134,"g9":10.304588,"g10":81.701971},
{"x":2007,"g1":20.954549,"g2":8.296952,"g3":10.625493,"g4":33.092171,"g5":7.545381,"g6":16.671581,"g7":43.235374,"g8":4.380248,"g9":10.337543,"g10":81.298542},
{"x":2008,"g1":21.370589,"g2":8.323253,"g3":10.709708,"g4":33.449085,"g5":7.641728,"g6":16.838988,"g7":43.758808,"g8":4.440056,"g9":10.378292,"g10":81.110777},
{"x":2009,"g1":21.783011,"g2":8.345066,"g3":10.812935,"g4":33.82637,"g5":7.737645,"g6":17.009731,"g7":44.271541,"g8":4.499791,"g9":10.420985,"g10":80.935283},
{"x":2010,"g1":22.141581,"g2":8.365092,"g3":10.936626,"g4":34.196899,"g5":7.825753,"g6":17.181464,"g7":44.777319,"g8":4.555962,"g9":10.464035,"g10":80.830924},
{"x":2011,"g1":22.479775,"g2":8.39327,"g3":11.038631,"g4":34.555452,"g5":7.914372,"g6":17.351816,"g7":45.259614,"g8":4.609833,"g9":10.495511,"g10":80.857874},
{"x":2012,"g1":22.852644,"g2":8.431601,"g3":11.107518,"g4":34.922516,"g5":7.998926,"g6":17.519119,"g7":45.71581,"g8":4.663934,"g9":10.507335,"g10":80.91639},
{"x":2013,"g1":23.23627,"g2":8.481406,"g3":11.160276,"g4":35.293433,"g5":8.091202,"g6":17.687006,"g7":46.151584,"g8":4.716147,"g9":10.511163,"g10":81.041582},
{"x":2014,"g1":23.595601,"g2":8.547817,"g3":11.210119,"g4":35.634264,"g5":8.190235,"g6":17.864195,"g7":46.565429,"g8":4.767119,"g9":10.517226,"g10":81.37608},
{"x":2015,"g1":23.948002,"g2":8.644039,"g3":11.275335,"g4":35.962234,"g5":8.283934,"g6":18.047625,"g7":46.96994,"g8":4.818038,"g9":10.524416,"g10":82.07755},
{"x":2016,"g1":24.329963,"g2":8.737915,"g3":11.332701,"g4":36.353343,"g5":8.374901,"g6":18.267221,"g7":47.437512,"g8":4.866998,"g9":10.531948,"g10":82.760102},
{"x":2017,"g1":24.731038,"g2":8.798778,"g3":11.376581,"g4":36.808497,"g5":8.453628,"g6":18.558868,"g7":48.131078,"g8":4.913177,"g9":10.541342,"g10":83.104007},
{"x":2018,"g1":25.119706,"g2":8.84165,"g3":11.428605,"g4":37.295005,"g5":8.516344,"g6":18.893191,"g7":49.024465,"g8":4.957818,"g9":10.548937,"g10":83.368505},
{"x":2019,"g1":25.482714,"g2":8.880876,"g3":11.490618,"g4":37.782935,"g5":8.577524,"g6":19.197744,"g7":49.907985,"g8":4.999553,"g9":10.554875,"g10":83.559186},
{"x":2020,"g1":25.743791,"g2":8.921405,"g3":11.540107,"g4":38.171902,"g5":8.640582,"g6":19.370624,"g7":50.629997,"g8":5.03432,"g9":10.550129,"g10":83.628708},
{"x":2021,"g1":25.956417,"g2":8.967057,"g3":11.570844,"g4":38.454057,"g5":8.707023,"g6":19.456334,"g7":51.188173,"g8":5.059988,"g9":10.530683,"g10":83.697083},
{"x":2022,"g1":26.200984,"g2":9.064677,"g3":11.64182,"g4":38.821259,"g5":8.792182,"g6":19.553036,"g7":51.737944,"g8":5.081765,"g9":10.673213,"g10":84.086227},
{"x":2023,"g1":26.451124,"g2":9.130429,"g3":11.712893,"g4":39.299105,"g5":8.870561,"g6":19.658835,"g7":52.321152,"g8":5.105525,"g9":10.809716,"g10":84.548231}];
    const series = [{"name":"AUS","color":"#1f77b4","key":"g1","dash":""},{"name":"AUT","color":"#ff7f0e","key":"g2","dash":""},{"name":"BEL","color":"#2ca02c","key":"g3","dash":""},{"name":"CAN","color":"#d62728","key":"g4","dash":""},{"name":"CHE","color":"#9467bd","key":"g5","dash":""},{"name":"CHL","color":"#8c564b","key":"g6","dash":""},{"name":"COL","color":"#e377c2","key":"g7","dash":""},{"name":"CRI","color":"#7f7f7f","key":"g8","dash":""},{"name":"CZE","color":"#bcbd22","key":"g9","dash":""},{"name":"DEU","color":"#17becf","key":"g10","dash":""}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#pd_93');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Time') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Time');
    if('') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1950,"g1":3.4272837638855,"g2":2.91568040847778,"g3":3.4579496383667,"g4":6.07638311386108,"g5":2.27679228782654,"g6":null,"g7":3.42831301689148,"g8":0.281385451555252,"g9":null,"g10":30.7108097076416},
{"x":1951,"g1":3.5212619304657,"g2":2.97085547447205,"g3":3.45498085021973,"g4":6.23281812667847,"g5":2.35944151878357,"g6":2.02105164527893,"g7":3.49751305580139,"g8":0.288206338882446,"g9":null,"g10":31.2887859344482},
{"x":1952,"g1":3.58896613121033,"g2":2.90400242805481,"g3":3.4569890499115,"g4":6.28221797943115,"g5":2.40392208099365,"g6":2.03831100463867,"g7":3.56704139709473,"g8":0.295052856206894,"g9":null,"g10":31.8737907409668},
{"x":1953,"g1":3.65064978599548,"g2":2.8726761341095,"g3":3.45699214935303,"g4":6.3151478767395,"g5":2.42108273506165,"g6":2.08896613121033,"g7":3.63104104995728,"g8":0.302077949047089,"g9":null,"g10":32.6815452575684},
{"x":1954,"g1":3.7282726764679,"g2":2.95665597915649,"g3":3.45444273948669,"g4":6.26575613021851,"g5":2.44810652732849,"g6":2.07328748703003,"g7":3.69552993774414,"g8":0.309121131896973,"g9":null,"g10":33.676815032959},
{"x":1955,"g1":3.80841636657715,"g2":3.10609316825867,"g3":3.45467042922974,"g4":6.33985090255737,"g5":2.49791288375855,"g6":2.10775208473206,"g7":3.77015423774719,"g8":0.316663146018982,"g9":null,"g10":34.7804718017578},
{"x":1956,"g1":3.89250016212463,"g2":3.20088076591492,"g3":3.45713305473328,"g4":6.61156368255615,"g5":2.57040333747864,"g6":2.12511205673218,"g7":3.84954786300659,"g8":0.324899256229401,"g9":null,"g10":35.4942855834961},
{"x":1957,"g1":3.94345593452454,"g2":3.27375364303589,"g3":3.48168253898621,"g4":6.69389629364014,"g5":2.62898755073547,"g6":2.19255375862122,"g7":3.92877316474915,"g8":0.334047645330429,"g9":null,"g10":36.1645698547363},
{"x":1958,"g1":3.97842645645142,"g2":3.30004024505615,"g3":3.44435930252075,"g4":6.49629259109497,"g5":2.60719108581543,"g6":2.22733283042908,"g7":4.00957632064819,"g8":0.342977732419968,"g9":null,"g10":36.4424591064453},
{"x":1959,"g1":4.0273814201355,"g2":3.34935641288757,"g3":3.4158821105957,"g4":6.60333490371704,"g5":2.60748696327209,"g6":2.21702909469605,"g7":4.08767509460449,"g8":0.352287471294403,"g9":null,"g10":36.8119850158691},
{"x":1960,"g1":4.15227031707764,"g2":3.41788744926453,"g3":3.49445271492004,"g4":6.57863283157349,"g5":2.67978024482727,"g6":2.26099681854248,"g7":4.18358373641968,"g8":0.362097084522247,"g9":null,"g10":37.2704124450684},
{"x":1961,"g1":4.16426372528076,"g2":3.43663644790649,"g3":3.52063274383545,"g4":6.59509134292603,"g5":2.80503582954407,"g6":2.30426073074341,"g7":4.29408884048462,"g8":0.373651683330536,"g9":null,"g10":37.648120880127},
{"x":1962,"g1":4.26416921615601,"g2":3.42055082321167,"g3":3.57501149177551,"g4":6.75977182388306,"g5":2.91313052177429,"g6":2.33038067817688,"g7":4.40686798095703,"g8":0.385524481534958,"g9":null,"g10":37.7473106384277},
{"x":1963,"g1":4.38606357574463,"g2":3.39713144302368,"g3":3.60019254684448,"g4":6.90796947479248,"g5":2.95790672302246,"g6":2.38208079338074,"g7":4.52068519592285,"g8":0.397928923368454,"g9":null,"g10":37.7966804504395},
{"x":1964,"g1":4.54341506958008,"g2":3.39149236679077,"g3":3.6515531539917,"g4":7.1467490196228,"g5":3.00416278839111,"g6":2.40398573875427,"g7":4.63522863388062,"g8":0.410307288169861,"g9":null,"g10":37.846923828125},
{"x":1965,"g1":4.68104219436646,"g2":3.36869359016418,"g3":3.66565299034119,"g4":7.45139455795288,"g5":2.98374700546265,"g6":2.43011951446533,"g7":4.76037216186523,"g8":0.424388408660889,"g9":null,"g10":37.9869689941406},
{"x":1966,"g1":4.84978771209717,"g2":3.34071493148804,"g3":3.6787428855896,"g4":7.70663166046143,"g5":2.97230648994446,"g6":2.47436857223511,"g7":4.92188787460327,"g8":0.43962088227272,"g9":null,"g10":37.9016876220703},
{"x":1967,"g1":5.00150632858276,"g2":3.28626155853272,"g3":3.66262531280518,"g4":7.84659862518311,"g5":2.98808670043945,"g6":2.52424049377441,"g7":5.086021900177,"g8":0.455295652151108,"g9":null,"g10":37.1753463745117},
{"x":1968,"g1":5.12361621856689,"g2":3.24312829971313,"g3":3.65859794616699,"g4":7.85483026504517,"g5":3.00613522529602,"g6":2.57638168334961,"g7":5.2592945098877,"g8":0.471475154161453,"g9":null,"g10":37.3088188171387},
{"x":1969,"g1":5.26686716079712,"g2":3.23713517189026,"g3":3.72104096412659,"g4":8.10184001922607,"g5":3.05584311485291,"g6":2.61909413337708,"g7":5.43368864059448,"g8":0.488058120012283,"g9":null,"g10":37.6952095031738},
{"x":1970,"g1":5.46656227111816,"g2":3.24365496635437,"g3":3.72405886650085,"g4":8.09360694885254,"g5":3.09933757781982,"g6":2.64883756637573,"g7":5.6399245262146,"g8":0.507373571395874,"g9":null,"g10":37.9167823791504},
{"x":1971,"g1":5.64900827407837,"g2":3.2792603969574,"g3":3.75076389312744,"g4":8.30304431915283,"g5":3.13316869735718,"g6":2.77054405212402,"g7":5.83294105529785,"g8":0.528400242328644,"g9":null,"g10":37.8544998168945},
{"x":1972,"g1":5.76099920272827,"g2":3.30342769622803,"g3":3.73952460289001,"g4":8.60748863220215,"g5":3.17171740531921,"g6":2.8958637714386,"g7":6.03272581100464,"g8":0.550272345542908,"g9":null,"g10":37.9924163818359},
{"x":1973,"g1":5.92150211334229,"g2":3.34956169128418,"g3":3.77037882804871,"g4":9.03525733947754,"g5":3.20849013328552,"g6":2.91879606246948,"g7":6.23954296112061,"g8":0.572825253009796,"g9":null,"g10":38.350154876709},
{"x":1974,"g1":6.03445529937744,"g2":3.39309072494507,"g3":3.82215976715088,"g4":9.49257755279541,"g5":3.21329164505005,"g6":2.78758549690247,"g7":6.45365953445435,"g8":0.593913197517395,"g9":null,"g10":38.0791549682617},
{"x":1975,"g1":6.01168203353882,"g2":3.36804461479187,"g3":3.76141619682312,"g4":9.58891773223877,"g5":3.07625269889832,"g6":2.70782017707825,"g7":6.82159805297852,"g8":0.626607358455658,"g9":null,"g10":37.3638763427734},
{"x":1976,"g1":6.09550762176514,"g2":3.37936520576477,"g3":3.73916792869568,"g4":9.72191905975342,"g5":3.00409078598022,"g6":2.76946592330933,"g7":7.04112052917481,"g8":0.654034912586212,"g9":null,"g10":37.3238792419434},
{"x":1977,"g1":6.14987134933472,"g2":3.42046546936035,"g3":3.72579431533813,"g4":9.88956928253174,"g5":3.01492142677307,"g6":2.91729164123535,"g7":7.35281133651733,"g8":0.688017189502716,"g9":null,"g10":37.3924827575684},
{"x":1978,"g1":6.17055416107178,"g2":3.43754172325134,"g3":3.73259902000427,"g4":10.1958246231079,"g5":3.03756594657898,"g6":2.95981001853943,"g7":7.53997898101807,"g8":0.712318599224091,"g9":null,"g10":37.7019309997559},
{"x":1979,"g1":6.25266456604004,"g2":3.45223641395569,"g3":3.77136921882629,"g4":10.6511421203613,"g5":3.06740045547485,"g6":3.02660298347473,"g7":7.75586700439453,"g8":0.733653545379639,"g9":null,"g10":38.2572288513184},
{"x":1980,"g1":6.43097400665283,"g2":3.4837372303009,"g3":3.77100324630737,"g4":10.9574146270752,"g5":3.1335015296936,"g6":3.18515276908875,"g7":7.88934707641602,"g8":0.752346992492676,"g9":null,"g10":38.7229194641113},
{"x":1981,"g1":6.52753734588623,"g2":3.47178244590759,"g3":3.70606875419617,"g4":11.2800168991089,"g5":3.20425224304199,"g6":3.2650842666626,"g7":8.23940277099609,"g8":0.753643810749054,"g9":null,"g10":38.7912483215332},
{"x":1982,"g1":6.53168630599976,"g2":3.42237758636475,"g3":3.66093730926514,"g4":10.9168910980225,"g5":3.21788454055786,"g6":3.10705471038818,"g7":8.37739658355713,"g8":0.773818254470825,"g9":null,"g10":38.5415458679199},
{"x":1983,"g1":6.42645740509033,"g2":3.40403008460999,"g3":3.61566710472107,"g4":11.0030822753906,"g5":3.21558499336243,"g6":3.39452266693115,"g7":8.38828182220459,"g8":0.813935875892639,"g9":null,"g10":38.2541236877441},
{"x":1984,"g1":6.64158773422241,"g2":3.40024161338806,"g3":3.61674380302429,"g4":11.287880897522,"g5":3.24422955513001,"g6":3.50132083892822,"g7":8.44988918304443,"g8":0.860839426517487,"g9":null,"g10":38.3833389282227},
{"x":1985,"g1":6.86523818969727,"g2":3.40923118591309,"g3":3.6348340511322,"g4":11.651647567749,"g5":3.30687952041626,"g6":3.66228818893433,"g7":8.67510986328125,"g8":0.893453717231751,"g9":null,"g10":38.6601829528809},
{"x":1986,"g1":7.15787935256958,"g2":3.41781139373779,"g3":3.659019947052,"g4":12.0118141174316,"g5":3.37926983833313,"g6":3.81907606124878,"g7":8.96856594085693,"g8":0.925850510597229,"g9":null,"g10":39.0774955749512},
{"x":1987,"g1":7.32305145263672,"g2":3.41320395469666,"g3":3.68749308586121,"g4":12.3289222717285,"g5":3.46002817153931,"g6":3.90639781951904,"g7":9.42428493499756,"g8":0.966472268104553,"g9":null,"g10":39.381275177002},
{"x":1988,"g1":7.60127115249634,"g2":3.43837070465088,"g3":3.76008796691895,"g4":12.7252635955811,"g5":3.54743146896362,"g6":4.02087354660034,"g7":9.77682495117188,"g8":0.997621536254883,"g9":null,"g10":39.6400413513184},
{"x":1989,"g1":7.9344048500061,"g2":3.48591065406799,"g3":3.80533814430237,"g4":12.9899101257324,"g5":3.64005875587463,"g6":4.18909931182861,"g7":10.2558507919312,"g8":1.06233298778534,"g9":null,"g10":40.0093269348145},
{"x":1990,"g1":8.06645011901856,"g2":3.54023694992065,"g3":3.84357118606567,"g4":13.0858545303345,"g5":3.75166583061218,"g6":4.32258892059326,"g7":10.5054531097412,"g8":1.08485722541809,"g9":5.39389133453369,"g10":39.876953125},
{"x":1991,"g1":7.87423372268677,"g2":3.58416867256165,"g3":3.85691905021668,"g4":12.8660945892334,"g5":3.95226955413818,"g6":4.41695833206177,"g7":11.1938276290894,"g8":1.10609328746796,"g9":5.25986671447754,"g10":39.0394172668457},
{"x":1992,"g1":7.83751249313355,"g2":3.60016560554504,"g3":3.85435891151428,"g4":12.742922782898,"g5":3.90078163146973,"g6":4.621666431427,"g7":11.3390913009644,"g8":1.15737020969391,"g9":5.05524253845215,"g10":38.5750961303711},
{"x":1993,"g1":7.87055444717407,"g2":3.5806257724762,"g3":3.82921075820923,"g4":12.8117399215698,"g5":3.87195944786072,"g6":4.69417428970337,"g7":12.0534286499023,"g8":1.19553244113922,"g9":5.03917169570923,"g10":38.1237449645996},
{"x":1994,"g1":8.1211748123169,"g2":3.57996296882629,"g3":3.81318378448486,"g4":13.0777921676636,"g5":3.85051965713501,"g6":4.7314248085022,"g7":12.5207500457764,"g8":1.23558712005615,"g9":5.09230756759644,"g10":38.1793022155762},
{"x":1995,"g1":8.4172887802124,"g2":3.56742596626282,"g3":3.86822199821472,"g4":13.3187160491943,"g5":3.84424591064453,"g6":4.92006349563599,"g7":13.0954647064209,"g8":1.26612794399261,"g9":5.12259960174561,"g10":38.3849334716797},
{"x":1996,"g1":8.6054220199585,"g2":3.5812611579895,"g3":3.87838482856751,"g4":13.442967414856,"g5":3.83322095870972,"g6":5.11442518234253,"g7":13.3001823425293,"g8":1.297572016716,"g9":5.14887142181397,"g10":38.4402847290039},
{"x":1997,"g1":8.65484237670898,"g2":3.60738015174866,"g3":3.90492963790894,"g4":13.7290811538696,"g5":3.82578754425049,"g6":5.265700340271,"g7":13.5767011642456,"g8":1.35019409656525,"g9":5.11057138442993,"g10":38.4614028930664},
{"x":1998,"g1":8.79393672943115,"g2":3.64380431175232,"g3":3.97342944145203,"g4":14.0778570175171,"g5":3.87521934509277,"g6":5.38584470748901,"g7":13.5996885299683,"g8":1.39744579792023,"g9":5.01901435852051,"g10":38.7734031677246},
{"x":1999,"g1":8.95317459106445,"g2":3.69898223876953,"g3":4.0280237197876,"g4":14.4439992904663,"g5":3.90468430519104,"g6":5.36633777618408,"g7":13.3980197906494,"g8":1.43691301345825,"g9":4.90995788574219,"g10":39.2541007995606},
{"x":2000,"g1":9.15580081939697,"g2":3.7340624332428,"g3":4.10910558700562,"g4":14.806040763855,"g5":3.94416260719299,"g6":5.53660535812378,"g7":14.2371225357056,"g8":1.49447667598724,"g9":4.86745357513428,"g10":40.1490707397461},
{"x":2001,"g1":9.33692646026611,"g2":3.76019597053528,"g3":4.16534996032715,"g4":14.9712743759155,"g5":4.01356649398804,"g6":5.61942672729492,"g7":14.3336715698242,"g8":1.52548813819885,"g9":4.87510442733765,"g10":40.074951171875},
{"x":2002,"g1":9.45518779754639,"g2":3.7565450668335,"g3":4.17475366592407,"g4":15.3218393325806,"g5":4.04264831542969,"g6":5.73602437973023,"g7":14.6815271377563,"g8":1.56531858444214,"g9":4.9205470085144,"g10":39.9185104370117},
{"x":2003,"g1":9.67939853668213,"g2":3.78339385986328,"g3":4.17084836959839,"g4":15.6996545791626,"g5":4.02914571762085,"g6":5.89563751220703,"g7":15.246301651001,"g8":1.60537767410278,"g9":4.88556814193726,"g10":39.5227508544922},
{"x":2004,"g1":9.86977863311768,"g2":3.80705428123474,"g3":4.21205711364746,"g4":15.9533767700195,"g5":4.04122114181519,"g6":6.01209306716919,"g7":15.8290681838989,"g8":1.65547633171082,"g9":4.87975406646729,"g10":39.6837577819824},
{"x":2005,"g1":10.1498174667358,"g2":3.85279417037964,"g3":4.27248096466064,"g4":16.1636619567871,"g5":4.07288026809692,"g6":6.23042726516724,"g7":16.4764575958252,"g8":1.70238769054413,"g9":4.97032785415649,"g10":39.6711311340332},
{"x":2006,"g1":10.4159488677979,"g2":3.91921520233154,"g3":4.32073736190796,"g4":16.4316177368164,"g5":4.16175031661987,"g6":6.45059299468994,"g7":17.0571823120117,"g8":1.76370000839233,"g9":5.03326654434204,"g10":39.8721542358398},
{"x":2007,"g1":10.7361841201782,"g2":3.99066925048828,"g3":4.39245843887329,"g4":16.8124904632568,"g5":4.26915550231934,"g6":6.63119840621948,"g7":17.972843170166,"g8":1.84317672252655,"g9":5.12680101394653,"g10":40.4395866394043},
{"x":2008,"g1":11.0429754257202,"g2":4.06640625,"g3":4.47060537338257,"g4":17.0522804260254,"g5":4.37521409988403,"g6":6.72141313552856,"g7":18.2545528411865,"g8":1.8894704580307,"g9":5.20516967773438,"g10":41.0326194763184},
{"x":2009,"g1":11.1730194091797,"g2":4.04547452926636,"g3":4.47162389755249,"g4":16.7656116485596,"g5":4.40106916427612,"g6":6.74742460250855,"g7":18.4297657012939,"g8":1.88155674934387,"g9":5.10196542739868,"g10":41.1390953063965},
{"x":2010,"g1":11.3007745742798,"g2":4.07625865936279,"g3":4.51284980773926,"g4":16.9990310668945,"g5":4.42961978912354,"g6":6.8891978263855,"g7":18.8913440704346,"g8":1.94077551364899,"g9":5.05762910842896,"g10":41.3852577209473},
{"x":2011,"g1":11.5834360122681,"g2":4.13998031616211,"g3":4.5514497756958,"g4":17.2673625946045,"g5":4.55474042892456,"g6":7.12135457992554,"g7":19.4976921081543,"g8":1.98042011260986,"g9":5.05731868743897,"g10":41.8781890869141},
{"x":2012,"g1":11.7063789367676,"g2":4.18322658538818,"g3":4.56256246566773,"g4":17.4798488616943,"g5":4.63472509384155,"g6":7.37893438339233,"g7":19.9761848449707,"g8":1.97120630741119,"g9":5.08460140228272,"g10":42.3279037475586},
{"x":2013,"g1":11.8428659439087,"g2":4.20145893096924,"g3":4.55216789245606,"g4":17.7335376739502,"g5":4.69017028808594,"g6":7.54585838317871,"g7":20.3189544677734,"g8":2.03173851966858,"g9":5.10739707946777,"g10":42.5923309326172},
{"x":2014,"g1":11.8968238830566,"g2":4.24325466156006,"g3":4.56872320175171,"g4":17.8370094299316,"g5":4.77828788757324,"g6":7.62983417510986,"g7":20.3993816375732,"g8":2.0684666633606,"g9":5.13688278198242,"g10":42.9700469970703},
{"x":2015,"g1":12.0478782653809,"g2":4.27408504486084,"g3":4.60706520080566,"g4":18.0122566223145,"g5":4.84704780578613,"g6":7.76043510437012,"g7":21.1043548583984,"g8":2.10685110092163,"g9":5.21015787124634,"g10":43.3498077392578},
{"x":2016,"g1":12.3064651489258,"g2":4.32182931900024,"g3":4.66482543945313,"g4":18.1368522644043,"g5":4.91531085968018,"g6":7.84431457519531,"g7":21.1867866516113,"g8":2.14619565010071,"g9":5.2646598815918,"g10":43.9107437133789},
{"x":2017,"g1":12.4996700286865,"g2":4.3961615562439,"g3":4.734450340271,"g4":18.4826793670654,"g5":4.96051788330078,"g6":7.92806816101074,"g7":21.2779293060303,"g8":2.1925356388092,"g9":5.33579540252686,"g10":44.5362663269043},
{"x":2018,"g1":12.8947973251343,"g2":4.47437429428101,"g3":4.80409526824951,"g4":18.7060432434082,"g5":5.01305246353149,"g6":7.99383497238159,"g7":21.398229598999,"g8":2.1961886882782,"g9":5.39432048797607,"g10":45.1352043151856},
{"x":2019,"g1":13.1821699142456,"g2":4.52494764328003,"g3":4.88003587722778,"g4":19.0792541503906,"g5":5.04982423782349,"g6":8.16564559936523,"g7":21.4365634918213,"g8":2.25467610359192,"g9":5.38132619857788,"g10":45.5520095825195},
{"x":2020,"g1":13.200291633606,"g2":4.45141696929932,"g3":4.87474346160889,"g4":18.0728626251221,"g5":5.02357196807861,"g6":7.16843414306641,"g7":19.8541221618652,"g8":2.01944756507874,"g9":5.27822017669678,"g10":45.2257537841797},
{"x":2021,"g1":13.3665046691895,"g2":4.54677677154541,"g3":4.94972133636475,"g4":19.0036144256592,"g5":5.05702686309814,"g6":7.56047296524048,"g7":20.8645763397217,"g8":2.1168475151062,"g9":5.32157421112061,"g10":45.3312225341797},
{"x":2022,"g1":13.7700872421265,"g2":4.66247940063477,"g3":5.03521394729614,"g4":19.6082496643066,"g5":5.13960933685303,"g6":8.07152366638184,"g7":22.1632251739502,"g8":2.23018026351929,"g9":5.31761169433594,"g10":45.8390464782715},
{"x":2023,"g1":13.7563667297363,"g2":4.69524145126343,"g3":5.06240177154541,"g4":20.1884651184082,"g5":5.22269582748413,"g6":8.2648344039917,"g7":22.9331722259522,"g8":2.15846085548401,"g9":5.3817195892334,"g10":46.0366134643555}];
    const series = [{"name":"AUS","color":"#1f77b4","key":"g1","dash":""},{"name":"AUT","color":"#ff7f0e","key":"g2","dash":""},{"name":"BEL","color":"#2ca02c","key":"g3","dash":""},{"name":"CAN","color":"#d62728","key":"g4","dash":""},{"name":"CHE","color":"#9467bd","key":"g5","dash":""},{"name":"CHL","color":"#8c564b","key":"g6","dash":""},{"name":"COL","color":"#e377c2","key":"g7","dash":""},{"name":"CRI","color":"#7f7f7f","key":"g8","dash":""},{"name":"CZE","color":"#bcbd22","key":"g9","dash":""},{"name":"DEU","color":"#17becf","key":"g10","dash":""}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#pd_94');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Time') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Time');
    if('') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1950,"g1":2.66730189323425,"g2":2.55264043807983,"g3":2.20354747772217,"g4":2.48197078704834,"g5":2.93511772155762,"g6":null,"g7":1.44564461708069,"g8":1.6008232831955,"g9":null,"g10":2.42699718475342},
{"x":1951,"g1":2.67434358596802,"g2":2.53703594207764,"g3":2.21905422210693,"g4":2.50054621696472,"g5":2.94137716293335,"g6":1.8869377374649,"g7":1.459104180336,"g8":1.602663397789,"g9":null,"g10":2.46930408477783},
{"x":1952,"g1":2.68140339851379,"g2":2.52152681350708,"g3":2.23467016220093,"g4":2.51926040649414,"g5":2.94765019416809,"g6":1.89483451843262,"g7":1.47268915176392,"g8":1.60450541973114,"g9":null,"g10":2.51234817504883},
{"x":1953,"g1":2.6884822845459,"g2":2.50611257553101,"g3":2.25039601325989,"g4":2.53811478614807,"g5":2.95393633842468,"g6":1.90276432037354,"g7":1.48640060424805,"g8":1.60634970664978,"g9":null,"g10":2.55614304542542},
{"x":1954,"g1":2.69557976722717,"g2":2.49079251289368,"g3":2.26623249053955,"g4":2.55711030960083,"g5":2.96023607254028,"g6":1.91072738170624,"g7":1.50023972988129,"g8":1.60819602012634,"g9":null,"g10":2.58732581138611},
{"x":1955,"g1":2.70269584655762,"g2":2.47556614875793,"g3":2.28218054771423,"g4":2.57092189788818,"g5":2.96654939651489,"g6":1.91872370243073,"g7":1.51420760154724,"g8":1.61004447937012,"g9":null,"g10":2.61760544776917},
{"x":1956,"g1":2.71145153045654,"g2":2.46107220649719,"g3":2.28719329833984,"g4":2.58254599571228,"g5":2.97167205810547,"g6":1.92343735694885,"g7":1.52740108966827,"g8":1.61592078208923,"g9":null,"g10":2.61976861953735},
{"x":1957,"g1":2.72023558616638,"g2":2.44666337966919,"g3":2.29221701622009,"g4":2.59422278404236,"g5":2.97680354118347,"g6":1.92816269397736,"g7":1.54070961475372,"g8":1.62181854248047,"g9":null,"g10":2.6219334602356},
{"x":1958,"g1":2.72904777526855,"g2":2.43233871459961,"g3":2.29725193977356,"g4":2.60595202445984,"g5":2.9819438457489,"g6":1.93289959430695,"g7":1.55413401126862,"g8":1.62773776054382,"g9":null,"g10":2.62410020828247},
{"x":1959,"g1":2.73788905143738,"g2":2.41809797286987,"g3":2.30229759216309,"g4":2.61773467063904,"g5":2.98709297180176,"g6":1.93764817714691,"g7":1.56767535209656,"g8":1.63367867469788,"g9":null,"g10":2.6262686252594},
{"x":1960,"g1":2.74675846099854,"g2":2.40394067764282,"g3":2.30735445022583,"g4":2.62957048416138,"g5":2.99225115776062,"g6":1.94240832328796,"g7":1.58133471012115,"g8":1.63964116573334,"g9":null,"g10":2.62843894958496},
{"x":1961,"g1":2.76815295219421,"g2":2.42698168754578,"g3":2.30882883071899,"g4":2.64926934242249,"g5":3.01036620140076,"g6":1.96002614498138,"g7":1.59134590625763,"g8":1.64656746387482,"g9":null,"g10":2.65571403503418},
{"x":1962,"g1":2.78971362113953,"g2":2.45024347305298,"g3":2.31030416488647,"g4":2.66911578178406,"g5":3.0285906791687,"g6":1.9778037071228,"g7":1.60142040252686,"g8":1.65352284908295,"g9":null,"g10":2.68327212333679},
{"x":1963,"g1":2.81144237518311,"g2":2.47372841835022,"g3":2.31178045272827,"g4":2.68911075592041,"g5":3.04692554473877,"g6":1.99574267864227,"g7":1.61155879497528,"g8":1.66050779819489,"g9":null,"g10":2.71111607551575},
{"x":1964,"g1":2.83334064483643,"g2":2.49743819236755,"g3":2.31325745582581,"g4":2.70925569534302,"g5":3.06537127494812,"g6":2.01384425163269,"g7":1.62176120281219,"g8":1.66752219200134,"g9":null,"g10":2.73924899101257},
{"x":1965,"g1":2.8554093837738,"g2":2.52137541770935,"g3":2.31473565101624,"g4":2.72955131530762,"g5":3.08392906188965,"g6":2.03210997581482,"g7":1.63202834129334,"g8":1.67456614971161,"g9":null,"g10":2.7676739692688},
{"x":1966,"g1":2.87764978408813,"g2":2.54554200172424,"g3":2.32342505455017,"g4":2.74999904632568,"g5":3.10259890556335,"g6":2.05054140090942,"g7":1.64236044883728,"g8":1.66442310810089,"g9":null,"g10":2.79639387130737},
{"x":1967,"g1":2.90006351470947,"g2":2.56668210029602,"g3":2.33214712142944,"g4":2.77060008049011,"g5":3.12138175964355,"g6":2.06913995742798,"g7":1.6527578830719,"g8":1.65434145927429,"g9":null,"g10":2.82541155815125},
{"x":1968,"g1":2.92265176773071,"g2":2.58321928977966,"g3":2.34090185165405,"g4":2.79135537147522,"g5":3.14027833938599,"g6":2.08790731430054,"g7":1.66322124004364,"g8":1.64432096481323,"g9":null,"g10":2.8547306060791},
{"x":1969,"g1":2.94541621208191,"g2":2.59986281394959,"g3":2.34968948364258,"g4":2.81226634979248,"g5":3.15928936004639,"g6":2.10684466362,"g7":1.67375075817108,"g8":1.63436114788055,"g9":null,"g10":2.88435387611389},
{"x":1970,"g1":2.96835780143738,"g2":2.61661386489868,"g3":2.35851001739502,"g4":2.83333349227905,"g5":3.17841553688049,"g6":2.12595391273499,"g7":1.68434691429138,"g8":1.62446165084839,"g9":null,"g10":2.91428446769714},
{"x":1971,"g1":2.99199271202087,"g2":2.63369941711426,"g3":2.37448811531067,"g4":2.85760188102722,"g5":3.19294023513794,"g6":2.15060162544251,"g7":1.69703042507172,"g8":1.66291034221649,"g9":null,"g10":2.93968844413757},
{"x":1972,"g1":3.01581621170044,"g2":2.65089702606201,"g3":2.39057421684265,"g4":2.88207769393921,"g5":3.20753145217896,"g6":2.17553520202637,"g7":1.70964860916138,"g8":1.70226907730103,"g9":null,"g10":2.96531367301941},
{"x":1973,"g1":3.03982925415039,"g2":2.66820645332336,"g3":2.40676927566528,"g4":2.90676331520081,"g5":3.22218918800354,"g6":2.2007577419281,"g7":1.7193431854248,"g8":1.73427331447601,"g9":null,"g10":2.99116253852844},
{"x":1974,"g1":3.06403350830078,"g2":2.68562889099121,"g3":2.4230740070343,"g4":2.93166065216064,"g5":3.23691391944885,"g6":2.22627258300781,"g7":1.72909271717072,"g8":1.76512312889099,"g9":null,"g10":3.01723647117615},
{"x":1975,"g1":3.08843040466309,"g2":2.70316529273987,"g3":2.43948936462402,"g4":2.9567711353302,"g5":3.25170612335205,"g6":2.25208330154419,"g7":1.73889756202698,"g8":1.79652154445648,"g9":null,"g10":3.04353785514832},
{"x":1976,"g1":3.11302161216736,"g2":2.72081637382507,"g3":2.46554780006409,"g4":2.98209643363953,"g5":3.26656579971313,"g6":2.27819347381592,"g7":1.74875795841217,"g8":1.82650852203369,"g9":null,"g10":3.070068359375},
{"x":1977,"g1":3.13780879974365,"g2":2.73858237266541,"g3":2.49188494682312,"g4":3.00763869285584,"g5":3.28149342536926,"g6":2.30460619926453,"g7":1.75867426395416,"g8":1.85699594020844,"g9":null,"g10":3.09683012962341},
{"x":1978,"g1":3.16279315948486,"g2":2.75646448135376,"g3":2.51850318908691,"g4":3.03339982032776,"g5":3.29648923873901,"g6":2.3313250541687,"g7":1.76864683628082,"g8":1.88799226284027,"g9":null,"g10":3.12382531166077},
{"x":1979,"g1":3.18797659873962,"g2":2.77446341514587,"g3":2.54540586471558,"g4":3.05938172340393,"g5":3.31155347824097,"g6":2.35835385322571,"g7":1.77867591381073,"g8":1.91950595378876,"g9":null,"g10":3.15105581283569},
{"x":1980,"g1":3.21336030960083,"g2":2.79257988929749,"g3":2.56846761703491,"g4":3.08558583259583,"g5":3.32668662071228,"g6":2.38569593429565,"g7":1.78876197338104,"g8":1.95154571533203,"g9":null,"g10":3.17852354049683},
{"x":1981,"g1":3.23260474205017,"g2":2.80937480926514,"g3":2.58712148666382,"g4":3.10549879074097,"g5":3.34009194374084,"g6":2.41290974617004,"g7":1.80154001712799,"g8":1.98035299777985,"g9":null,"g10":3.2028431892395},
{"x":1982,"g1":3.25196480751038,"g2":2.82627105712891,"g3":2.60591077804565,"g4":3.12554049491882,"g5":3.35355138778687,"g6":2.44043397903442,"g7":1.81440949440002,"g8":2.00958561897278,"g9":null,"g10":3.22734904289246},
{"x":1983,"g1":3.27144050598145,"g2":2.84326887130737,"g3":2.62483692169189,"g4":3.14571118354797,"g5":3.36706471443176,"g6":2.46827220916748,"g7":1.8273708820343,"g8":2.03924965858459,"g9":null,"g10":3.25204229354858},
{"x":1984,"g1":3.29103326797485,"g2":2.8603687286377,"g3":2.64390015602112,"g4":3.16601204872131,"g5":3.38063263893127,"g6":2.49642777442932,"g7":1.84042477607727,"g8":2.06935167312622,"g9":null,"g10":3.27692437171936},
{"x":1985,"g1":3.31074285507202,"g2":2.87757158279419,"g3":2.6631019115448,"g4":3.18644404411316,"g5":3.39425539970398,"g6":2.52490472793579,"g7":1.85357201099396,"g8":2.09989786148071,"g9":null,"g10":3.30199670791626},
{"x":1986,"g1":3.33057069778442,"g2":2.89487767219543,"g3":2.68182873725891,"g4":3.20700788497925,"g5":3.40793299674988,"g6":2.55370664596558,"g7":1.86681318283081,"g8":2.12909865379334,"g9":null,"g10":3.32726120948792},
{"x":1987,"g1":3.35051727294922,"g2":2.91228818893433,"g3":2.70068693161011,"g4":3.22770428657532,"g5":3.42166566848755,"g6":2.57534694671631,"g7":1.88014888763428,"g8":2.15870547294617,"g9":null,"g10":3.35271883010864},
{"x":1988,"g1":3.37058329582214,"g2":2.92980313301086,"g3":2.71967816352844,"g4":3.24853444099426,"g5":3.43545341491699,"g6":2.59508895874023,"g7":1.8935798406601,"g8":2.18872404098511,"g9":null,"g10":3.37837147712708},
{"x":1989,"g1":3.39076972007751,"g2":2.94742369651794,"g3":2.7388026714325,"g4":3.26949906349182,"g5":3.44929718971252,"g6":2.61498236656189,"g7":1.907106757164,"g8":2.21916007995605,"g9":null,"g10":3.40422010421753},
{"x":1990,"g1":3.41107678413391,"g2":2.96514987945557,"g3":2.75806164741516,"g4":3.29059886932373,"g5":3.46319651603699,"g6":2.63502812385559,"g7":1.92073035240173,"g8":2.25001931190491,"g9":3.11439180374146,"g10":3.43026661872864},
{"x":1991,"g1":3.42362284660339,"g2":2.97999858856201,"g3":2.7838830947876,"g4":3.31135082244873,"g5":3.46966695785522,"g6":2.64981174468994,"g7":1.94368135929108,"g8":2.27053880691528,"g9":3.16500663757324,"g10":3.44363522529602},
{"x":1992,"g1":3.43621516227722,"g2":2.99492192268372,"g3":2.80994606018066,"g4":3.33223342895508,"g5":3.476149559021,"g6":2.66467809677124,"g7":1.96690678596497,"g8":2.29124546051025,"g9":3.21644353866577,"g10":3.45705556869507},
{"x":1993,"g1":3.4488537311554,"g2":3.0099196434021,"g3":2.83625316619873,"g4":3.35324788093567,"g5":3.48264408111572,"g6":2.67962789535522,"g7":1.99040949344635,"g8":2.31214094161987,"g9":3.26871681213379,"g10":3.47052812576294},
{"x":1994,"g1":3.46153879165649,"g2":3.02499294281006,"g3":2.86280655860901,"g4":3.37439489364624,"g5":3.48915100097656,"g6":2.69466161727905,"g7":2.0141932964325,"g8":2.33322715759277,"g9":3.32183933258057,"g10":3.48405337333679},
{"x":1995,"g1":3.4742705821991,"g2":3.04014134407043,"g3":2.88960862159729,"g4":3.39567494392395,"g5":3.49566984176636,"g6":2.70977973937988,"g7":2.03826117515564,"g8":2.35450530052185,"g9":3.37582540512085,"g10":3.49763154983521},
{"x":1996,"g1":3.48704934120178,"g2":3.05536556243897,"g3":2.90622019767761,"g4":3.41708946228027,"g5":3.50220084190369,"g6":2.72498273849487,"g7":2.06261658668518,"g8":2.36827611923218,"g9":3.41450190544128,"g10":3.51126217842102},
{"x":1997,"g1":3.49987483024597,"g2":3.07066631317139,"g3":2.92292714118958,"g4":3.43863916397095,"g5":3.50874423980713,"g6":2.7402708530426,"g7":2.0872631072998,"g8":2.38212728500366,"g9":3.45362114906311,"g10":3.52494621276855},
{"x":1998,"g1":3.5127477645874,"g2":3.08604335784912,"g3":2.93973064422607,"g4":3.46032452583313,"g5":3.51529979705811,"g6":2.75564479827881,"g7":2.11220407485962,"g8":2.39605975151062,"g9":3.49318885803223,"g10":3.53868365287781},
{"x":1999,"g1":3.52566766738892,"g2":3.10149765014648,"g3":2.95663022994995,"g4":3.48214673995972,"g5":3.5218677520752,"g6":2.77110481262207,"g7":2.13744306564331,"g8":2.41007351875305,"g9":3.53320980072022,"g10":3.55247449874878},
{"x":2000,"g1":3.53863549232483,"g2":3.11702919006348,"g3":2.9736270904541,"g4":3.50410676002502,"g5":3.52844762802124,"g6":2.7866518497467,"g7":2.16298365592957,"g8":2.42416906356812,"g9":3.57368922233582,"g10":3.56631898880005},
{"x":2001,"g1":3.52751183509827,"g2":3.13323092460632,"g3":2.99241900444031,"g4":3.51891613006592,"g5":3.53894829750061,"g6":2.80529260635376,"g7":2.18431115150452,"g8":2.44833302497864,"g9":3.58205246925354,"g10":3.57492637634277},
{"x":2002,"g1":3.51642346382141,"g2":3.14951682090759,"g3":3.01132941246033,"g4":3.53378772735596,"g5":3.54948043823242,"g6":2.82405781745911,"g7":2.20584893226624,"g8":2.47273755073547,"g9":3.59043526649475,"g10":3.58355450630188},
{"x":2003,"g1":3.50536966323853,"g2":3.16588711738586,"g3":3.03035950660706,"g4":3.54872250556946,"g5":3.56004357337952,"g6":2.84294891357422,"g7":2.22759914398193,"g8":2.49738550186157,"g9":3.59883761405945,"g10":3.59220337867737},
{"x":2004,"g1":3.49435067176819,"g2":3.18234300613403,"g3":3.04950976371765,"g4":3.56372046470642,"g5":3.57063841819763,"g6":2.8619658946991,"g7":2.24956393241882,"g8":2.52227926254272,"g9":3.60725975036621,"g10":3.60087323188782},
{"x":2005,"g1":3.4833664894104,"g2":3.19888401031494,"g3":3.06878113746643,"g4":3.57878160476685,"g5":3.58126473426819,"g6":2.88111042976379,"g7":2.27174520492554,"g8":2.54742097854614,"g9":3.61570143699646,"g10":3.60956406593323},
{"x":2006,"g1":3.472416639328,"g2":3.21551084518433,"g3":3.07356929779053,"g4":3.59390640258789,"g5":3.59192276000977,"g6":2.90038323402405,"g7":2.29414510726929,"g8":2.5419225692749,"g9":3.61983227729797,"g10":3.61827564239502},
{"x":2007,"g1":3.46150135993958,"g2":3.23222470283508,"g3":3.07836484909058,"g4":3.60909533500671,"g5":3.60261249542236,"g6":2.91978454589844,"g7":2.31676602363586,"g8":2.53643584251404,"g9":3.62396788597107,"g10":3.62700843811035},
{"x":2008,"g1":3.45062017440796,"g2":3.24902486801147,"g3":3.08316802978516,"g4":3.62434840202332,"g5":3.6133337020874,"g6":2.93931579589844,"g7":2.3396098613739,"g8":2.53096103668213,"g9":3.62810850143433,"g10":3.63576221466064},
{"x":2009,"g1":3.43977355957031,"g2":3.26591277122498,"g3":3.08797860145569,"g4":3.6396656036377,"g5":3.62408709526062,"g6":2.95897746086121,"g7":2.36267900466919,"g8":2.52549815177918,"g9":3.63225340843201,"g10":3.64453721046448},
{"x":2010,"g1":3.4289608001709,"g2":3.28288817405701,"g3":3.09279680252075,"g4":3.65504789352417,"g5":3.63487243652344,"g6":2.97877097129822,"g7":2.38597559928894,"g8":2.5200469493866,"g9":3.63640332221985,"g10":3.65333318710327},
{"x":2011,"g1":3.44216704368591,"g2":3.29365229606628,"g3":3.09899544715881,"g4":3.66232514381409,"g5":3.64234471321106,"g6":2.9968798160553,"g7":2.41068816184998,"g8":2.54592204093933,"g9":3.65747833251953,"g10":3.65577626228333},
{"x":2012,"g1":3.45542430877686,"g2":3.30445194244385,"g3":3.10520648956299,"g4":3.66961669921875,"g5":3.64983224868774,"g6":3.01509833335876,"g7":2.43565678596497,"g8":2.56810927391052,"g9":3.67071223258972,"g10":3.65822052955627},
{"x":2013,"g1":3.4687328338623,"g2":3.31528687477112,"g3":3.11142992973328,"g4":3.67692279815674,"g5":3.65733528137207,"g6":3.03342795372009,"g7":2.46088433265686,"g8":2.5858325958252,"g9":3.69198608398438,"g10":3.66066670417786},
{"x":2014,"g1":3.48209238052368,"g2":3.32615733146668,"g3":3.11766600608826,"g4":3.68424344062805,"g5":3.66485381126404,"g6":3.05186891555786,"g7":2.48637270927429,"g8":2.60367846488953,"g9":3.70266890525818,"g10":3.66311454772949},
{"x":2015,"g1":3.49550342559814,"g2":3.33706331253052,"g3":3.12391448020935,"g4":3.69157862663269,"g5":3.67238759994507,"g6":3.07042193412781,"g7":2.51212525367737,"g8":2.62164735794067,"g9":3.71070146560669,"g10":3.66556406021118},
{"x":2016,"g1":3.50896620750427,"g2":3.3480052947998,"g3":3.13017559051514,"g4":3.69892859458923,"g5":3.67993688583374,"g6":3.08908796310425,"g7":2.53814482688904,"g8":2.63974022865295,"g9":3.72951197624207,"g10":3.66801500320435},
{"x":2017,"g1":3.52248072624207,"g2":3.35898303985596,"g3":3.13644909858704,"g4":3.7062931060791,"g5":3.68750190734863,"g6":3.10786700248718,"g7":2.5629780292511,"g8":2.65795803070068,"g9":3.74300670623779,"g10":3.67046761512756},
{"x":2018,"g1":3.53604745864868,"g2":3.36999678611755,"g3":3.14273524284363,"g4":3.7136721611023,"g5":3.69508242607117,"g6":3.12676072120667,"g7":2.58082032203674,"g8":2.67630171775818,"g9":3.75383734703064,"g10":3.67292213439941},
{"x":2019,"g1":3.54966616630554,"g2":3.38104629516602,"g3":3.14903402328491,"g4":3.72106599807739,"g5":3.70267844200134,"g6":3.14576888084412,"g7":2.59878706932068,"g8":2.6947717666626,"g9":3.76469922065735,"g10":3.67537784576416},
{"x":2020,"g1":3.56333756446838,"g2":3.39213252067566,"g3":3.15534543991089,"g4":3.72847461700439,"g5":3.71028995513916,"g6":3.16489291191101,"g7":2.61687898635864,"g8":2.71336936950684,"g9":3.76918435096741,"g10":3.67783570289612},
{"x":2021,"g1":3.5980269908905,"g2":3.41118836402893,"g3":3.16043567657471,"g4":3.73541975021362,"g5":3.72179746627808,"g6":3.18922209739685,"g7":2.63825917243958,"g8":2.70895266532898,"g9":3.77368021011353,"g10":3.68691277503967},
{"x":2022,"g1":3.62050604820251,"g2":3.43048191070557,"g3":3.16554522514343,"g4":3.75202083587647,"g5":3.73337984085083,"g6":3.21398735046387,"g7":2.6601254940033,"g8":2.70455527305603,"g9":3.77818751335144,"g10":3.69603681564331},
{"x":2023,"g1":3.60863065719605,"g2":3.45001626014709,"g3":3.17067384719849,"g4":3.76877570152283,"g5":3.74503779411316,"g6":3.23919916152954,"g7":2.68249130249023,"g8":2.70017671585083,"g9":3.78270554542542,"g10":3.70520830154419}];
    const series = [{"name":"AUS","color":"#1f77b4","key":"g1","dash":""},{"name":"AUT","color":"#ff7f0e","key":"g2","dash":""},{"name":"BEL","color":"#2ca02c","key":"g3","dash":""},{"name":"CAN","color":"#d62728","key":"g4","dash":""},{"name":"CHE","color":"#9467bd","key":"g5","dash":""},{"name":"CHL","color":"#8c564b","key":"g6","dash":""},{"name":"COL","color":"#e377c2","key":"g7","dash":""},{"name":"CRI","color":"#7f7f7f","key":"g8","dash":""},{"name":"CZE","color":"#bcbd22","key":"g9","dash":""},{"name":"DEU","color":"#17becf","key":"g10","dash":""}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#pd_95');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Time') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Time');
    if('') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>