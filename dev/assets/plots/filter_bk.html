<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Baxter-King Band-Pass Filter ([6, 32], K=12)</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">Baxter-King Band-Pass Filter ([6, 32], K=12)</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">Trend-Cycle Decomposition</div>
<div id="filt_tc_67"></div>
</div>
<div class="panel">
<div class="panel-title">Cyclical Component</div>
<div id="filt_cy_68"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":13,"trend":-2.7275319785058016,"cycle":-4.056761780961535,"orig":-6.784293759467337,"zero":0},
{"x":14,"trend":-1.6977139385365847,"cycle":-3.7943801334995193,"orig":-5.492094072036104,"zero":0},
{"x":15,"trend":-2.8883385758758098,"cycle":-3.091942272311956,"orig":-5.980280848187766,"zero":0},
{"x":16,"trend":-2.374617552293688,"cycle":-2.0923191702131074,"orig":-4.466936722506795,"zero":0},
{"x":17,"trend":-2.2504200013889704,"cycle":-0.9336878236481763,"orig":-3.1841078250371466,"zero":0},
{"x":18,"trend":-1.619419600206015,"cycle":0.22820016222405684,"orig":-1.3912194379819582,"zero":0},
{"x":19,"trend":-1.9819230734090776,"cycle":1.1744228022969725,"orig":-0.807500271112105,"zero":0},
{"x":20,"trend":-1.686968488027258,"cycle":1.6920338487730733,"orig":0.005065360745815428,"zero":0},
{"x":21,"trend":-0.4756133601194783,"cycle":1.7215320483826066,"orig":1.2459186882631283,"zero":0},
{"x":22,"trend":-1.135154490573151,"cycle":1.4582989836490534,"orig":0.32314449307590254,"zero":0},
{"x":23,"trend":-1.499292173792504,"cycle":1.2122934340618081,"orig":-0.2869987397306958,"zero":0},
{"x":24,"trend":-0.26137625385536356,"cycle":1.1113903061544737,"orig":0.8500140522991101,"zero":0},
{"x":25,"trend":-0.07107376114996966,"cycle":1.1463317080014293,"orig":1.0752579468514596,"zero":0},
{"x":26,"trend":0.04050561460672064,"cycle":1.1870731740088818,"orig":1.2275787886156024,"zero":0},
{"x":27,"trend":0.07335704590381775,"cycle":1.0311976416704227,"orig":1.1045546875742405,"zero":0},
{"x":28,"trend":-0.48447798878065473,"cycle":0.6539271220862842,"orig":0.1694491333056295,"zero":0},
{"x":29,"trend":0.2916163985967567,"cycle":0.18309022906473055,"orig":0.47470662766148725,"zero":0},
{"x":30,"trend":0.3051410150883985,"cycle":-0.12079473244702824,"orig":0.18434628264137032,"zero":0},
{"x":31,"trend":0.33807136399746623,"cycle":-0.0033354130936722876,"orig":0.33473595090379393,"zero":0},
{"x":32,"trend":-0.4372218760756518,"cycle":0.6055936239831633,"orig":0.16837174790751147,"zero":0},
{"x":33,"trend":-0.38797951527454555,"cycle":1.4493493350041697,"orig":1.0613698197296242,"zero":0},
{"x":34,"trend":-1.0012632869537184,"cycle":2.0949651133016185,"orig":1.0937018263479001,"zero":0},
{"x":35,"trend":-0.8175626481745493,"cycle":2.27860914383667,"orig":1.4610464956621207,"zero":0},
{"x":36,"trend":-0.06581686139093756,"cycle":2.0003675925621445,"orig":1.934550731171207,"zero":0},
{"x":37,"trend":-1.702408954461211,"cycle":1.435591477738308,"orig":-0.2668174767229031,"zero":0},
{"x":38,"trend":-1.8960106086405002,"cycle":0.8090065852176086,"orig":-1.0870040234228915,"zero":0},
{"x":39,"trend":-2.4510888875796204,"cycle":0.22256144814007245,"orig":-2.228527439439548,"zero":0},
{"x":40,"trend":-2.0590075853140934,"cycle":-0.3804131146098367,"orig":-2.43942069992393,"zero":0},
{"x":41,"trend":-2.005414894536129,"cycle":-1.1163526706308993,"orig":-3.1217675651670285,"zero":0},
{"x":42,"trend":-2.4955679772599932,"cycle":-1.9491267549675566,"orig":-4.44469473222755,"zero":0},
{"x":43,"trend":-3.7088311261664004,"cycle":-2.562716842236903,"orig":-6.271547968403303,"zero":0},
{"x":44,"trend":-3.692032930377283,"cycle":-2.588054971648053,"orig":-6.280087902025336,"zero":0},
{"x":45,"trend":-3.063532550172545,"cycle":-1.949355703302747,"orig":-5.0128882534752925,"zero":0},
{"x":46,"trend":-3.5451906105024893,"cycle":-0.9325679751761526,"orig":-4.477758585678642,"zero":0},
{"x":47,"trend":-3.8252040054884535,"cycle":-0.08428562804823159,"orig":-3.909489633536685,"zero":0},
{"x":48,"trend":-3.936182466830004,"cycle":0.16847476173880724,"orig":-3.7677077050911967,"zero":0},
{"x":49,"trend":-4.096296811679491,"cycle":-0.1987776218864678,"orig":-4.295074433565959,"zero":0},
{"x":50,"trend":-3.6552342683820966,"cycle":-0.7279221950649641,"orig":-4.383156463447061,"zero":0},
{"x":51,"trend":-4.572003641303386,"cycle":-0.9961459898783845,"orig":-5.568149631181771,"zero":0},
{"x":52,"trend":-3.992484858230706,"cycle":-0.8554516402082485,"orig":-4.847936498438955,"zero":0},
{"x":53,"trend":-3.509763186877708,"cycle":-0.503113074287667,"orig":-4.012876261165375,"zero":0},
{"x":54,"trend":-3.536308058879166,"cycle":-0.274152582925416,"orig":-3.810460641804582,"zero":0},
{"x":55,"trend":-4.765784391414409,"cycle":-0.29705143527454647,"orig":-5.062835826688956,"zero":0},
{"x":56,"trend":-2.747380607567189,"cycle":-0.36425063495275256,"orig":-3.111631242519942,"zero":0},
{"x":57,"trend":-4.122240793431701,"cycle":-0.18511996529623118,"orig":-4.307360758727932,"zero":0},
{"x":58,"trend":-3.5729776585333246,"cycle":0.32140002364724807,"orig":-3.2515776348860768,"zero":0},
{"x":59,"trend":-3.940333236422915,"cycle":0.9328303166075284,"orig":-3.0075029198153866,"zero":0},
{"x":60,"trend":-2.47910418037842,"cycle":1.3275637505917095,"orig":-1.1515404297867105,"zero":0},
{"x":61,"trend":-4.333026278405297,"cycle":1.431806628934401,"orig":-2.901219649470897,"zero":0},
{"x":62,"trend":-3.2955367681734327,"cycle":1.4094103869178707,"orig":-1.8861263812555622,"zero":0},
{"x":63,"trend":-3.4923764558488304,"cycle":1.4899749416714947,"orig":-2.0024015141773357,"zero":0},
{"x":64,"trend":-4.615361485163753,"cycle":1.7536598490698283,"orig":-2.8617016360939247,"zero":0},
{"x":65,"trend":-4.575458637667211,"cycle":1.966160051428162,"orig":-2.6092985862390488,"zero":0},
{"x":66,"trend":-3.8035923428977987,"cycle":1.798746217736157,"orig":-2.0048461251616416,"zero":0},
{"x":67,"trend":-4.225906726283432,"cycle":1.1682830301094,"orig":-3.0576236961740317,"zero":0},
{"x":68,"trend":-5.089977571080057,"cycle":0.4030117738389936,"orig":-4.686965797241063,"zero":0},
{"x":69,"trend":-6.308473199490938,"cycle":-0.05108156933011759,"orig":-6.359554768821055,"zero":0},
{"x":70,"trend":-6.503546342565851,"cycle":0.09620423720199511,"orig":-6.407342105363856,"zero":0},
{"x":71,"trend":-4.951953037150743,"cycle":0.6897581754857941,"orig":-4.262194861664949,"zero":0},
{"x":72,"trend":-6.8987542018458985,"cycle":1.2243779924776494,"orig":-5.6743762093682495,"zero":0},
{"x":73,"trend":-7.4804719329986815,"cycle":1.1880074167194643,"orig":-6.292464516279217,"zero":0},
{"x":74,"trend":-7.471294416692129,"cycle":0.5627079128047108,"orig":-6.908586503887419,"zero":0},
{"x":75,"trend":-8.30679817963716,"cycle":-0.3143085464737523,"orig":-8.621106726110913,"zero":0},
{"x":76,"trend":-8.556053383607484,"cycle":-1.0373222690424992,"orig":-9.593375652649984,"zero":0},
{"x":77,"trend":-9.207370823156038,"cycle":-1.4343133385228175,"orig":-10.641684161678857,"zero":0},
{"x":78,"trend":-9.24006703476217,"cycle":-1.6313706109613217,"orig":-10.871437645723491,"zero":0},
{"x":79,"trend":-9.66962673073445,"cycle":-1.8171847410411621,"orig":-11.486811471775612,"zero":0},
{"x":80,"trend":-10.319331053873094,"cycle":-1.9832090750664844,"orig":-12.30254012893958,"zero":0},
{"x":81,"trend":-10.703750976334918,"cycle":-1.8746131485863498,"orig":-12.578364124921269,"zero":0},
{"x":82,"trend":-10.961318889157472,"cycle":-1.2688303699234096,"orig":-12.230149259080882,"zero":0},
{"x":83,"trend":-11.920093998741951,"cycle":-0.2601766716774365,"orig":-12.180270670419388,"zero":0},
{"x":84,"trend":-10.832047687027192,"cycle":0.7197143640240858,"orig":-10.112333323003106,"zero":0},
{"x":85,"trend":-11.7548868092822,"cycle":1.256093715703816,"orig":-10.498793093578383,"zero":0},
{"x":86,"trend":-12.426302610359675,"cycle":1.1483912540529688,"orig":-11.277911356306706,"zero":0},
{"x":87,"trend":-13.0629443567198,"cycle":0.5575185925706786,"orig":-12.505425764149122,"zero":0},
{"x":88,"trend":-12.615044018784037,"cycle":-0.045365909269448834,"orig":-12.660409928053486,"zero":0},
{"x":89,"trend":-12.390578891649357,"cycle":-0.1746181549505273,"orig":-12.565197046599884,"zero":0},
{"x":90,"trend":-13.874512593061135,"cycle":0.23338142422925384,"orig":-13.641131168831881,"zero":0},
{"x":91,"trend":-13.793631848189104,"cycle":0.8122540101097143,"orig":-12.98137783807939,"zero":0},
{"x":92,"trend":-14.266922829172234,"cycle":1.0843637825749501,"orig":-13.182559046597284,"zero":0},
{"x":93,"trend":-14.256337633939527,"cycle":0.80989230027371,"orig":-13.446445333665817,"zero":0},
{"x":94,"trend":-14.339140137722772,"cycle":0.15043620262041996,"orig":-14.188703935102353,"zero":0},
{"x":95,"trend":-14.56959405881466,"cycle":-0.43612533685499066,"orig":-15.00571939566965,"zero":0},
{"x":96,"trend":-15.902378648670261,"cycle":-0.5027552212121196,"orig":-16.40513386988238,"zero":0},
{"x":97,"trend":-15.702367933080973,"cycle":-0.09849268791043103,"orig":-15.800860620991404,"zero":0},
{"x":98,"trend":-16.089537069952712,"cycle":0.3470527935746981,"orig":-15.742484276378015,"zero":0},
{"x":99,"trend":-14.937869103408966,"cycle":0.37077066737942344,"orig":-14.567098436029543,"zero":0},
{"x":100,"trend":-17.085468807435287,"cycle":-0.1599909344139553,"orig":-17.245459741849242,"zero":0},
{"x":101,"trend":-17.076827631546735,"cycle":-0.9771864493171001,"orig":-18.054014080863833,"zero":0},
{"x":102,"trend":-16.759446787292124,"cycle":-1.6299422694671855,"orig":-18.38938905675931,"zero":0},
{"x":103,"trend":-17.49625669992383,"cycle":-1.7834282776389816,"orig":-19.279684977562813,"zero":0},
{"x":104,"trend":-17.630134659464616,"cycle":-1.4850767816114936,"orig":-19.11521144107611,"zero":0},
{"x":105,"trend":-17.5731259212681,"cycle":-1.0046353325473425,"orig":-18.577761253815442,"zero":0},
{"x":106,"trend":-16.669428483548327,"cycle":-0.5506819277558135,"orig":-17.22011041130414,"zero":0},
{"x":107,"trend":-19.01757312933326,"cycle":-0.15493753988664144,"orig":-19.172510669219903,"zero":0},
{"x":108,"trend":-19.006114521974208,"cycle":0.2516430874765274,"orig":-18.75447143449768,"zero":0},
{"x":109,"trend":-18.4172938716835,"cycle":0.7131373360143508,"orig":-17.70415653566915,"zero":0},
{"x":110,"trend":-17.957146067751932,"cycle":1.0651685725583744,"orig":-16.891977495193558,"zero":0},
{"x":111,"trend":-18.43508312342191,"cycle":1.139573447575567,"orig":-17.295509675846343,"zero":0},
{"x":112,"trend":-19.41247164853803,"cycle":0.8891957723846773,"orig":-18.523275876153352,"zero":0},
{"x":113,"trend":-19.586961650907686,"cycle":0.5378829548930011,"orig":-19.049078696014686,"zero":0},
{"x":114,"trend":-19.909515605669707,"cycle":0.32033983756946205,"orig":-19.589175768100244,"zero":0},
{"x":115,"trend":-19.58007847749137,"cycle":0.3142962389206774,"orig":-19.265782238570694,"zero":0},
{"x":116,"trend":-19.479957501096987,"cycle":0.4251749973072608,"orig":-19.054782503789728,"zero":0},
{"x":117,"trend":-20.210009577253157,"cycle":0.503651329669385,"orig":-19.706358247583772,"zero":0},
{"x":118,"trend":-21.216464612459614,"cycle":0.4778221876401415,"orig":-20.73864242481947,"zero":0},
{"x":119,"trend":-20.465210371371313,"cycle":0.3764910820492915,"orig":-20.08871928932202,"zero":0},
{"x":120,"trend":-21.64845159424821,"cycle":0.29992862354728345,"orig":-21.348522970700927,"zero":0},
{"x":121,"trend":-20.660344704746198,"cycle":0.21668254356937816,"orig":-20.44366216117682,"zero":0},
{"x":122,"trend":-21.57883864596538,"cycle":-0.013599115770171866,"orig":-21.592437761735553,"zero":0},
{"x":123,"trend":-21.39969278935337,"cycle":-0.4663306929776138,"orig":-21.866023482330984,"zero":0},
{"x":124,"trend":-22.217268548227384,"cycle":-1.0516938334892667,"orig":-23.26896238171665,"zero":0},
{"x":125,"trend":-21.94377881782774,"cycle":-1.5905489771891634,"orig":-23.534327795016903,"zero":0},
{"x":126,"trend":-22.505197521501632,"cycle":-1.9957305558294312,"orig":-24.500928077331064,"zero":0},
{"x":127,"trend":-21.930247987538944,"cycle":-2.2524142196387364,"orig":-24.182662207177682,"zero":0},
{"x":128,"trend":-21.87904665196903,"cycle":-2.3985030801765226,"orig":-24.277549732145552,"zero":0},
{"x":129,"trend":-22.17402385926349,"cycle":-2.3680825027278822,"orig":-24.542106361991372,"zero":0},
{"x":130,"trend":-22.49297308849938,"cycle":-1.9919236961694233,"orig":-24.484896784668802,"zero":0},
{"x":131,"trend":-22.40578573091112,"cycle":-1.1544641883230407,"orig":-23.56024991923416,"zero":0},
{"x":132,"trend":-22.052341929577207,"cycle":-0.0061883647098953665,"orig":-22.058530294287102,"zero":0},
{"x":133,"trend":-21.989944156773845,"cycle":1.099221946632122,"orig":-20.89072221014172,"zero":0},
{"x":134,"trend":-22.200401052335913,"cycle":1.754881161697036,"orig":-20.445519890638877,"zero":0},
{"x":135,"trend":-21.985420737371903,"cycle":1.8222545008620403,"orig":-20.163166236509863,"zero":0},
{"x":136,"trend":-22.56148636470609,"cycle":1.5368387901796678,"orig":-21.024647574526423,"zero":0},
{"x":137,"trend":-21.528575394375352,"cycle":1.2967537154386388,"orig":-20.23182167893671,"zero":0},
{"x":138,"trend":-22.517676515950054,"cycle":1.3641893210327691,"orig":-21.153487194917286,"zero":0},
{"x":139,"trend":-22.114018539558494,"cycle":1.6812337325721658,"orig":-20.432784806986326,"zero":0},
{"x":140,"trend":-22.353796079337517,"cycle":1.886684446385614,"orig":-20.4671116329519,"zero":0},
{"x":141,"trend":-22.23564609515245,"cycle":1.603616015461185,"orig":-20.632030079691265,"zero":0},
{"x":142,"trend":-22.229474319027872,"cycle":0.7788493652867287,"orig":-21.450624953741144,"zero":0},
{"x":143,"trend":-22.47725171499461,"cycle":-0.23863909515990778,"orig":-22.715890810154516,"zero":0},
{"x":144,"trend":-22.472031858052745,"cycle":-0.9910404379352813,"orig":-23.463072295988027,"zero":0},
{"x":145,"trend":-22.742447461174393,"cycle":-1.2495795848438211,"orig":-23.992027046018215,"zero":0},
{"x":146,"trend":-22.09948603574686,"cycle":-1.143847724400684,"orig":-23.243333760147543,"zero":0},
{"x":147,"trend":-23.0794060038476,"cycle":-1.0076754380888282,"orig":-24.087081441936427,"zero":0},
{"x":148,"trend":-22.707297539544122,"cycle":-1.1214567354288025,"orig":-23.828754274972923,"zero":0},
{"x":149,"trend":-22.705043830365646,"cycle":-1.5186123537087666,"orig":-24.223656184074414,"zero":0},
{"x":150,"trend":-23.04406963770763,"cycle":-1.9677936058852663,"orig":-25.011863243592895,"zero":0},
{"x":151,"trend":-23.40768789940678,"cycle":-2.1025534358354045,"orig":-25.510241335242185,"zero":0},
{"x":152,"trend":-23.02453928135638,"cycle":-1.6617452193105102,"orig":-24.68628450066689,"zero":0},
{"x":153,"trend":-22.260336704302734,"cycle":-0.6262480386746913,"orig":-22.886584742977426,"zero":0},
{"x":154,"trend":-23.077402879972418,"cycle":0.6963497472015805,"orig":-22.381053132770838,"zero":0},
{"x":155,"trend":-23.5475774771724,"cycle":1.8045398704970728,"orig":-21.743037606675326,"zero":0},
{"x":156,"trend":-23.232000639330856,"cycle":2.269813459460961,"orig":-20.962187179869893,"zero":0},
{"x":157,"trend":-22.457615222708586,"cycle":2.0341747054341717,"orig":-20.423440517274415,"zero":0},
{"x":158,"trend":-22.05669045343754,"cycle":1.364603084426455,"orig":-20.692087369011084,"zero":0},
{"x":159,"trend":-23.152073465672228,"cycle":0.5936415746702897,"orig":-22.558431891001938,"zero":0},
{"x":160,"trend":-22.908367138209123,"cycle":-0.07612823736606322,"orig":-22.984495375575186,"zero":0},
{"x":161,"trend":-23.118831101499495,"cycle":-0.6374209457823501,"orig":-23.756252047281844,"zero":0},
{"x":162,"trend":-22.360125461658956,"cycle":-1.11195724015516,"orig":-23.472082701814116,"zero":0},
{"x":163,"trend":-21.391702432132703,"cycle":-1.4644572552344584,"orig":-22.85615968736716,"zero":0},
{"x":164,"trend":-22.56202457719391,"cycle":-1.5245827391319628,"orig":-24.08660731632587,"zero":0},
{"x":165,"trend":-22.924169543499495,"cycle":-1.1379127401858877,"orig":-24.062082283685385,"zero":0},
{"x":166,"trend":-23.164750487457543,"cycle":-0.3657946344093961,"orig":-23.53054512186694,"zero":0},
{"x":167,"trend":-21.091706201712284,"cycle":0.485150202402418,"orig":-20.606555999309865,"zero":0},
{"x":168,"trend":-21.4192015183591,"cycle":0.9895551600867729,"orig":-20.429646358272326,"zero":0},
{"x":169,"trend":-22.178632134669634,"cycle":0.8545711310872558,"orig":-21.32406100358238,"zero":0},
{"x":170,"trend":-22.38893781925438,"cycle":0.17227523333630618,"orig":-22.216662585918073,"zero":0},
{"x":171,"trend":-21.839687084806723,"cycle":-0.626134286508273,"orig":-22.465821371314995,"zero":0},
{"x":172,"trend":-20.55839833980884,"cycle":-1.0761753295083825,"orig":-21.634573669317223,"zero":0},
{"x":173,"trend":-21.904297101382063,"cycle":-1.064188209783064,"orig":-22.96848531116513,"zero":0},
{"x":174,"trend":-21.001386228170926,"cycle":-0.7949953428406549,"orig":-21.79638157101158,"zero":0},
{"x":175,"trend":-20.582782786395303,"cycle":-0.5986580505865279,"orig":-21.18144083698183,"zero":0},
{"x":176,"trend":-20.604162418013868,"cycle":-0.5816135354123153,"orig":-21.185775953426184,"zero":0},
{"x":177,"trend":-20.7175822882192,"cycle":-0.6087549116177569,"orig":-21.32633719983696,"zero":0},
{"x":178,"trend":-20.17209961924329,"cycle":-0.4908785290885954,"orig":-20.662978148331884,"zero":0},
{"x":179,"trend":-20.058611808853072,"cycle":-0.13110730198972897,"orig":-20.189719110842802,"zero":0},
{"x":180,"trend":-19.265931156607248,"cycle":0.34273722100210574,"orig":-18.92319393560514,"zero":0},
{"x":181,"trend":-19.342341837621642,"cycle":0.8026977343673953,"orig":-18.539644103254247,"zero":0},
{"x":182,"trend":-19.32721497112836,"cycle":1.1205604703104914,"orig":-18.20665450081787,"zero":0},
{"x":183,"trend":-19.843288747622605,"cycle":1.1851634426694977,"orig":-18.658125304953106,"zero":0},
{"x":184,"trend":-18.273809180898134,"cycle":0.9736778175858349,"orig":-17.3001313633123,"zero":0},
{"x":185,"trend":-18.669788118494584,"cycle":0.5896822306112173,"orig":-18.080105887883366,"zero":0},
{"x":186,"trend":-17.307727280526198,"cycle":0.22814960173125387,"orig":-17.079577678794944,"zero":0},
{"x":187,"trend":-18.74484070168578,"cycle":-0.03547135975829052,"orig":-18.78031206144407,"zero":0},
{"x":188,"trend":-18.83436411110933,"cycle":-0.30183911420526655,"orig":-19.136203225314595,"zero":0}];
    const series = [{"name":"Original","color":"#1f77b4","key":"orig","dash":""},{"name":"Trend","color":"#ff7f0e","key":"trend","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#filt_tc_67');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":13,"trend":-2.7275319785058016,"cycle":-4.056761780961535,"orig":-6.784293759467337,"zero":0},
{"x":14,"trend":-1.6977139385365847,"cycle":-3.7943801334995193,"orig":-5.492094072036104,"zero":0},
{"x":15,"trend":-2.8883385758758098,"cycle":-3.091942272311956,"orig":-5.980280848187766,"zero":0},
{"x":16,"trend":-2.374617552293688,"cycle":-2.0923191702131074,"orig":-4.466936722506795,"zero":0},
{"x":17,"trend":-2.2504200013889704,"cycle":-0.9336878236481763,"orig":-3.1841078250371466,"zero":0},
{"x":18,"trend":-1.619419600206015,"cycle":0.22820016222405684,"orig":-1.3912194379819582,"zero":0},
{"x":19,"trend":-1.9819230734090776,"cycle":1.1744228022969725,"orig":-0.807500271112105,"zero":0},
{"x":20,"trend":-1.686968488027258,"cycle":1.6920338487730733,"orig":0.005065360745815428,"zero":0},
{"x":21,"trend":-0.4756133601194783,"cycle":1.7215320483826066,"orig":1.2459186882631283,"zero":0},
{"x":22,"trend":-1.135154490573151,"cycle":1.4582989836490534,"orig":0.32314449307590254,"zero":0},
{"x":23,"trend":-1.499292173792504,"cycle":1.2122934340618081,"orig":-0.2869987397306958,"zero":0},
{"x":24,"trend":-0.26137625385536356,"cycle":1.1113903061544737,"orig":0.8500140522991101,"zero":0},
{"x":25,"trend":-0.07107376114996966,"cycle":1.1463317080014293,"orig":1.0752579468514596,"zero":0},
{"x":26,"trend":0.04050561460672064,"cycle":1.1870731740088818,"orig":1.2275787886156024,"zero":0},
{"x":27,"trend":0.07335704590381775,"cycle":1.0311976416704227,"orig":1.1045546875742405,"zero":0},
{"x":28,"trend":-0.48447798878065473,"cycle":0.6539271220862842,"orig":0.1694491333056295,"zero":0},
{"x":29,"trend":0.2916163985967567,"cycle":0.18309022906473055,"orig":0.47470662766148725,"zero":0},
{"x":30,"trend":0.3051410150883985,"cycle":-0.12079473244702824,"orig":0.18434628264137032,"zero":0},
{"x":31,"trend":0.33807136399746623,"cycle":-0.0033354130936722876,"orig":0.33473595090379393,"zero":0},
{"x":32,"trend":-0.4372218760756518,"cycle":0.6055936239831633,"orig":0.16837174790751147,"zero":0},
{"x":33,"trend":-0.38797951527454555,"cycle":1.4493493350041697,"orig":1.0613698197296242,"zero":0},
{"x":34,"trend":-1.0012632869537184,"cycle":2.0949651133016185,"orig":1.0937018263479001,"zero":0},
{"x":35,"trend":-0.8175626481745493,"cycle":2.27860914383667,"orig":1.4610464956621207,"zero":0},
{"x":36,"trend":-0.06581686139093756,"cycle":2.0003675925621445,"orig":1.934550731171207,"zero":0},
{"x":37,"trend":-1.702408954461211,"cycle":1.435591477738308,"orig":-0.2668174767229031,"zero":0},
{"x":38,"trend":-1.8960106086405002,"cycle":0.8090065852176086,"orig":-1.0870040234228915,"zero":0},
{"x":39,"trend":-2.4510888875796204,"cycle":0.22256144814007245,"orig":-2.228527439439548,"zero":0},
{"x":40,"trend":-2.0590075853140934,"cycle":-0.3804131146098367,"orig":-2.43942069992393,"zero":0},
{"x":41,"trend":-2.005414894536129,"cycle":-1.1163526706308993,"orig":-3.1217675651670285,"zero":0},
{"x":42,"trend":-2.4955679772599932,"cycle":-1.9491267549675566,"orig":-4.44469473222755,"zero":0},
{"x":43,"trend":-3.7088311261664004,"cycle":-2.562716842236903,"orig":-6.271547968403303,"zero":0},
{"x":44,"trend":-3.692032930377283,"cycle":-2.588054971648053,"orig":-6.280087902025336,"zero":0},
{"x":45,"trend":-3.063532550172545,"cycle":-1.949355703302747,"orig":-5.0128882534752925,"zero":0},
{"x":46,"trend":-3.5451906105024893,"cycle":-0.9325679751761526,"orig":-4.477758585678642,"zero":0},
{"x":47,"trend":-3.8252040054884535,"cycle":-0.08428562804823159,"orig":-3.909489633536685,"zero":0},
{"x":48,"trend":-3.936182466830004,"cycle":0.16847476173880724,"orig":-3.7677077050911967,"zero":0},
{"x":49,"trend":-4.096296811679491,"cycle":-0.1987776218864678,"orig":-4.295074433565959,"zero":0},
{"x":50,"trend":-3.6552342683820966,"cycle":-0.7279221950649641,"orig":-4.383156463447061,"zero":0},
{"x":51,"trend":-4.572003641303386,"cycle":-0.9961459898783845,"orig":-5.568149631181771,"zero":0},
{"x":52,"trend":-3.992484858230706,"cycle":-0.8554516402082485,"orig":-4.847936498438955,"zero":0},
{"x":53,"trend":-3.509763186877708,"cycle":-0.503113074287667,"orig":-4.012876261165375,"zero":0},
{"x":54,"trend":-3.536308058879166,"cycle":-0.274152582925416,"orig":-3.810460641804582,"zero":0},
{"x":55,"trend":-4.765784391414409,"cycle":-0.29705143527454647,"orig":-5.062835826688956,"zero":0},
{"x":56,"trend":-2.747380607567189,"cycle":-0.36425063495275256,"orig":-3.111631242519942,"zero":0},
{"x":57,"trend":-4.122240793431701,"cycle":-0.18511996529623118,"orig":-4.307360758727932,"zero":0},
{"x":58,"trend":-3.5729776585333246,"cycle":0.32140002364724807,"orig":-3.2515776348860768,"zero":0},
{"x":59,"trend":-3.940333236422915,"cycle":0.9328303166075284,"orig":-3.0075029198153866,"zero":0},
{"x":60,"trend":-2.47910418037842,"cycle":1.3275637505917095,"orig":-1.1515404297867105,"zero":0},
{"x":61,"trend":-4.333026278405297,"cycle":1.431806628934401,"orig":-2.901219649470897,"zero":0},
{"x":62,"trend":-3.2955367681734327,"cycle":1.4094103869178707,"orig":-1.8861263812555622,"zero":0},
{"x":63,"trend":-3.4923764558488304,"cycle":1.4899749416714947,"orig":-2.0024015141773357,"zero":0},
{"x":64,"trend":-4.615361485163753,"cycle":1.7536598490698283,"orig":-2.8617016360939247,"zero":0},
{"x":65,"trend":-4.575458637667211,"cycle":1.966160051428162,"orig":-2.6092985862390488,"zero":0},
{"x":66,"trend":-3.8035923428977987,"cycle":1.798746217736157,"orig":-2.0048461251616416,"zero":0},
{"x":67,"trend":-4.225906726283432,"cycle":1.1682830301094,"orig":-3.0576236961740317,"zero":0},
{"x":68,"trend":-5.089977571080057,"cycle":0.4030117738389936,"orig":-4.686965797241063,"zero":0},
{"x":69,"trend":-6.308473199490938,"cycle":-0.05108156933011759,"orig":-6.359554768821055,"zero":0},
{"x":70,"trend":-6.503546342565851,"cycle":0.09620423720199511,"orig":-6.407342105363856,"zero":0},
{"x":71,"trend":-4.951953037150743,"cycle":0.6897581754857941,"orig":-4.262194861664949,"zero":0},
{"x":72,"trend":-6.8987542018458985,"cycle":1.2243779924776494,"orig":-5.6743762093682495,"zero":0},
{"x":73,"trend":-7.4804719329986815,"cycle":1.1880074167194643,"orig":-6.292464516279217,"zero":0},
{"x":74,"trend":-7.471294416692129,"cycle":0.5627079128047108,"orig":-6.908586503887419,"zero":0},
{"x":75,"trend":-8.30679817963716,"cycle":-0.3143085464737523,"orig":-8.621106726110913,"zero":0},
{"x":76,"trend":-8.556053383607484,"cycle":-1.0373222690424992,"orig":-9.593375652649984,"zero":0},
{"x":77,"trend":-9.207370823156038,"cycle":-1.4343133385228175,"orig":-10.641684161678857,"zero":0},
{"x":78,"trend":-9.24006703476217,"cycle":-1.6313706109613217,"orig":-10.871437645723491,"zero":0},
{"x":79,"trend":-9.66962673073445,"cycle":-1.8171847410411621,"orig":-11.486811471775612,"zero":0},
{"x":80,"trend":-10.319331053873094,"cycle":-1.9832090750664844,"orig":-12.30254012893958,"zero":0},
{"x":81,"trend":-10.703750976334918,"cycle":-1.8746131485863498,"orig":-12.578364124921269,"zero":0},
{"x":82,"trend":-10.961318889157472,"cycle":-1.2688303699234096,"orig":-12.230149259080882,"zero":0},
{"x":83,"trend":-11.920093998741951,"cycle":-0.2601766716774365,"orig":-12.180270670419388,"zero":0},
{"x":84,"trend":-10.832047687027192,"cycle":0.7197143640240858,"orig":-10.112333323003106,"zero":0},
{"x":85,"trend":-11.7548868092822,"cycle":1.256093715703816,"orig":-10.498793093578383,"zero":0},
{"x":86,"trend":-12.426302610359675,"cycle":1.1483912540529688,"orig":-11.277911356306706,"zero":0},
{"x":87,"trend":-13.0629443567198,"cycle":0.5575185925706786,"orig":-12.505425764149122,"zero":0},
{"x":88,"trend":-12.615044018784037,"cycle":-0.045365909269448834,"orig":-12.660409928053486,"zero":0},
{"x":89,"trend":-12.390578891649357,"cycle":-0.1746181549505273,"orig":-12.565197046599884,"zero":0},
{"x":90,"trend":-13.874512593061135,"cycle":0.23338142422925384,"orig":-13.641131168831881,"zero":0},
{"x":91,"trend":-13.793631848189104,"cycle":0.8122540101097143,"orig":-12.98137783807939,"zero":0},
{"x":92,"trend":-14.266922829172234,"cycle":1.0843637825749501,"orig":-13.182559046597284,"zero":0},
{"x":93,"trend":-14.256337633939527,"cycle":0.80989230027371,"orig":-13.446445333665817,"zero":0},
{"x":94,"trend":-14.339140137722772,"cycle":0.15043620262041996,"orig":-14.188703935102353,"zero":0},
{"x":95,"trend":-14.56959405881466,"cycle":-0.43612533685499066,"orig":-15.00571939566965,"zero":0},
{"x":96,"trend":-15.902378648670261,"cycle":-0.5027552212121196,"orig":-16.40513386988238,"zero":0},
{"x":97,"trend":-15.702367933080973,"cycle":-0.09849268791043103,"orig":-15.800860620991404,"zero":0},
{"x":98,"trend":-16.089537069952712,"cycle":0.3470527935746981,"orig":-15.742484276378015,"zero":0},
{"x":99,"trend":-14.937869103408966,"cycle":0.37077066737942344,"orig":-14.567098436029543,"zero":0},
{"x":100,"trend":-17.085468807435287,"cycle":-0.1599909344139553,"orig":-17.245459741849242,"zero":0},
{"x":101,"trend":-17.076827631546735,"cycle":-0.9771864493171001,"orig":-18.054014080863833,"zero":0},
{"x":102,"trend":-16.759446787292124,"cycle":-1.6299422694671855,"orig":-18.38938905675931,"zero":0},
{"x":103,"trend":-17.49625669992383,"cycle":-1.7834282776389816,"orig":-19.279684977562813,"zero":0},
{"x":104,"trend":-17.630134659464616,"cycle":-1.4850767816114936,"orig":-19.11521144107611,"zero":0},
{"x":105,"trend":-17.5731259212681,"cycle":-1.0046353325473425,"orig":-18.577761253815442,"zero":0},
{"x":106,"trend":-16.669428483548327,"cycle":-0.5506819277558135,"orig":-17.22011041130414,"zero":0},
{"x":107,"trend":-19.01757312933326,"cycle":-0.15493753988664144,"orig":-19.172510669219903,"zero":0},
{"x":108,"trend":-19.006114521974208,"cycle":0.2516430874765274,"orig":-18.75447143449768,"zero":0},
{"x":109,"trend":-18.4172938716835,"cycle":0.7131373360143508,"orig":-17.70415653566915,"zero":0},
{"x":110,"trend":-17.957146067751932,"cycle":1.0651685725583744,"orig":-16.891977495193558,"zero":0},
{"x":111,"trend":-18.43508312342191,"cycle":1.139573447575567,"orig":-17.295509675846343,"zero":0},
{"x":112,"trend":-19.41247164853803,"cycle":0.8891957723846773,"orig":-18.523275876153352,"zero":0},
{"x":113,"trend":-19.586961650907686,"cycle":0.5378829548930011,"orig":-19.049078696014686,"zero":0},
{"x":114,"trend":-19.909515605669707,"cycle":0.32033983756946205,"orig":-19.589175768100244,"zero":0},
{"x":115,"trend":-19.58007847749137,"cycle":0.3142962389206774,"orig":-19.265782238570694,"zero":0},
{"x":116,"trend":-19.479957501096987,"cycle":0.4251749973072608,"orig":-19.054782503789728,"zero":0},
{"x":117,"trend":-20.210009577253157,"cycle":0.503651329669385,"orig":-19.706358247583772,"zero":0},
{"x":118,"trend":-21.216464612459614,"cycle":0.4778221876401415,"orig":-20.73864242481947,"zero":0},
{"x":119,"trend":-20.465210371371313,"cycle":0.3764910820492915,"orig":-20.08871928932202,"zero":0},
{"x":120,"trend":-21.64845159424821,"cycle":0.29992862354728345,"orig":-21.348522970700927,"zero":0},
{"x":121,"trend":-20.660344704746198,"cycle":0.21668254356937816,"orig":-20.44366216117682,"zero":0},
{"x":122,"trend":-21.57883864596538,"cycle":-0.013599115770171866,"orig":-21.592437761735553,"zero":0},
{"x":123,"trend":-21.39969278935337,"cycle":-0.4663306929776138,"orig":-21.866023482330984,"zero":0},
{"x":124,"trend":-22.217268548227384,"cycle":-1.0516938334892667,"orig":-23.26896238171665,"zero":0},
{"x":125,"trend":-21.94377881782774,"cycle":-1.5905489771891634,"orig":-23.534327795016903,"zero":0},
{"x":126,"trend":-22.505197521501632,"cycle":-1.9957305558294312,"orig":-24.500928077331064,"zero":0},
{"x":127,"trend":-21.930247987538944,"cycle":-2.2524142196387364,"orig":-24.182662207177682,"zero":0},
{"x":128,"trend":-21.87904665196903,"cycle":-2.3985030801765226,"orig":-24.277549732145552,"zero":0},
{"x":129,"trend":-22.17402385926349,"cycle":-2.3680825027278822,"orig":-24.542106361991372,"zero":0},
{"x":130,"trend":-22.49297308849938,"cycle":-1.9919236961694233,"orig":-24.484896784668802,"zero":0},
{"x":131,"trend":-22.40578573091112,"cycle":-1.1544641883230407,"orig":-23.56024991923416,"zero":0},
{"x":132,"trend":-22.052341929577207,"cycle":-0.0061883647098953665,"orig":-22.058530294287102,"zero":0},
{"x":133,"trend":-21.989944156773845,"cycle":1.099221946632122,"orig":-20.89072221014172,"zero":0},
{"x":134,"trend":-22.200401052335913,"cycle":1.754881161697036,"orig":-20.445519890638877,"zero":0},
{"x":135,"trend":-21.985420737371903,"cycle":1.8222545008620403,"orig":-20.163166236509863,"zero":0},
{"x":136,"trend":-22.56148636470609,"cycle":1.5368387901796678,"orig":-21.024647574526423,"zero":0},
{"x":137,"trend":-21.528575394375352,"cycle":1.2967537154386388,"orig":-20.23182167893671,"zero":0},
{"x":138,"trend":-22.517676515950054,"cycle":1.3641893210327691,"orig":-21.153487194917286,"zero":0},
{"x":139,"trend":-22.114018539558494,"cycle":1.6812337325721658,"orig":-20.432784806986326,"zero":0},
{"x":140,"trend":-22.353796079337517,"cycle":1.886684446385614,"orig":-20.4671116329519,"zero":0},
{"x":141,"trend":-22.23564609515245,"cycle":1.603616015461185,"orig":-20.632030079691265,"zero":0},
{"x":142,"trend":-22.229474319027872,"cycle":0.7788493652867287,"orig":-21.450624953741144,"zero":0},
{"x":143,"trend":-22.47725171499461,"cycle":-0.23863909515990778,"orig":-22.715890810154516,"zero":0},
{"x":144,"trend":-22.472031858052745,"cycle":-0.9910404379352813,"orig":-23.463072295988027,"zero":0},
{"x":145,"trend":-22.742447461174393,"cycle":-1.2495795848438211,"orig":-23.992027046018215,"zero":0},
{"x":146,"trend":-22.09948603574686,"cycle":-1.143847724400684,"orig":-23.243333760147543,"zero":0},
{"x":147,"trend":-23.0794060038476,"cycle":-1.0076754380888282,"orig":-24.087081441936427,"zero":0},
{"x":148,"trend":-22.707297539544122,"cycle":-1.1214567354288025,"orig":-23.828754274972923,"zero":0},
{"x":149,"trend":-22.705043830365646,"cycle":-1.5186123537087666,"orig":-24.223656184074414,"zero":0},
{"x":150,"trend":-23.04406963770763,"cycle":-1.9677936058852663,"orig":-25.011863243592895,"zero":0},
{"x":151,"trend":-23.40768789940678,"cycle":-2.1025534358354045,"orig":-25.510241335242185,"zero":0},
{"x":152,"trend":-23.02453928135638,"cycle":-1.6617452193105102,"orig":-24.68628450066689,"zero":0},
{"x":153,"trend":-22.260336704302734,"cycle":-0.6262480386746913,"orig":-22.886584742977426,"zero":0},
{"x":154,"trend":-23.077402879972418,"cycle":0.6963497472015805,"orig":-22.381053132770838,"zero":0},
{"x":155,"trend":-23.5475774771724,"cycle":1.8045398704970728,"orig":-21.743037606675326,"zero":0},
{"x":156,"trend":-23.232000639330856,"cycle":2.269813459460961,"orig":-20.962187179869893,"zero":0},
{"x":157,"trend":-22.457615222708586,"cycle":2.0341747054341717,"orig":-20.423440517274415,"zero":0},
{"x":158,"trend":-22.05669045343754,"cycle":1.364603084426455,"orig":-20.692087369011084,"zero":0},
{"x":159,"trend":-23.152073465672228,"cycle":0.5936415746702897,"orig":-22.558431891001938,"zero":0},
{"x":160,"trend":-22.908367138209123,"cycle":-0.07612823736606322,"orig":-22.984495375575186,"zero":0},
{"x":161,"trend":-23.118831101499495,"cycle":-0.6374209457823501,"orig":-23.756252047281844,"zero":0},
{"x":162,"trend":-22.360125461658956,"cycle":-1.11195724015516,"orig":-23.472082701814116,"zero":0},
{"x":163,"trend":-21.391702432132703,"cycle":-1.4644572552344584,"orig":-22.85615968736716,"zero":0},
{"x":164,"trend":-22.56202457719391,"cycle":-1.5245827391319628,"orig":-24.08660731632587,"zero":0},
{"x":165,"trend":-22.924169543499495,"cycle":-1.1379127401858877,"orig":-24.062082283685385,"zero":0},
{"x":166,"trend":-23.164750487457543,"cycle":-0.3657946344093961,"orig":-23.53054512186694,"zero":0},
{"x":167,"trend":-21.091706201712284,"cycle":0.485150202402418,"orig":-20.606555999309865,"zero":0},
{"x":168,"trend":-21.4192015183591,"cycle":0.9895551600867729,"orig":-20.429646358272326,"zero":0},
{"x":169,"trend":-22.178632134669634,"cycle":0.8545711310872558,"orig":-21.32406100358238,"zero":0},
{"x":170,"trend":-22.38893781925438,"cycle":0.17227523333630618,"orig":-22.216662585918073,"zero":0},
{"x":171,"trend":-21.839687084806723,"cycle":-0.626134286508273,"orig":-22.465821371314995,"zero":0},
{"x":172,"trend":-20.55839833980884,"cycle":-1.0761753295083825,"orig":-21.634573669317223,"zero":0},
{"x":173,"trend":-21.904297101382063,"cycle":-1.064188209783064,"orig":-22.96848531116513,"zero":0},
{"x":174,"trend":-21.001386228170926,"cycle":-0.7949953428406549,"orig":-21.79638157101158,"zero":0},
{"x":175,"trend":-20.582782786395303,"cycle":-0.5986580505865279,"orig":-21.18144083698183,"zero":0},
{"x":176,"trend":-20.604162418013868,"cycle":-0.5816135354123153,"orig":-21.185775953426184,"zero":0},
{"x":177,"trend":-20.7175822882192,"cycle":-0.6087549116177569,"orig":-21.32633719983696,"zero":0},
{"x":178,"trend":-20.17209961924329,"cycle":-0.4908785290885954,"orig":-20.662978148331884,"zero":0},
{"x":179,"trend":-20.058611808853072,"cycle":-0.13110730198972897,"orig":-20.189719110842802,"zero":0},
{"x":180,"trend":-19.265931156607248,"cycle":0.34273722100210574,"orig":-18.92319393560514,"zero":0},
{"x":181,"trend":-19.342341837621642,"cycle":0.8026977343673953,"orig":-18.539644103254247,"zero":0},
{"x":182,"trend":-19.32721497112836,"cycle":1.1205604703104914,"orig":-18.20665450081787,"zero":0},
{"x":183,"trend":-19.843288747622605,"cycle":1.1851634426694977,"orig":-18.658125304953106,"zero":0},
{"x":184,"trend":-18.273809180898134,"cycle":0.9736778175858349,"orig":-17.3001313633123,"zero":0},
{"x":185,"trend":-18.669788118494584,"cycle":0.5896822306112173,"orig":-18.080105887883366,"zero":0},
{"x":186,"trend":-17.307727280526198,"cycle":0.22814960173125387,"orig":-17.079577678794944,"zero":0},
{"x":187,"trend":-18.74484070168578,"cycle":-0.03547135975829052,"orig":-18.78031206144407,"zero":0},
{"x":188,"trend":-18.83436411110933,"cycle":-0.30183911420526655,"orig":-19.136203225314595,"zero":0}];
    const series = [{"name":"Cycle","color":"#2ca02c","key":"cycle","dash":""}];
    const bands = [];
    const refLines = [{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#filt_cy_68');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Cycle') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Cycle');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>