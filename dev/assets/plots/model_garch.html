<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GARCH(1,1) — Diagnostic Plots</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">GARCH(1,1) — Diagnostic Plots</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">Returns</div>
<div id="vol_ret_81"></div>
</div>
<div class="panel">
<div class="panel-title">Conditional Volatility</div>
<div id="vol_sig_82"></div>
</div>
<div class="panel">
<div class="panel-title">Standardized Residuals</div>
<div id="vol_zr_83"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":1,"ret":0.2088332105422406,"vol":0.9636704846977509,"std_resid":0.2167060357853959},
{"x":2,"ret":0.4384722422321556,"vol":0.9638706016715142,"std_resid":0.4549077868665885},
{"x":3,"ret":0.4725842035933498,"vol":0.9640660663677659,"std_resid":0.49019898125225714},
{"x":4,"ret":1.6201447720624402,"vol":0.9642569878601494,"std_resid":1.6802001877713302},
{"x":5,"ret":0.28045405795416234,"vol":0.9644434726225192,"std_resid":0.29079367108115767},
{"x":6,"ret":1.2983159215175022,"vol":0.9646256245928716,"std_resid":1.3459272575984775},
{"x":7,"ret":-0.01987996243675271,"vol":0.9648035452356458,"std_resid":-0.02060519215017725},
{"x":8,"ret":0.21824565572954072,"vol":0.9649773336023627,"std_resid":0.22616661358749904},
{"x":9,"ret":0.25509660863237965,"vol":0.965147086390733,"std_resid":0.2643085310305808},
{"x":10,"ret":-0.11999203046929163,"vol":0.9653128980022113,"std_resid":-0.12430376794677073},
{"x":11,"ret":-0.7174524918352548,"vol":0.9654748605980799,"std_resid":-0.7431084133985806},
{"x":12,"ret":-0.21424087596888453,"vol":0.9656330641540877,"std_resid":-0.2218657209677917},
{"x":13,"ret":-0.4694096628322326,"vol":0.9657875965136858,"std_resid":-0.48603819776389184},
{"x":14,"ret":1.5834667570079413,"vol":0.9659385434399068,"std_resid":1.6393038333152012},
{"x":15,"ret":0.6132359583166904,"vol":0.9660859886659153,"std_resid":0.6347633290526431},
{"x":16,"ret":-1.59366826383876,"vol":0.9662300139442616,"std_resid":-1.6493673771664614},
{"x":17,"ret":-1.518919919412247,"vol":0.9663706990949124,"std_resid":-1.5717777048029742},
{"x":18,"ret":1.3585377890997221,"vol":0.9665081220520246,"std_resid":1.4056144569332398},
{"x":19,"ret":-0.4835243227290544,"vol":0.9666423589095667,"std_resid":-0.5002101534992737},
{"x":20,"ret":-2.250502757283063,"vol":0.9667734839657715,"std_resid":-2.3278490717922318},
{"x":21,"ret":0.3193832464242711,"vol":0.9669015697664842,"std_resid":0.3303161939238604},
{"x":22,"ret":-0.70656180301821,"vol":0.9670266871473782,"std_resid":-0.7306538820583011},
{"x":23,"ret":-0.5381929256618667,"vol":0.9671489052751818,"std_resid":-0.5564736957529154},
{"x":24,"ret":-0.1561158927236592,"vol":0.9672682916878043,"std_resid":-0.16139874951472843},
{"x":25,"ret":0.6037225274273443,"vol":0.967384912333493,"std_resid":0.6240768485535559},
{"x":26,"ret":1.2657433557326152,"vol":0.9674988316090065,"std_resid":1.3082634463006129},
{"x":27,"ret":-1.1505071143854853,"vol":0.9676101123968329,"std_resid":-1.189019316401732},
{"x":28,"ret":-0.9158592464479492,"vol":0.967718816101481,"std_resid":-0.9464104977699499},
{"x":29,"ret":0.5879337179676579,"vol":0.967825002684878,"std_resid":0.6074793649023841},
{"x":30,"ret":-0.41282154828080614,"vol":0.967928730700882,"std_resid":-0.426499942802483},
{"x":31,"ret":-0.2429218347940629,"vol":0.9680300573289429,"std_resid":-0.2509445166034927},
{"x":32,"ret":-0.03516866082973856,"vol":0.9681290384069295,"std_resid":-0.03632641872576109},
{"x":33,"ret":-1.1741778355680308,"vol":0.9682257284631482,"std_resid":-1.2127108390641381},
{"x":34,"ret":1.2286976023402392,"vol":0.9683201807475728,"std_resid":1.26889599821378},
{"x":35,"ret":0.36443715993347037,"vol":0.9684124472623,"std_resid":0.37632432437618235},
{"x":36,"ret":0.863519047346861,"vol":0.9685025787912648,"std_resid":0.8916022179564788},
{"x":37,"ret":-0.6110236695657176,"vol":0.9685906249292275,"std_resid":-0.6308378935738342},
{"x":38,"ret":-1.0731628669281819,"vol":0.9686766341100388,"std_resid":-1.107864925341302},
{"x":39,"ret":-0.558994605387216,"vol":0.9687606536342267,"std_resid":-0.5770203437662268},
{"x":40,"ret":0.05819751744237116,"vol":0.9688427296958972,"std_resid":0.060069106841146795},
{"x":41,"ret":1.5143016801942752,"vol":0.9689229074089912,"std_resid":1.5628711723244197},
{"x":42,"ret":-0.6268646591147701,"vol":0.9690012308328948,"std_resid":-0.6469183311314839},
{"x":43,"ret":-1.1987953363968185,"vol":0.9690777429974146,"std_resid":-1.2370476414914595},
{"x":44,"ret":1.899472039842352,"vol":0.9691524859271754,"std_resid":1.9599310401862635},
{"x":45,"ret":-0.09971254641057269,"vol":0.9692255006653965,"std_resid":-0.1028785833040068},
{"x":46,"ret":0.009760745845731295,"vol":0.9692968272970949,"std_resid":0.010069924476023867},
{"x":47,"ret":1.545285105465797,"vol":0.9693665049717552,"std_resid":1.5941185274508969},
{"x":48,"ret":-1.4799904964815829,"vol":0.9694345719254162,"std_resid":-1.5266533083734986},
{"x":49,"ret":0.6579032422092371,"vol":0.9695010655022301,"std_resid":0.6785998134704719},
{"x":50,"ret":0.018781499514349355,"vol":0.969566022175518,"std_resid":0.019371037231902283},
{"x":51,"ret":0.43823774231229634,"vol":0.9696294775683074,"std_resid":0.4519641290313638},
{"x":52,"ret":-0.8184545502763483,"vol":0.9696914664733712,"std_resid":-0.8440360450452865},
{"x":53,"ret":-0.4364375470212315,"vol":0.9697520228727879,"std_resid":-0.4500506693745597},
{"x":54,"ret":1.5083581349182493,"vol":0.9698111799570299,"std_resid":1.5553111431289968},
{"x":55,"ret":-0.399833933142405,"vol":0.9698689701436003,"std_resid":-0.4122556195227124},
{"x":56,"ret":0.6776588566587324,"vol":0.9699254250952036,"std_resid":0.6986710927721236},
{"x":57,"ret":-0.25870957887814156,"vol":0.9699805757375106,"std_resid":-0.2667162470562212},
{"x":58,"ret":-0.3325448241067508,"vol":0.9700344522764678,"std_resid":-0.34281753944546783},
{"x":59,"ret":-0.7045956337428738,"vol":0.9700870842152102,"std_resid":-0.7263220438739105},
{"x":60,"ret":-0.475919965044083,"vol":0.9701385003705637,"std_resid":-0.4905690938585531},
{"x":61,"ret":-0.1609112014771097,"vol":0.9701887288891521,"std_resid":-0.16585556674251412},
{"x":62,"ret":0.6167444193105983,"vol":0.9702377972631231,"std_resid":0.6356631550021347},
{"x":63,"ret":1.656725291225609,"vol":0.9702857323454979,"std_resid":1.7074612518734684},
{"x":64,"ret":-1.115507949315443,"vol":0.9703325603651541,"std_resid":-1.1496140548923315},
{"x":65,"ret":-1.0786607458137447,"vol":0.9703783069414429,"std_resid":-1.1115878602167022},
{"x":66,"ret":0.8024570646067546,"vol":0.9704229970984812,"std_resid":0.8269147237916488},
{"x":67,"ret":0.8848294326243195,"vol":0.9704666552790805,"std_resid":0.9117566562550941},
{"x":68,"ret":-1.0237559862922225,"vol":0.9705093053583576,"std_resid":-1.0548646784115108},
{"x":69,"ret":0.19164735276562897,"vol":0.9705509706570156,"std_resid":0.19746242965054486},
{"x":70,"ret":0.13301422503123553,"vol":0.9705916739543113,"std_resid":0.13704447359343092},
{"x":71,"ret":-0.4792172281770884,"vol":0.9706314375007209,"std_resid":-0.4937169863475934},
{"x":72,"ret":0.2939583971472789,"vol":0.9706702830302958,"std_resid":0.3028406270248454},
{"x":73,"ret":-1.0602586327856445,"vol":0.9707082317727309,"std_resid":-1.0922526440817077},
{"x":74,"ret":-0.026493476200401492,"vol":0.9707453044651491,"std_resid":-0.02729189219720057},
{"x":75,"ret":1.644352653793086,"vol":0.970781521363598,"std_resid":1.693844204495532},
{"x":76,"ret":-1.272674368713393,"vol":0.9708169022542931,"std_resid":-1.3109314081349113},
{"x":77,"ret":-0.34438109788519616,"vol":0.9708514664645654,"std_resid":-0.35472068568767573},
{"x":78,"ret":1.2497844874830284,"vol":0.9708852328735832,"std_resid":1.2872628454590576},
{"x":79,"ret":1.007692869460378,"vol":0.9709182199228046,"std_resid":1.037876155563851},
{"x":80,"ret":-2.183101935152624,"vol":0.970950445626175,"std_resid":-2.2484174604242764},
{"x":81,"ret":-1.95694257620551,"vol":0.9709819275801076,"std_resid":-2.015426364404768},
{"x":82,"ret":0.5115918005306112,"vol":0.9710126829731949,"std_resid":0.5268641795327959},
{"x":83,"ret":0.7868160673314945,"vol":0.9710427285957257,"std_resid":0.8102795522390134},
{"x":84,"ret":-0.4318914694159917,"vol":0.9710720808489697,"std_resid":-0.4447573747959124},
{"x":85,"ret":0.08450767412628944,"vol":0.9711007557542224,"std_resid":0.08702256035281847},
{"x":86,"ret":0.3627089596358936,"vol":0.97112876896166,"std_resid":0.37349213742653864},
{"x":87,"ret":0.4057153815080021,"vol":0.971156135758977,"std_resid":0.41776534850488056},
{"x":88,"ret":0.648356747464586,"vol":0.9711828710798217,"std_resid":0.6675949162321022},
{"x":89,"ret":-2.3422253505792994,"vol":0.9712089895120349,"std_resid":-2.4116594634859227},
{"x":90,"ret":0.058537307292524224,"vol":0.9712345053056997,"std_resid":0.0602710333835384},
{"x":91,"ret":1.2407776250140905,"vol":0.9712594323809711,"std_resid":1.2774935137282686},
{"x":92,"ret":-0.671120074880389,"vol":0.9712837843357909,"std_resid":-0.6909618853972037},
{"x":93,"ret":0.6545125074113552,"vol":0.9713075744533421,"std_resid":0.673846806743702},
{"x":94,"ret":1.4627322738064892,"vol":0.9713308157093837,"std_resid":1.505905351863283},
{"x":95,"ret":-0.4026323321259725,"vol":0.9713535207793896,"std_resid":-0.4145064834921383},
{"x":96,"ret":0.2478964729796932,"vol":0.9713757020455188,"std_resid":0.25520143489040736},
{"x":97,"ret":0.6378644683857844,"vol":0.9713973716034422,"std_resid":0.656646277859379},
{"x":98,"ret":-1.0784077774543137,"vol":0.9714185412689886,"std_resid":-1.1101371156098816},
{"x":99,"ret":0.6661928537123607,"vol":0.9714392225846442,"std_resid":0.6857792419991704},
{"x":100,"ret":-1.3601924980733364,"vol":0.9714594268258968,"std_resid":-1.400153686827219},
{"x":101,"ret":0.5950165375641198,"vol":0.9714791650074411,"std_resid":0.6124851247422914},
{"x":102,"ret":-0.14126834445413233,"vol":0.9714984478892202,"std_resid":-0.14541283597628674},
{"x":103,"ret":-1.3546396920477852,"vol":0.9715172859823493,"std_resid":-1.3943546981544872},
{"x":104,"ret":-0.7149103634153315,"vol":0.9715356895548857,"std_resid":-0.7358559969555741},
{"x":105,"ret":-0.30829894213322245,"vol":0.971553668637458,"std_resid":-0.31732569397385124},
{"x":106,"ret":-0.5558008236381837,"vol":0.971571233028787,"std_resid":-0.5720638947959832},
{"x":107,"ret":0.11842629292379253,"vol":0.9715883923010578,"std_resid":0.12188936576662682},
{"x":108,"ret":1.4784668469101363,"vol":0.9716051558051714,"std_resid":1.5216745589260767},
{"x":109,"ret":0.3450991513310631,"vol":0.971621532675881,"std_resid":0.3551785749134722},
{"x":110,"ret":-0.7875438839569323,"vol":0.9716375318367906,"std_resid":-0.8105325886991558},
{"x":111,"ret":-2.459079052486651,"vol":0.971653162005266,"std_resid":-2.530819791098795},
{"x":112,"ret":1.985713821808472,"vol":0.9716684316972094,"std_resid":2.0436125709466895},
{"x":113,"ret":0.32277864640718545,"vol":0.9716833492317083,"std_resid":0.33218501342273743},
{"x":114,"ret":1.8546881587438901,"vol":0.9716979227356196,"std_resid":1.908708576346844},
{"x":115,"ret":1.6327579825632743,"vol":0.9717121601480275,"std_resid":1.6802897499137452},
{"x":116,"ret":0.23699866408894116,"vol":0.9717260692245663,"std_resid":0.24389452088906619},
{"x":117,"ret":0.1938232907826632,"vol":0.9717396575416872,"std_resid":0.19946010155950464},
{"x":118,"ret":0.9690563038822385,"vol":0.9717529325008115,"std_resid":0.9972249853554512},
{"x":119,"ret":-1.0490474709800932,"vol":0.971765901332375,"std_resid":-1.0795269411509074},
{"x":120,"ret":-0.7696881032986889,"vol":0.971778571099787,"std_resid":-0.7920406213810753},
{"x":121,"ret":-0.42308277859212345,"vol":0.9717909487033005,"std_resid":-0.4353639835364383},
{"x":122,"ret":0.30928199837740133,"vol":0.9718030408837887,"std_resid":0.31825584543976154},
{"x":123,"ret":0.8904646200777416,"vol":0.9718148542264345,"std_resid":0.9162903985312637},
{"x":124,"ret":-0.9264139330741645,"vol":0.9718263951643338,"std_resid":-0.9532710139216891},
{"x":125,"ret":0.9791979163882076,"vol":0.9718376699820125,"std_resid":1.007573534792422},
{"x":126,"ret":-1.3828053601964323,"vol":0.9718486848188674,"std_resid":-1.4228607619653864},
{"x":127,"ret":-1.986484629440342,"vol":0.9718594456725246,"std_resid":-2.0440040360627445},
{"x":128,"ret":-0.8566022313678463,"vol":0.9718699584021182,"std_resid":-0.8813959357033865},
{"x":129,"ret":-0.5228187593686185,"vol":0.9718802287314862,"std_resid":-0.5379456685223549},
{"x":130,"ret":0.38699283912599847,"vol":0.9718902622523182,"std_resid":0.39818573573230115},
{"x":131,"ret":0.6311105096037605,"vol":0.971900064427199,"std_resid":0.6493574110170607},
{"x":132,"ret":-2.2156582542334338,"vol":0.9719096405925975,"std_resid":-2.279695726531215},
{"x":133,"ret":0.22006438651225776,"vol":0.9719189959617882,"std_resid":0.22642255931471658},
{"x":134,"ret":-1.2966962818325518,"vol":0.9719281356276772,"std_resid":-1.3341483123082318},
{"x":135,"ret":0.12913907274949055,"vol":0.9719370645656239,"std_resid":0.13286773131468663},
{"x":136,"ret":-0.6706073470895847,"vol":0.9719457876361255,"std_resid":-0.6899637362702835},
{"x":137,"ret":-1.3920969135607244,"vol":0.9719543095874921,"std_resid":-1.4322657966829175},
{"x":138,"ret":-0.7698577304637512,"vol":0.9719626350584318,"std_resid":-0.792065150135601},
{"x":139,"ret":-0.6403040790449113,"vol":0.9719707685805808,"std_resid":-0.6587688639854679},
{"x":140,"ret":0.09192223719142951,"vol":0.9719787145809884,"std_resid":0.09457227387027338},
{"x":141,"ret":-0.44595412461193007,"vol":0.9719864773845267,"std_resid":-0.4588069227176157},
{"x":142,"ret":-0.8684779465340083,"vol":0.9719940612162561,"std_resid":-0.8935012889351216},
{"x":143,"ret":1.0116831076128363,"vol":0.9720014702037295,"std_resid":1.040824668095193},
{"x":144,"ret":-0.5811084214553092,"vol":0.9720087083792459,"std_resid":-0.5978428140055096},
{"x":145,"ret":1.0593932021147066,"vol":0.9720157796820502,"std_resid":1.0898930081785687},
{"x":146,"ret":1.1821782874978086,"vol":0.9720226879604887,"std_resid":1.2162044180041427},
{"x":147,"ret":-0.23344395094350798,"vol":0.9720294369741024,"std_resid":-0.24016140053351862},
{"x":148,"ret":1.4223996688457998,"vol":0.9720360303956803,"std_resid":1.4633199021097942},
{"x":149,"ret":0.9282411501765593,"vol":0.9720424718132714,"std_resid":0.9549388808546564},
{"x":150,"ret":0.939487795875224,"vol":0.9720487647321271,"std_resid":0.9665027413867697},
{"x":151,"ret":-1.1749982763140374,"vol":0.9720549125766281,"std_resid":-1.2087776740919574},
{"x":152,"ret":-0.7934506135951656,"vol":0.9720609186921456,"std_resid":-0.8162560579667266},
{"x":153,"ret":1.382501018288413,"vol":0.9720667863468649,"std_resid":1.4222284288551876},
{"x":154,"ret":-0.6613462785784165,"vol":0.9720725187335748,"std_resid":-0.680346646811932},
{"x":155,"ret":0.9428755689280497,"vol":0.9720781189713977,"std_resid":0.969958638638787},
{"x":156,"ret":-0.49557300638543084,"vol":0.9720835901075039,"std_resid":-0.5098049297701084},
{"x":157,"ret":-0.4598402502641967,"vol":0.9720889351187626,"std_resid":-0.4730433951580951},
{"x":158,"ret":0.28129575649935373,"vol":0.9720941569133719,"std_resid":0.28937089529735893},
{"x":159,"ret":-0.5178240340695159,"vol":0.9720992583324404,"std_resid":-0.5326863791232618},
{"x":160,"ret":-1.3815426391665615,"vol":0.9721042421515388,"std_resid":-1.4211877484546522},
{"x":161,"ret":1.502711573684822,"vol":0.9721091110822132,"std_resid":1.5458260359394314},
{"x":162,"ret":-0.4431399891208335,"vol":0.9721138677734588,"std_resid":-0.4558519364977342},
{"x":163,"ret":0.2585764750416383,"vol":0.9721185148131654,"std_resid":0.26599274790207544},
{"x":164,"ret":-1.7095032286358498,"vol":0.9721230547295356,"std_resid":-1.7585255491255356},
{"x":165,"ret":-1.5897575243606703,"vol":0.972127489992459,"std_resid":-1.6353385134423082},
{"x":166,"ret":-0.11419463655310703,"vol":0.9721318230148472,"std_resid":-0.11746826289356331},
{"x":167,"ret":0.045466532570209814,"vol":0.9721360561539603,"std_resid":0.046769721462742594},
{"x":168,"ret":-0.653229380434178,"vol":0.9721401917126945,"std_resid":-0.6719497722682706},
{"x":169,"ret":-0.05142140675282799,"vol":0.9721442319408299,"std_resid":-0.05289483295104073},
{"x":170,"ret":0.27205117912114607,"vol":0.9721481790362557,"std_resid":0.2798453826152773},
{"x":171,"ret":0.745312260251881,"vol":0.9721520351461724,"std_resid":0.7666622434625836},
{"x":172,"ret":-0.11035395888602917,"vol":0.9721558023682596,"std_resid":-0.11351468418662619},
{"x":173,"ret":0.432364067831331,"vol":0.9721594827518165,"std_resid":0.44474602727473433},
{"x":174,"ret":-1.19819001580385,"vol":0.9721630782988835,"std_resid":-1.232498993790707},
{"x":175,"ret":0.2983284889136429,"vol":0.9721665909653301,"std_resid":0.3068697193321695},
{"x":176,"ret":-0.021512606705105092,"vol":0.9721700226619158,"std_resid":-0.022128440708551213},
{"x":177,"ret":1.131813828761745,"vol":0.9721733752553401,"std_resid":1.1642098596502661},
{"x":178,"ret":0.783212207126035,"vol":0.9721766505692554,"std_resid":0.8056274614983061},
{"x":179,"ret":-0.025703397311993892,"vol":0.9721798503852546,"std_resid":-0.026438932366072154},
{"x":180,"ret":-0.23281054824649824,"vol":0.9721829764438491,"std_resid":-0.23947194498107405},
{"x":181,"ret":-1.0032054239549346,"vol":0.9721860304454151,"std_resid":-1.0319068496543895},
{"x":182,"ret":0.8354753313942387,"vol":0.9721890140511185,"std_resid":0.8593754088135671},
{"x":183,"ret":-0.5732709973166978,"vol":0.9721919288838171,"std_resid":-0.5896685420695436},
{"x":184,"ret":1.1450568162366033,"vol":0.9721947765289481,"std_resid":1.177805974564921},
{"x":185,"ret":0.8783648313226607,"vol":0.9721975585353926,"std_resid":0.9034838892682573},
{"x":186,"ret":-0.24888300727752527,"vol":0.9722002764163122,"std_resid":-0.25599972898068735},
{"x":187,"ret":0.7228996624267281,"vol":0.9722029316499798,"std_resid":0.7435686921863677},
{"x":188,"ret":-0.12041647632534423,"vol":0.9722055256805834,"std_resid":-0.12385907418192034},
{"x":189,"ret":-1.4352318894349707,"vol":0.9722080599190084,"std_resid":-1.4762600194391882},
{"x":190,"ret":0.8855858383172982,"vol":0.9722105357436133,"std_resid":0.9108992401938346},
{"x":191,"ret":-0.9025208818149901,"vol":0.9722129545009671,"std_resid":-0.9283160419089975},
{"x":192,"ret":-0.12074409616803661,"vol":0.9722153175065973,"std_resid":-0.1241948095178178},
{"x":193,"ret":0.17269602853502322,"vol":0.9722176260456962,"std_resid":0.17763104052888892},
{"x":194,"ret":1.3197102226275068,"vol":0.9722198813738262,"std_resid":1.3574194972876386},
{"x":195,"ret":0.32175060242573034,"vol":0.9722220847176016,"std_resid":0.3309435235871938},
{"x":196,"ret":-0.7908568134899913,"vol":0.9722242372753492,"std_resid":-0.8134510364670204},
{"x":197,"ret":0.3874579326049864,"vol":0.9722263402177743,"std_resid":0.3985264712311719},
{"x":198,"ret":1.5677556877923258,"vol":0.9722283946885862,"std_resid":1.6125384697229423},
{"x":199,"ret":1.7762816619624333,"vol":0.9722304018051303,"std_resid":1.827017195373061},
{"x":200,"ret":1.9489452010696782,"vol":0.9722323626589853,"std_resid":2.0046084412778176}];
    const series = [{"name":"Returns","color":"#1f77b4","key":"ret","dash":""}];
    const bands = [];
    const refLines = [{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#vol_ret_81');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');
    if('Returns') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Returns');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"ret":0.2088332105422406,"vol":0.9636704846977509,"std_resid":0.2167060357853959},
{"x":2,"ret":0.4384722422321556,"vol":0.9638706016715142,"std_resid":0.4549077868665885},
{"x":3,"ret":0.4725842035933498,"vol":0.9640660663677659,"std_resid":0.49019898125225714},
{"x":4,"ret":1.6201447720624402,"vol":0.9642569878601494,"std_resid":1.6802001877713302},
{"x":5,"ret":0.28045405795416234,"vol":0.9644434726225192,"std_resid":0.29079367108115767},
{"x":6,"ret":1.2983159215175022,"vol":0.9646256245928716,"std_resid":1.3459272575984775},
{"x":7,"ret":-0.01987996243675271,"vol":0.9648035452356458,"std_resid":-0.02060519215017725},
{"x":8,"ret":0.21824565572954072,"vol":0.9649773336023627,"std_resid":0.22616661358749904},
{"x":9,"ret":0.25509660863237965,"vol":0.965147086390733,"std_resid":0.2643085310305808},
{"x":10,"ret":-0.11999203046929163,"vol":0.9653128980022113,"std_resid":-0.12430376794677073},
{"x":11,"ret":-0.7174524918352548,"vol":0.9654748605980799,"std_resid":-0.7431084133985806},
{"x":12,"ret":-0.21424087596888453,"vol":0.9656330641540877,"std_resid":-0.2218657209677917},
{"x":13,"ret":-0.4694096628322326,"vol":0.9657875965136858,"std_resid":-0.48603819776389184},
{"x":14,"ret":1.5834667570079413,"vol":0.9659385434399068,"std_resid":1.6393038333152012},
{"x":15,"ret":0.6132359583166904,"vol":0.9660859886659153,"std_resid":0.6347633290526431},
{"x":16,"ret":-1.59366826383876,"vol":0.9662300139442616,"std_resid":-1.6493673771664614},
{"x":17,"ret":-1.518919919412247,"vol":0.9663706990949124,"std_resid":-1.5717777048029742},
{"x":18,"ret":1.3585377890997221,"vol":0.9665081220520246,"std_resid":1.4056144569332398},
{"x":19,"ret":-0.4835243227290544,"vol":0.9666423589095667,"std_resid":-0.5002101534992737},
{"x":20,"ret":-2.250502757283063,"vol":0.9667734839657715,"std_resid":-2.3278490717922318},
{"x":21,"ret":0.3193832464242711,"vol":0.9669015697664842,"std_resid":0.3303161939238604},
{"x":22,"ret":-0.70656180301821,"vol":0.9670266871473782,"std_resid":-0.7306538820583011},
{"x":23,"ret":-0.5381929256618667,"vol":0.9671489052751818,"std_resid":-0.5564736957529154},
{"x":24,"ret":-0.1561158927236592,"vol":0.9672682916878043,"std_resid":-0.16139874951472843},
{"x":25,"ret":0.6037225274273443,"vol":0.967384912333493,"std_resid":0.6240768485535559},
{"x":26,"ret":1.2657433557326152,"vol":0.9674988316090065,"std_resid":1.3082634463006129},
{"x":27,"ret":-1.1505071143854853,"vol":0.9676101123968329,"std_resid":-1.189019316401732},
{"x":28,"ret":-0.9158592464479492,"vol":0.967718816101481,"std_resid":-0.9464104977699499},
{"x":29,"ret":0.5879337179676579,"vol":0.967825002684878,"std_resid":0.6074793649023841},
{"x":30,"ret":-0.41282154828080614,"vol":0.967928730700882,"std_resid":-0.426499942802483},
{"x":31,"ret":-0.2429218347940629,"vol":0.9680300573289429,"std_resid":-0.2509445166034927},
{"x":32,"ret":-0.03516866082973856,"vol":0.9681290384069295,"std_resid":-0.03632641872576109},
{"x":33,"ret":-1.1741778355680308,"vol":0.9682257284631482,"std_resid":-1.2127108390641381},
{"x":34,"ret":1.2286976023402392,"vol":0.9683201807475728,"std_resid":1.26889599821378},
{"x":35,"ret":0.36443715993347037,"vol":0.9684124472623,"std_resid":0.37632432437618235},
{"x":36,"ret":0.863519047346861,"vol":0.9685025787912648,"std_resid":0.8916022179564788},
{"x":37,"ret":-0.6110236695657176,"vol":0.9685906249292275,"std_resid":-0.6308378935738342},
{"x":38,"ret":-1.0731628669281819,"vol":0.9686766341100388,"std_resid":-1.107864925341302},
{"x":39,"ret":-0.558994605387216,"vol":0.9687606536342267,"std_resid":-0.5770203437662268},
{"x":40,"ret":0.05819751744237116,"vol":0.9688427296958972,"std_resid":0.060069106841146795},
{"x":41,"ret":1.5143016801942752,"vol":0.9689229074089912,"std_resid":1.5628711723244197},
{"x":42,"ret":-0.6268646591147701,"vol":0.9690012308328948,"std_resid":-0.6469183311314839},
{"x":43,"ret":-1.1987953363968185,"vol":0.9690777429974146,"std_resid":-1.2370476414914595},
{"x":44,"ret":1.899472039842352,"vol":0.9691524859271754,"std_resid":1.9599310401862635},
{"x":45,"ret":-0.09971254641057269,"vol":0.9692255006653965,"std_resid":-0.1028785833040068},
{"x":46,"ret":0.009760745845731295,"vol":0.9692968272970949,"std_resid":0.010069924476023867},
{"x":47,"ret":1.545285105465797,"vol":0.9693665049717552,"std_resid":1.5941185274508969},
{"x":48,"ret":-1.4799904964815829,"vol":0.9694345719254162,"std_resid":-1.5266533083734986},
{"x":49,"ret":0.6579032422092371,"vol":0.9695010655022301,"std_resid":0.6785998134704719},
{"x":50,"ret":0.018781499514349355,"vol":0.969566022175518,"std_resid":0.019371037231902283},
{"x":51,"ret":0.43823774231229634,"vol":0.9696294775683074,"std_resid":0.4519641290313638},
{"x":52,"ret":-0.8184545502763483,"vol":0.9696914664733712,"std_resid":-0.8440360450452865},
{"x":53,"ret":-0.4364375470212315,"vol":0.9697520228727879,"std_resid":-0.4500506693745597},
{"x":54,"ret":1.5083581349182493,"vol":0.9698111799570299,"std_resid":1.5553111431289968},
{"x":55,"ret":-0.399833933142405,"vol":0.9698689701436003,"std_resid":-0.4122556195227124},
{"x":56,"ret":0.6776588566587324,"vol":0.9699254250952036,"std_resid":0.6986710927721236},
{"x":57,"ret":-0.25870957887814156,"vol":0.9699805757375106,"std_resid":-0.2667162470562212},
{"x":58,"ret":-0.3325448241067508,"vol":0.9700344522764678,"std_resid":-0.34281753944546783},
{"x":59,"ret":-0.7045956337428738,"vol":0.9700870842152102,"std_resid":-0.7263220438739105},
{"x":60,"ret":-0.475919965044083,"vol":0.9701385003705637,"std_resid":-0.4905690938585531},
{"x":61,"ret":-0.1609112014771097,"vol":0.9701887288891521,"std_resid":-0.16585556674251412},
{"x":62,"ret":0.6167444193105983,"vol":0.9702377972631231,"std_resid":0.6356631550021347},
{"x":63,"ret":1.656725291225609,"vol":0.9702857323454979,"std_resid":1.7074612518734684},
{"x":64,"ret":-1.115507949315443,"vol":0.9703325603651541,"std_resid":-1.1496140548923315},
{"x":65,"ret":-1.0786607458137447,"vol":0.9703783069414429,"std_resid":-1.1115878602167022},
{"x":66,"ret":0.8024570646067546,"vol":0.9704229970984812,"std_resid":0.8269147237916488},
{"x":67,"ret":0.8848294326243195,"vol":0.9704666552790805,"std_resid":0.9117566562550941},
{"x":68,"ret":-1.0237559862922225,"vol":0.9705093053583576,"std_resid":-1.0548646784115108},
{"x":69,"ret":0.19164735276562897,"vol":0.9705509706570156,"std_resid":0.19746242965054486},
{"x":70,"ret":0.13301422503123553,"vol":0.9705916739543113,"std_resid":0.13704447359343092},
{"x":71,"ret":-0.4792172281770884,"vol":0.9706314375007209,"std_resid":-0.4937169863475934},
{"x":72,"ret":0.2939583971472789,"vol":0.9706702830302958,"std_resid":0.3028406270248454},
{"x":73,"ret":-1.0602586327856445,"vol":0.9707082317727309,"std_resid":-1.0922526440817077},
{"x":74,"ret":-0.026493476200401492,"vol":0.9707453044651491,"std_resid":-0.02729189219720057},
{"x":75,"ret":1.644352653793086,"vol":0.970781521363598,"std_resid":1.693844204495532},
{"x":76,"ret":-1.272674368713393,"vol":0.9708169022542931,"std_resid":-1.3109314081349113},
{"x":77,"ret":-0.34438109788519616,"vol":0.9708514664645654,"std_resid":-0.35472068568767573},
{"x":78,"ret":1.2497844874830284,"vol":0.9708852328735832,"std_resid":1.2872628454590576},
{"x":79,"ret":1.007692869460378,"vol":0.9709182199228046,"std_resid":1.037876155563851},
{"x":80,"ret":-2.183101935152624,"vol":0.970950445626175,"std_resid":-2.2484174604242764},
{"x":81,"ret":-1.95694257620551,"vol":0.9709819275801076,"std_resid":-2.015426364404768},
{"x":82,"ret":0.5115918005306112,"vol":0.9710126829731949,"std_resid":0.5268641795327959},
{"x":83,"ret":0.7868160673314945,"vol":0.9710427285957257,"std_resid":0.8102795522390134},
{"x":84,"ret":-0.4318914694159917,"vol":0.9710720808489697,"std_resid":-0.4447573747959124},
{"x":85,"ret":0.08450767412628944,"vol":0.9711007557542224,"std_resid":0.08702256035281847},
{"x":86,"ret":0.3627089596358936,"vol":0.97112876896166,"std_resid":0.37349213742653864},
{"x":87,"ret":0.4057153815080021,"vol":0.971156135758977,"std_resid":0.41776534850488056},
{"x":88,"ret":0.648356747464586,"vol":0.9711828710798217,"std_resid":0.6675949162321022},
{"x":89,"ret":-2.3422253505792994,"vol":0.9712089895120349,"std_resid":-2.4116594634859227},
{"x":90,"ret":0.058537307292524224,"vol":0.9712345053056997,"std_resid":0.0602710333835384},
{"x":91,"ret":1.2407776250140905,"vol":0.9712594323809711,"std_resid":1.2774935137282686},
{"x":92,"ret":-0.671120074880389,"vol":0.9712837843357909,"std_resid":-0.6909618853972037},
{"x":93,"ret":0.6545125074113552,"vol":0.9713075744533421,"std_resid":0.673846806743702},
{"x":94,"ret":1.4627322738064892,"vol":0.9713308157093837,"std_resid":1.505905351863283},
{"x":95,"ret":-0.4026323321259725,"vol":0.9713535207793896,"std_resid":-0.4145064834921383},
{"x":96,"ret":0.2478964729796932,"vol":0.9713757020455188,"std_resid":0.25520143489040736},
{"x":97,"ret":0.6378644683857844,"vol":0.9713973716034422,"std_resid":0.656646277859379},
{"x":98,"ret":-1.0784077774543137,"vol":0.9714185412689886,"std_resid":-1.1101371156098816},
{"x":99,"ret":0.6661928537123607,"vol":0.9714392225846442,"std_resid":0.6857792419991704},
{"x":100,"ret":-1.3601924980733364,"vol":0.9714594268258968,"std_resid":-1.400153686827219},
{"x":101,"ret":0.5950165375641198,"vol":0.9714791650074411,"std_resid":0.6124851247422914},
{"x":102,"ret":-0.14126834445413233,"vol":0.9714984478892202,"std_resid":-0.14541283597628674},
{"x":103,"ret":-1.3546396920477852,"vol":0.9715172859823493,"std_resid":-1.3943546981544872},
{"x":104,"ret":-0.7149103634153315,"vol":0.9715356895548857,"std_resid":-0.7358559969555741},
{"x":105,"ret":-0.30829894213322245,"vol":0.971553668637458,"std_resid":-0.31732569397385124},
{"x":106,"ret":-0.5558008236381837,"vol":0.971571233028787,"std_resid":-0.5720638947959832},
{"x":107,"ret":0.11842629292379253,"vol":0.9715883923010578,"std_resid":0.12188936576662682},
{"x":108,"ret":1.4784668469101363,"vol":0.9716051558051714,"std_resid":1.5216745589260767},
{"x":109,"ret":0.3450991513310631,"vol":0.971621532675881,"std_resid":0.3551785749134722},
{"x":110,"ret":-0.7875438839569323,"vol":0.9716375318367906,"std_resid":-0.8105325886991558},
{"x":111,"ret":-2.459079052486651,"vol":0.971653162005266,"std_resid":-2.530819791098795},
{"x":112,"ret":1.985713821808472,"vol":0.9716684316972094,"std_resid":2.0436125709466895},
{"x":113,"ret":0.32277864640718545,"vol":0.9716833492317083,"std_resid":0.33218501342273743},
{"x":114,"ret":1.8546881587438901,"vol":0.9716979227356196,"std_resid":1.908708576346844},
{"x":115,"ret":1.6327579825632743,"vol":0.9717121601480275,"std_resid":1.6802897499137452},
{"x":116,"ret":0.23699866408894116,"vol":0.9717260692245663,"std_resid":0.24389452088906619},
{"x":117,"ret":0.1938232907826632,"vol":0.9717396575416872,"std_resid":0.19946010155950464},
{"x":118,"ret":0.9690563038822385,"vol":0.9717529325008115,"std_resid":0.9972249853554512},
{"x":119,"ret":-1.0490474709800932,"vol":0.971765901332375,"std_resid":-1.0795269411509074},
{"x":120,"ret":-0.7696881032986889,"vol":0.971778571099787,"std_resid":-0.7920406213810753},
{"x":121,"ret":-0.42308277859212345,"vol":0.9717909487033005,"std_resid":-0.4353639835364383},
{"x":122,"ret":0.30928199837740133,"vol":0.9718030408837887,"std_resid":0.31825584543976154},
{"x":123,"ret":0.8904646200777416,"vol":0.9718148542264345,"std_resid":0.9162903985312637},
{"x":124,"ret":-0.9264139330741645,"vol":0.9718263951643338,"std_resid":-0.9532710139216891},
{"x":125,"ret":0.9791979163882076,"vol":0.9718376699820125,"std_resid":1.007573534792422},
{"x":126,"ret":-1.3828053601964323,"vol":0.9718486848188674,"std_resid":-1.4228607619653864},
{"x":127,"ret":-1.986484629440342,"vol":0.9718594456725246,"std_resid":-2.0440040360627445},
{"x":128,"ret":-0.8566022313678463,"vol":0.9718699584021182,"std_resid":-0.8813959357033865},
{"x":129,"ret":-0.5228187593686185,"vol":0.9718802287314862,"std_resid":-0.5379456685223549},
{"x":130,"ret":0.38699283912599847,"vol":0.9718902622523182,"std_resid":0.39818573573230115},
{"x":131,"ret":0.6311105096037605,"vol":0.971900064427199,"std_resid":0.6493574110170607},
{"x":132,"ret":-2.2156582542334338,"vol":0.9719096405925975,"std_resid":-2.279695726531215},
{"x":133,"ret":0.22006438651225776,"vol":0.9719189959617882,"std_resid":0.22642255931471658},
{"x":134,"ret":-1.2966962818325518,"vol":0.9719281356276772,"std_resid":-1.3341483123082318},
{"x":135,"ret":0.12913907274949055,"vol":0.9719370645656239,"std_resid":0.13286773131468663},
{"x":136,"ret":-0.6706073470895847,"vol":0.9719457876361255,"std_resid":-0.6899637362702835},
{"x":137,"ret":-1.3920969135607244,"vol":0.9719543095874921,"std_resid":-1.4322657966829175},
{"x":138,"ret":-0.7698577304637512,"vol":0.9719626350584318,"std_resid":-0.792065150135601},
{"x":139,"ret":-0.6403040790449113,"vol":0.9719707685805808,"std_resid":-0.6587688639854679},
{"x":140,"ret":0.09192223719142951,"vol":0.9719787145809884,"std_resid":0.09457227387027338},
{"x":141,"ret":-0.44595412461193007,"vol":0.9719864773845267,"std_resid":-0.4588069227176157},
{"x":142,"ret":-0.8684779465340083,"vol":0.9719940612162561,"std_resid":-0.8935012889351216},
{"x":143,"ret":1.0116831076128363,"vol":0.9720014702037295,"std_resid":1.040824668095193},
{"x":144,"ret":-0.5811084214553092,"vol":0.9720087083792459,"std_resid":-0.5978428140055096},
{"x":145,"ret":1.0593932021147066,"vol":0.9720157796820502,"std_resid":1.0898930081785687},
{"x":146,"ret":1.1821782874978086,"vol":0.9720226879604887,"std_resid":1.2162044180041427},
{"x":147,"ret":-0.23344395094350798,"vol":0.9720294369741024,"std_resid":-0.24016140053351862},
{"x":148,"ret":1.4223996688457998,"vol":0.9720360303956803,"std_resid":1.4633199021097942},
{"x":149,"ret":0.9282411501765593,"vol":0.9720424718132714,"std_resid":0.9549388808546564},
{"x":150,"ret":0.939487795875224,"vol":0.9720487647321271,"std_resid":0.9665027413867697},
{"x":151,"ret":-1.1749982763140374,"vol":0.9720549125766281,"std_resid":-1.2087776740919574},
{"x":152,"ret":-0.7934506135951656,"vol":0.9720609186921456,"std_resid":-0.8162560579667266},
{"x":153,"ret":1.382501018288413,"vol":0.9720667863468649,"std_resid":1.4222284288551876},
{"x":154,"ret":-0.6613462785784165,"vol":0.9720725187335748,"std_resid":-0.680346646811932},
{"x":155,"ret":0.9428755689280497,"vol":0.9720781189713977,"std_resid":0.969958638638787},
{"x":156,"ret":-0.49557300638543084,"vol":0.9720835901075039,"std_resid":-0.5098049297701084},
{"x":157,"ret":-0.4598402502641967,"vol":0.9720889351187626,"std_resid":-0.4730433951580951},
{"x":158,"ret":0.28129575649935373,"vol":0.9720941569133719,"std_resid":0.28937089529735893},
{"x":159,"ret":-0.5178240340695159,"vol":0.9720992583324404,"std_resid":-0.5326863791232618},
{"x":160,"ret":-1.3815426391665615,"vol":0.9721042421515388,"std_resid":-1.4211877484546522},
{"x":161,"ret":1.502711573684822,"vol":0.9721091110822132,"std_resid":1.5458260359394314},
{"x":162,"ret":-0.4431399891208335,"vol":0.9721138677734588,"std_resid":-0.4558519364977342},
{"x":163,"ret":0.2585764750416383,"vol":0.9721185148131654,"std_resid":0.26599274790207544},
{"x":164,"ret":-1.7095032286358498,"vol":0.9721230547295356,"std_resid":-1.7585255491255356},
{"x":165,"ret":-1.5897575243606703,"vol":0.972127489992459,"std_resid":-1.6353385134423082},
{"x":166,"ret":-0.11419463655310703,"vol":0.9721318230148472,"std_resid":-0.11746826289356331},
{"x":167,"ret":0.045466532570209814,"vol":0.9721360561539603,"std_resid":0.046769721462742594},
{"x":168,"ret":-0.653229380434178,"vol":0.9721401917126945,"std_resid":-0.6719497722682706},
{"x":169,"ret":-0.05142140675282799,"vol":0.9721442319408299,"std_resid":-0.05289483295104073},
{"x":170,"ret":0.27205117912114607,"vol":0.9721481790362557,"std_resid":0.2798453826152773},
{"x":171,"ret":0.745312260251881,"vol":0.9721520351461724,"std_resid":0.7666622434625836},
{"x":172,"ret":-0.11035395888602917,"vol":0.9721558023682596,"std_resid":-0.11351468418662619},
{"x":173,"ret":0.432364067831331,"vol":0.9721594827518165,"std_resid":0.44474602727473433},
{"x":174,"ret":-1.19819001580385,"vol":0.9721630782988835,"std_resid":-1.232498993790707},
{"x":175,"ret":0.2983284889136429,"vol":0.9721665909653301,"std_resid":0.3068697193321695},
{"x":176,"ret":-0.021512606705105092,"vol":0.9721700226619158,"std_resid":-0.022128440708551213},
{"x":177,"ret":1.131813828761745,"vol":0.9721733752553401,"std_resid":1.1642098596502661},
{"x":178,"ret":0.783212207126035,"vol":0.9721766505692554,"std_resid":0.8056274614983061},
{"x":179,"ret":-0.025703397311993892,"vol":0.9721798503852546,"std_resid":-0.026438932366072154},
{"x":180,"ret":-0.23281054824649824,"vol":0.9721829764438491,"std_resid":-0.23947194498107405},
{"x":181,"ret":-1.0032054239549346,"vol":0.9721860304454151,"std_resid":-1.0319068496543895},
{"x":182,"ret":0.8354753313942387,"vol":0.9721890140511185,"std_resid":0.8593754088135671},
{"x":183,"ret":-0.5732709973166978,"vol":0.9721919288838171,"std_resid":-0.5896685420695436},
{"x":184,"ret":1.1450568162366033,"vol":0.9721947765289481,"std_resid":1.177805974564921},
{"x":185,"ret":0.8783648313226607,"vol":0.9721975585353926,"std_resid":0.9034838892682573},
{"x":186,"ret":-0.24888300727752527,"vol":0.9722002764163122,"std_resid":-0.25599972898068735},
{"x":187,"ret":0.7228996624267281,"vol":0.9722029316499798,"std_resid":0.7435686921863677},
{"x":188,"ret":-0.12041647632534423,"vol":0.9722055256805834,"std_resid":-0.12385907418192034},
{"x":189,"ret":-1.4352318894349707,"vol":0.9722080599190084,"std_resid":-1.4762600194391882},
{"x":190,"ret":0.8855858383172982,"vol":0.9722105357436133,"std_resid":0.9108992401938346},
{"x":191,"ret":-0.9025208818149901,"vol":0.9722129545009671,"std_resid":-0.9283160419089975},
{"x":192,"ret":-0.12074409616803661,"vol":0.9722153175065973,"std_resid":-0.1241948095178178},
{"x":193,"ret":0.17269602853502322,"vol":0.9722176260456962,"std_resid":0.17763104052888892},
{"x":194,"ret":1.3197102226275068,"vol":0.9722198813738262,"std_resid":1.3574194972876386},
{"x":195,"ret":0.32175060242573034,"vol":0.9722220847176016,"std_resid":0.3309435235871938},
{"x":196,"ret":-0.7908568134899913,"vol":0.9722242372753492,"std_resid":-0.8134510364670204},
{"x":197,"ret":0.3874579326049864,"vol":0.9722263402177743,"std_resid":0.3985264712311719},
{"x":198,"ret":1.5677556877923258,"vol":0.9722283946885862,"std_resid":1.6125384697229423},
{"x":199,"ret":1.7762816619624333,"vol":0.9722304018051303,"std_resid":1.827017195373061},
{"x":200,"ret":1.9489452010696782,"vol":0.9722323626589853,"std_resid":2.0046084412778176}];
    const series = [{"name":"Cond. Volatility (σ)","color":"#ff7f0e","key":"vol","dash":""}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#vol_sig_82');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('');
    if('σₜ') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('σₜ');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":1,"ret":0.2088332105422406,"vol":0.9636704846977509,"std_resid":0.2167060357853959},
{"x":2,"ret":0.4384722422321556,"vol":0.9638706016715142,"std_resid":0.4549077868665885},
{"x":3,"ret":0.4725842035933498,"vol":0.9640660663677659,"std_resid":0.49019898125225714},
{"x":4,"ret":1.6201447720624402,"vol":0.9642569878601494,"std_resid":1.6802001877713302},
{"x":5,"ret":0.28045405795416234,"vol":0.9644434726225192,"std_resid":0.29079367108115767},
{"x":6,"ret":1.2983159215175022,"vol":0.9646256245928716,"std_resid":1.3459272575984775},
{"x":7,"ret":-0.01987996243675271,"vol":0.9648035452356458,"std_resid":-0.02060519215017725},
{"x":8,"ret":0.21824565572954072,"vol":0.9649773336023627,"std_resid":0.22616661358749904},
{"x":9,"ret":0.25509660863237965,"vol":0.965147086390733,"std_resid":0.2643085310305808},
{"x":10,"ret":-0.11999203046929163,"vol":0.9653128980022113,"std_resid":-0.12430376794677073},
{"x":11,"ret":-0.7174524918352548,"vol":0.9654748605980799,"std_resid":-0.7431084133985806},
{"x":12,"ret":-0.21424087596888453,"vol":0.9656330641540877,"std_resid":-0.2218657209677917},
{"x":13,"ret":-0.4694096628322326,"vol":0.9657875965136858,"std_resid":-0.48603819776389184},
{"x":14,"ret":1.5834667570079413,"vol":0.9659385434399068,"std_resid":1.6393038333152012},
{"x":15,"ret":0.6132359583166904,"vol":0.9660859886659153,"std_resid":0.6347633290526431},
{"x":16,"ret":-1.59366826383876,"vol":0.9662300139442616,"std_resid":-1.6493673771664614},
{"x":17,"ret":-1.518919919412247,"vol":0.9663706990949124,"std_resid":-1.5717777048029742},
{"x":18,"ret":1.3585377890997221,"vol":0.9665081220520246,"std_resid":1.4056144569332398},
{"x":19,"ret":-0.4835243227290544,"vol":0.9666423589095667,"std_resid":-0.5002101534992737},
{"x":20,"ret":-2.250502757283063,"vol":0.9667734839657715,"std_resid":-2.3278490717922318},
{"x":21,"ret":0.3193832464242711,"vol":0.9669015697664842,"std_resid":0.3303161939238604},
{"x":22,"ret":-0.70656180301821,"vol":0.9670266871473782,"std_resid":-0.7306538820583011},
{"x":23,"ret":-0.5381929256618667,"vol":0.9671489052751818,"std_resid":-0.5564736957529154},
{"x":24,"ret":-0.1561158927236592,"vol":0.9672682916878043,"std_resid":-0.16139874951472843},
{"x":25,"ret":0.6037225274273443,"vol":0.967384912333493,"std_resid":0.6240768485535559},
{"x":26,"ret":1.2657433557326152,"vol":0.9674988316090065,"std_resid":1.3082634463006129},
{"x":27,"ret":-1.1505071143854853,"vol":0.9676101123968329,"std_resid":-1.189019316401732},
{"x":28,"ret":-0.9158592464479492,"vol":0.967718816101481,"std_resid":-0.9464104977699499},
{"x":29,"ret":0.5879337179676579,"vol":0.967825002684878,"std_resid":0.6074793649023841},
{"x":30,"ret":-0.41282154828080614,"vol":0.967928730700882,"std_resid":-0.426499942802483},
{"x":31,"ret":-0.2429218347940629,"vol":0.9680300573289429,"std_resid":-0.2509445166034927},
{"x":32,"ret":-0.03516866082973856,"vol":0.9681290384069295,"std_resid":-0.03632641872576109},
{"x":33,"ret":-1.1741778355680308,"vol":0.9682257284631482,"std_resid":-1.2127108390641381},
{"x":34,"ret":1.2286976023402392,"vol":0.9683201807475728,"std_resid":1.26889599821378},
{"x":35,"ret":0.36443715993347037,"vol":0.9684124472623,"std_resid":0.37632432437618235},
{"x":36,"ret":0.863519047346861,"vol":0.9685025787912648,"std_resid":0.8916022179564788},
{"x":37,"ret":-0.6110236695657176,"vol":0.9685906249292275,"std_resid":-0.6308378935738342},
{"x":38,"ret":-1.0731628669281819,"vol":0.9686766341100388,"std_resid":-1.107864925341302},
{"x":39,"ret":-0.558994605387216,"vol":0.9687606536342267,"std_resid":-0.5770203437662268},
{"x":40,"ret":0.05819751744237116,"vol":0.9688427296958972,"std_resid":0.060069106841146795},
{"x":41,"ret":1.5143016801942752,"vol":0.9689229074089912,"std_resid":1.5628711723244197},
{"x":42,"ret":-0.6268646591147701,"vol":0.9690012308328948,"std_resid":-0.6469183311314839},
{"x":43,"ret":-1.1987953363968185,"vol":0.9690777429974146,"std_resid":-1.2370476414914595},
{"x":44,"ret":1.899472039842352,"vol":0.9691524859271754,"std_resid":1.9599310401862635},
{"x":45,"ret":-0.09971254641057269,"vol":0.9692255006653965,"std_resid":-0.1028785833040068},
{"x":46,"ret":0.009760745845731295,"vol":0.9692968272970949,"std_resid":0.010069924476023867},
{"x":47,"ret":1.545285105465797,"vol":0.9693665049717552,"std_resid":1.5941185274508969},
{"x":48,"ret":-1.4799904964815829,"vol":0.9694345719254162,"std_resid":-1.5266533083734986},
{"x":49,"ret":0.6579032422092371,"vol":0.9695010655022301,"std_resid":0.6785998134704719},
{"x":50,"ret":0.018781499514349355,"vol":0.969566022175518,"std_resid":0.019371037231902283},
{"x":51,"ret":0.43823774231229634,"vol":0.9696294775683074,"std_resid":0.4519641290313638},
{"x":52,"ret":-0.8184545502763483,"vol":0.9696914664733712,"std_resid":-0.8440360450452865},
{"x":53,"ret":-0.4364375470212315,"vol":0.9697520228727879,"std_resid":-0.4500506693745597},
{"x":54,"ret":1.5083581349182493,"vol":0.9698111799570299,"std_resid":1.5553111431289968},
{"x":55,"ret":-0.399833933142405,"vol":0.9698689701436003,"std_resid":-0.4122556195227124},
{"x":56,"ret":0.6776588566587324,"vol":0.9699254250952036,"std_resid":0.6986710927721236},
{"x":57,"ret":-0.25870957887814156,"vol":0.9699805757375106,"std_resid":-0.2667162470562212},
{"x":58,"ret":-0.3325448241067508,"vol":0.9700344522764678,"std_resid":-0.34281753944546783},
{"x":59,"ret":-0.7045956337428738,"vol":0.9700870842152102,"std_resid":-0.7263220438739105},
{"x":60,"ret":-0.475919965044083,"vol":0.9701385003705637,"std_resid":-0.4905690938585531},
{"x":61,"ret":-0.1609112014771097,"vol":0.9701887288891521,"std_resid":-0.16585556674251412},
{"x":62,"ret":0.6167444193105983,"vol":0.9702377972631231,"std_resid":0.6356631550021347},
{"x":63,"ret":1.656725291225609,"vol":0.9702857323454979,"std_resid":1.7074612518734684},
{"x":64,"ret":-1.115507949315443,"vol":0.9703325603651541,"std_resid":-1.1496140548923315},
{"x":65,"ret":-1.0786607458137447,"vol":0.9703783069414429,"std_resid":-1.1115878602167022},
{"x":66,"ret":0.8024570646067546,"vol":0.9704229970984812,"std_resid":0.8269147237916488},
{"x":67,"ret":0.8848294326243195,"vol":0.9704666552790805,"std_resid":0.9117566562550941},
{"x":68,"ret":-1.0237559862922225,"vol":0.9705093053583576,"std_resid":-1.0548646784115108},
{"x":69,"ret":0.19164735276562897,"vol":0.9705509706570156,"std_resid":0.19746242965054486},
{"x":70,"ret":0.13301422503123553,"vol":0.9705916739543113,"std_resid":0.13704447359343092},
{"x":71,"ret":-0.4792172281770884,"vol":0.9706314375007209,"std_resid":-0.4937169863475934},
{"x":72,"ret":0.2939583971472789,"vol":0.9706702830302958,"std_resid":0.3028406270248454},
{"x":73,"ret":-1.0602586327856445,"vol":0.9707082317727309,"std_resid":-1.0922526440817077},
{"x":74,"ret":-0.026493476200401492,"vol":0.9707453044651491,"std_resid":-0.02729189219720057},
{"x":75,"ret":1.644352653793086,"vol":0.970781521363598,"std_resid":1.693844204495532},
{"x":76,"ret":-1.272674368713393,"vol":0.9708169022542931,"std_resid":-1.3109314081349113},
{"x":77,"ret":-0.34438109788519616,"vol":0.9708514664645654,"std_resid":-0.35472068568767573},
{"x":78,"ret":1.2497844874830284,"vol":0.9708852328735832,"std_resid":1.2872628454590576},
{"x":79,"ret":1.007692869460378,"vol":0.9709182199228046,"std_resid":1.037876155563851},
{"x":80,"ret":-2.183101935152624,"vol":0.970950445626175,"std_resid":-2.2484174604242764},
{"x":81,"ret":-1.95694257620551,"vol":0.9709819275801076,"std_resid":-2.015426364404768},
{"x":82,"ret":0.5115918005306112,"vol":0.9710126829731949,"std_resid":0.5268641795327959},
{"x":83,"ret":0.7868160673314945,"vol":0.9710427285957257,"std_resid":0.8102795522390134},
{"x":84,"ret":-0.4318914694159917,"vol":0.9710720808489697,"std_resid":-0.4447573747959124},
{"x":85,"ret":0.08450767412628944,"vol":0.9711007557542224,"std_resid":0.08702256035281847},
{"x":86,"ret":0.3627089596358936,"vol":0.97112876896166,"std_resid":0.37349213742653864},
{"x":87,"ret":0.4057153815080021,"vol":0.971156135758977,"std_resid":0.41776534850488056},
{"x":88,"ret":0.648356747464586,"vol":0.9711828710798217,"std_resid":0.6675949162321022},
{"x":89,"ret":-2.3422253505792994,"vol":0.9712089895120349,"std_resid":-2.4116594634859227},
{"x":90,"ret":0.058537307292524224,"vol":0.9712345053056997,"std_resid":0.0602710333835384},
{"x":91,"ret":1.2407776250140905,"vol":0.9712594323809711,"std_resid":1.2774935137282686},
{"x":92,"ret":-0.671120074880389,"vol":0.9712837843357909,"std_resid":-0.6909618853972037},
{"x":93,"ret":0.6545125074113552,"vol":0.9713075744533421,"std_resid":0.673846806743702},
{"x":94,"ret":1.4627322738064892,"vol":0.9713308157093837,"std_resid":1.505905351863283},
{"x":95,"ret":-0.4026323321259725,"vol":0.9713535207793896,"std_resid":-0.4145064834921383},
{"x":96,"ret":0.2478964729796932,"vol":0.9713757020455188,"std_resid":0.25520143489040736},
{"x":97,"ret":0.6378644683857844,"vol":0.9713973716034422,"std_resid":0.656646277859379},
{"x":98,"ret":-1.0784077774543137,"vol":0.9714185412689886,"std_resid":-1.1101371156098816},
{"x":99,"ret":0.6661928537123607,"vol":0.9714392225846442,"std_resid":0.6857792419991704},
{"x":100,"ret":-1.3601924980733364,"vol":0.9714594268258968,"std_resid":-1.400153686827219},
{"x":101,"ret":0.5950165375641198,"vol":0.9714791650074411,"std_resid":0.6124851247422914},
{"x":102,"ret":-0.14126834445413233,"vol":0.9714984478892202,"std_resid":-0.14541283597628674},
{"x":103,"ret":-1.3546396920477852,"vol":0.9715172859823493,"std_resid":-1.3943546981544872},
{"x":104,"ret":-0.7149103634153315,"vol":0.9715356895548857,"std_resid":-0.7358559969555741},
{"x":105,"ret":-0.30829894213322245,"vol":0.971553668637458,"std_resid":-0.31732569397385124},
{"x":106,"ret":-0.5558008236381837,"vol":0.971571233028787,"std_resid":-0.5720638947959832},
{"x":107,"ret":0.11842629292379253,"vol":0.9715883923010578,"std_resid":0.12188936576662682},
{"x":108,"ret":1.4784668469101363,"vol":0.9716051558051714,"std_resid":1.5216745589260767},
{"x":109,"ret":0.3450991513310631,"vol":0.971621532675881,"std_resid":0.3551785749134722},
{"x":110,"ret":-0.7875438839569323,"vol":0.9716375318367906,"std_resid":-0.8105325886991558},
{"x":111,"ret":-2.459079052486651,"vol":0.971653162005266,"std_resid":-2.530819791098795},
{"x":112,"ret":1.985713821808472,"vol":0.9716684316972094,"std_resid":2.0436125709466895},
{"x":113,"ret":0.32277864640718545,"vol":0.9716833492317083,"std_resid":0.33218501342273743},
{"x":114,"ret":1.8546881587438901,"vol":0.9716979227356196,"std_resid":1.908708576346844},
{"x":115,"ret":1.6327579825632743,"vol":0.9717121601480275,"std_resid":1.6802897499137452},
{"x":116,"ret":0.23699866408894116,"vol":0.9717260692245663,"std_resid":0.24389452088906619},
{"x":117,"ret":0.1938232907826632,"vol":0.9717396575416872,"std_resid":0.19946010155950464},
{"x":118,"ret":0.9690563038822385,"vol":0.9717529325008115,"std_resid":0.9972249853554512},
{"x":119,"ret":-1.0490474709800932,"vol":0.971765901332375,"std_resid":-1.0795269411509074},
{"x":120,"ret":-0.7696881032986889,"vol":0.971778571099787,"std_resid":-0.7920406213810753},
{"x":121,"ret":-0.42308277859212345,"vol":0.9717909487033005,"std_resid":-0.4353639835364383},
{"x":122,"ret":0.30928199837740133,"vol":0.9718030408837887,"std_resid":0.31825584543976154},
{"x":123,"ret":0.8904646200777416,"vol":0.9718148542264345,"std_resid":0.9162903985312637},
{"x":124,"ret":-0.9264139330741645,"vol":0.9718263951643338,"std_resid":-0.9532710139216891},
{"x":125,"ret":0.9791979163882076,"vol":0.9718376699820125,"std_resid":1.007573534792422},
{"x":126,"ret":-1.3828053601964323,"vol":0.9718486848188674,"std_resid":-1.4228607619653864},
{"x":127,"ret":-1.986484629440342,"vol":0.9718594456725246,"std_resid":-2.0440040360627445},
{"x":128,"ret":-0.8566022313678463,"vol":0.9718699584021182,"std_resid":-0.8813959357033865},
{"x":129,"ret":-0.5228187593686185,"vol":0.9718802287314862,"std_resid":-0.5379456685223549},
{"x":130,"ret":0.38699283912599847,"vol":0.9718902622523182,"std_resid":0.39818573573230115},
{"x":131,"ret":0.6311105096037605,"vol":0.971900064427199,"std_resid":0.6493574110170607},
{"x":132,"ret":-2.2156582542334338,"vol":0.9719096405925975,"std_resid":-2.279695726531215},
{"x":133,"ret":0.22006438651225776,"vol":0.9719189959617882,"std_resid":0.22642255931471658},
{"x":134,"ret":-1.2966962818325518,"vol":0.9719281356276772,"std_resid":-1.3341483123082318},
{"x":135,"ret":0.12913907274949055,"vol":0.9719370645656239,"std_resid":0.13286773131468663},
{"x":136,"ret":-0.6706073470895847,"vol":0.9719457876361255,"std_resid":-0.6899637362702835},
{"x":137,"ret":-1.3920969135607244,"vol":0.9719543095874921,"std_resid":-1.4322657966829175},
{"x":138,"ret":-0.7698577304637512,"vol":0.9719626350584318,"std_resid":-0.792065150135601},
{"x":139,"ret":-0.6403040790449113,"vol":0.9719707685805808,"std_resid":-0.6587688639854679},
{"x":140,"ret":0.09192223719142951,"vol":0.9719787145809884,"std_resid":0.09457227387027338},
{"x":141,"ret":-0.44595412461193007,"vol":0.9719864773845267,"std_resid":-0.4588069227176157},
{"x":142,"ret":-0.8684779465340083,"vol":0.9719940612162561,"std_resid":-0.8935012889351216},
{"x":143,"ret":1.0116831076128363,"vol":0.9720014702037295,"std_resid":1.040824668095193},
{"x":144,"ret":-0.5811084214553092,"vol":0.9720087083792459,"std_resid":-0.5978428140055096},
{"x":145,"ret":1.0593932021147066,"vol":0.9720157796820502,"std_resid":1.0898930081785687},
{"x":146,"ret":1.1821782874978086,"vol":0.9720226879604887,"std_resid":1.2162044180041427},
{"x":147,"ret":-0.23344395094350798,"vol":0.9720294369741024,"std_resid":-0.24016140053351862},
{"x":148,"ret":1.4223996688457998,"vol":0.9720360303956803,"std_resid":1.4633199021097942},
{"x":149,"ret":0.9282411501765593,"vol":0.9720424718132714,"std_resid":0.9549388808546564},
{"x":150,"ret":0.939487795875224,"vol":0.9720487647321271,"std_resid":0.9665027413867697},
{"x":151,"ret":-1.1749982763140374,"vol":0.9720549125766281,"std_resid":-1.2087776740919574},
{"x":152,"ret":-0.7934506135951656,"vol":0.9720609186921456,"std_resid":-0.8162560579667266},
{"x":153,"ret":1.382501018288413,"vol":0.9720667863468649,"std_resid":1.4222284288551876},
{"x":154,"ret":-0.6613462785784165,"vol":0.9720725187335748,"std_resid":-0.680346646811932},
{"x":155,"ret":0.9428755689280497,"vol":0.9720781189713977,"std_resid":0.969958638638787},
{"x":156,"ret":-0.49557300638543084,"vol":0.9720835901075039,"std_resid":-0.5098049297701084},
{"x":157,"ret":-0.4598402502641967,"vol":0.9720889351187626,"std_resid":-0.4730433951580951},
{"x":158,"ret":0.28129575649935373,"vol":0.9720941569133719,"std_resid":0.28937089529735893},
{"x":159,"ret":-0.5178240340695159,"vol":0.9720992583324404,"std_resid":-0.5326863791232618},
{"x":160,"ret":-1.3815426391665615,"vol":0.9721042421515388,"std_resid":-1.4211877484546522},
{"x":161,"ret":1.502711573684822,"vol":0.9721091110822132,"std_resid":1.5458260359394314},
{"x":162,"ret":-0.4431399891208335,"vol":0.9721138677734588,"std_resid":-0.4558519364977342},
{"x":163,"ret":0.2585764750416383,"vol":0.9721185148131654,"std_resid":0.26599274790207544},
{"x":164,"ret":-1.7095032286358498,"vol":0.9721230547295356,"std_resid":-1.7585255491255356},
{"x":165,"ret":-1.5897575243606703,"vol":0.972127489992459,"std_resid":-1.6353385134423082},
{"x":166,"ret":-0.11419463655310703,"vol":0.9721318230148472,"std_resid":-0.11746826289356331},
{"x":167,"ret":0.045466532570209814,"vol":0.9721360561539603,"std_resid":0.046769721462742594},
{"x":168,"ret":-0.653229380434178,"vol":0.9721401917126945,"std_resid":-0.6719497722682706},
{"x":169,"ret":-0.05142140675282799,"vol":0.9721442319408299,"std_resid":-0.05289483295104073},
{"x":170,"ret":0.27205117912114607,"vol":0.9721481790362557,"std_resid":0.2798453826152773},
{"x":171,"ret":0.745312260251881,"vol":0.9721520351461724,"std_resid":0.7666622434625836},
{"x":172,"ret":-0.11035395888602917,"vol":0.9721558023682596,"std_resid":-0.11351468418662619},
{"x":173,"ret":0.432364067831331,"vol":0.9721594827518165,"std_resid":0.44474602727473433},
{"x":174,"ret":-1.19819001580385,"vol":0.9721630782988835,"std_resid":-1.232498993790707},
{"x":175,"ret":0.2983284889136429,"vol":0.9721665909653301,"std_resid":0.3068697193321695},
{"x":176,"ret":-0.021512606705105092,"vol":0.9721700226619158,"std_resid":-0.022128440708551213},
{"x":177,"ret":1.131813828761745,"vol":0.9721733752553401,"std_resid":1.1642098596502661},
{"x":178,"ret":0.783212207126035,"vol":0.9721766505692554,"std_resid":0.8056274614983061},
{"x":179,"ret":-0.025703397311993892,"vol":0.9721798503852546,"std_resid":-0.026438932366072154},
{"x":180,"ret":-0.23281054824649824,"vol":0.9721829764438491,"std_resid":-0.23947194498107405},
{"x":181,"ret":-1.0032054239549346,"vol":0.9721860304454151,"std_resid":-1.0319068496543895},
{"x":182,"ret":0.8354753313942387,"vol":0.9721890140511185,"std_resid":0.8593754088135671},
{"x":183,"ret":-0.5732709973166978,"vol":0.9721919288838171,"std_resid":-0.5896685420695436},
{"x":184,"ret":1.1450568162366033,"vol":0.9721947765289481,"std_resid":1.177805974564921},
{"x":185,"ret":0.8783648313226607,"vol":0.9721975585353926,"std_resid":0.9034838892682573},
{"x":186,"ret":-0.24888300727752527,"vol":0.9722002764163122,"std_resid":-0.25599972898068735},
{"x":187,"ret":0.7228996624267281,"vol":0.9722029316499798,"std_resid":0.7435686921863677},
{"x":188,"ret":-0.12041647632534423,"vol":0.9722055256805834,"std_resid":-0.12385907418192034},
{"x":189,"ret":-1.4352318894349707,"vol":0.9722080599190084,"std_resid":-1.4762600194391882},
{"x":190,"ret":0.8855858383172982,"vol":0.9722105357436133,"std_resid":0.9108992401938346},
{"x":191,"ret":-0.9025208818149901,"vol":0.9722129545009671,"std_resid":-0.9283160419089975},
{"x":192,"ret":-0.12074409616803661,"vol":0.9722153175065973,"std_resid":-0.1241948095178178},
{"x":193,"ret":0.17269602853502322,"vol":0.9722176260456962,"std_resid":0.17763104052888892},
{"x":194,"ret":1.3197102226275068,"vol":0.9722198813738262,"std_resid":1.3574194972876386},
{"x":195,"ret":0.32175060242573034,"vol":0.9722220847176016,"std_resid":0.3309435235871938},
{"x":196,"ret":-0.7908568134899913,"vol":0.9722242372753492,"std_resid":-0.8134510364670204},
{"x":197,"ret":0.3874579326049864,"vol":0.9722263402177743,"std_resid":0.3985264712311719},
{"x":198,"ret":1.5677556877923258,"vol":0.9722283946885862,"std_resid":1.6125384697229423},
{"x":199,"ret":1.7762816619624333,"vol":0.9722304018051303,"std_resid":1.827017195373061},
{"x":200,"ret":1.9489452010696782,"vol":0.9722323626589853,"std_resid":2.0046084412778176}];
    const series = [{"name":"Std. Residuals","color":"#2ca02c","key":"std_resid","dash":""}];
    const bands = [];
    const refLines = [{"value":2,"color":"#d62728","dash":"4,3"},{"value":-2,"color":"#d62728","dash":"4,3"},{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#vol_zr_83');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('zₜ = εₜ/σₜ') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('zₜ = εₜ/σₜ');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>