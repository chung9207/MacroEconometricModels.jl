<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hamilton (2018) Filter (h=8, p=4)</title>
<style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    background: #fff;
    color: #333;
    padding: 20px;
}
.figure-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 16px;
    color: #222;
}
.figure-source {
    font-size: 11px;
    color: #888;
    text-align: center;
    margin-top: 8px;
}
.panel-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    justify-content: center;
}
.panel {
    width: calc(100% - 16px);
    min-width: 300px;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    padding: 12px;
}
.panel-title {
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 8px;
    color: #444;
}
.axis text { font-size: 11px; fill: #666; }
.axis line, .axis path { stroke: #ccc; }
.grid line { stroke: #f0f0f0; stroke-dasharray: 2,2; }
.grid .domain { stroke: none; }
.tooltip {
    position: absolute;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 11px;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 1000;
}
.legend { font-size: 11px; }
.legend rect { rx: 2; }
svg { overflow: visible; }
</style>
</head>
<body>
<div class="figure-title">Hamilton (2018) Filter (h=8, p=4)</div>
<div class="panel-grid">
<div class="panel">
<div class="panel-title">Trend-Cycle Decomposition</div>
<div id="filt_tc_63"></div>
</div>
<div class="panel">
<div class="panel-title">Cyclical Component</div>
<div id="filt_cy_64"></div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script>
// Shared utilities
const tooltip = d3.select('#tooltip');
function fmt(v) {
    if (v === null || v === undefined) return '';
    return Math.abs(v) >= 1000 ? v.toFixed(1) : (Math.abs(v) >= 1 ? v.toFixed(3) : v.toFixed(4));
}
function showTip(evt, html) {
    tooltip.html(html).style('opacity',1)
        .style('left',(evt.pageX+12)+'px').style('top',(evt.pageY-28)+'px');
}
function hideTip() { tooltip.style('opacity',0); }

(function() {
    const data = [{"x":12,"trend":-2.046137208214088,"cycle":-4.808210132679751,"orig":-6.854347340893839,"zero":0},
{"x":13,"trend":-3.4371388488252697,"cycle":-3.3471549106420673,"orig":-6.784293759467337,"zero":0},
{"x":14,"trend":-2.977740289654821,"cycle":-2.514353782381283,"orig":-5.492094072036104,"zero":0},
{"x":15,"trend":-2.426431138701507,"cycle":-3.5538497094862587,"orig":-5.980280848187766,"zero":0},
{"x":16,"trend":-1.9449679683260586,"cycle":-2.5219687541807367,"orig":-4.466936722506795,"zero":0},
{"x":17,"trend":-4.122062338491474,"cycle":0.937954513454327,"orig":-3.1841078250371466,"zero":0},
{"x":18,"trend":-6.009437519892993,"cycle":4.618218081911035,"orig":-1.3912194379819582,"zero":0},
{"x":19,"trend":-5.129230512905011,"cycle":4.321730241792905,"orig":-0.807500271112105,"zero":0},
{"x":20,"trend":-7.533092365721369,"cycle":7.538157726467184,"orig":0.005065360745815428,"zero":0},
{"x":21,"trend":-7.717634162303835,"cycle":8.963552850566963,"orig":1.2459186882631283,"zero":0},
{"x":22,"trend":-6.254063242297415,"cycle":6.577207735373318,"orig":0.32314449307590254,"zero":0},
{"x":23,"trend":-7.436857239577793,"cycle":7.149858499847097,"orig":-0.2869987397306958,"zero":0},
{"x":24,"trend":-6.097296941447319,"cycle":6.947310993746429,"orig":0.8500140522991101,"zero":0},
{"x":25,"trend":-4.766699694834152,"cycle":5.841957641685612,"orig":1.0752579468514596,"zero":0},
{"x":26,"trend":-3.5755404361987586,"cycle":4.8031192248143615,"orig":1.2275787886156024,"zero":0},
{"x":27,"trend":-3.076554052360618,"cycle":4.181108739934858,"orig":1.1045546875742405,"zero":0},
{"x":28,"trend":-2.3064458878900593,"cycle":2.4758950211956887,"orig":0.1694491333056295,"zero":0},
{"x":29,"trend":-0.9174562691488322,"cycle":1.3921628968103195,"orig":0.47470662766148725,"zero":0},
{"x":30,"trend":-1.899072330085128,"cycle":2.0834186127264984,"orig":0.18434628264137032,"zero":0},
{"x":31,"trend":-2.279765595398481,"cycle":2.614501546302275,"orig":0.33473595090379393,"zero":0},
{"x":32,"trend":-0.7470986722105124,"cycle":0.9154704201180239,"orig":0.16837174790751147,"zero":0},
{"x":33,"trend":-0.8489278943506613,"cycle":1.9102977140802855,"orig":1.0613698197296242,"zero":0},
{"x":34,"trend":-1.0109714023270815,"cycle":2.1046732286749816,"orig":1.0937018263479001,"zero":0},
{"x":35,"trend":-0.9034820631680927,"cycle":2.364528558830213,"orig":1.4610464956621207,"zero":0},
{"x":36,"trend":-1.7142239922914055,"cycle":3.6487747234626124,"orig":1.934550731171207,"zero":0},
{"x":37,"trend":-1.2502207344083032,"cycle":0.9834032576854,"orig":-0.2668174767229031,"zero":0},
{"x":38,"trend":-1.486116567046378,"cycle":0.3991125436234866,"orig":-1.0870040234228915,"zero":0},
{"x":39,"trend":-1.5605589845186973,"cycle":-0.6679684549208507,"orig":-2.228527439439548,"zero":0},
{"x":40,"trend":-1.6311644827113805,"cycle":-0.8082562172125496,"orig":-2.43942069992393,"zero":0},
{"x":41,"trend":-0.8676142814357761,"cycle":-2.2541532837312523,"orig":-3.1217675651670285,"zero":0},
{"x":42,"trend":-0.9099796955313452,"cycle":-3.5347150366962046,"orig":-4.44469473222755,"zero":0},
{"x":43,"trend":-0.7141618398066909,"cycle":-5.557386128596613,"orig":-6.271547968403303,"zero":0},
{"x":44,"trend":-0.12172005483444398,"cycle":-6.158367847190892,"orig":-6.280087902025336,"zero":0},
{"x":45,"trend":-2.25655030446181,"cycle":-2.7563379490134827,"orig":-5.0128882534752925,"zero":0},
{"x":46,"trend":-2.6696056376492003,"cycle":-1.8081529480294418,"orig":-4.477758585678642,"zero":0},
{"x":47,"trend":-3.250733101148423,"cycle":-0.6587565323882623,"orig":-3.909489633536685,"zero":0},
{"x":48,"trend":-3.7111641233718533,"cycle":-0.05654358171934337,"orig":-3.7677077050911967,"zero":0},
{"x":49,"trend":-4.377503763627205,"cycle":0.0824293300612462,"orig":-4.295074433565959,"zero":0},
{"x":50,"trend":-5.748977839372993,"cycle":1.3658213759259326,"orig":-4.383156463447061,"zero":0},
{"x":51,"trend":-7.223536664576737,"cycle":1.655387033394966,"orig":-5.568149631181771,"zero":0},
{"x":52,"trend":-6.98587113815989,"cycle":2.1379346397209353,"orig":-4.847936498438955,"zero":0},
{"x":53,"trend":-5.9209588301119425,"cycle":1.9080825689465675,"orig":-4.012876261165375,"zero":0},
{"x":54,"trend":-6.035145716146556,"cycle":2.2246850743419744,"orig":-3.810460641804582,"zero":0},
{"x":55,"trend":-5.729420417256779,"cycle":0.6665845905678225,"orig":-5.062835826688956,"zero":0},
{"x":56,"trend":-5.440022774113597,"cycle":2.328391531593655,"orig":-3.111631242519942,"zero":0},
{"x":57,"trend":-5.884910799384697,"cycle":1.5775500406567646,"orig":-4.307360758727932,"zero":0},
{"x":58,"trend":-5.773685311122062,"cycle":2.522107676235985,"orig":-3.2515776348860768,"zero":0},
{"x":59,"trend":-6.763939734798807,"cycle":3.7564368149834206,"orig":-3.0075029198153866,"zero":0},
{"x":60,"trend":-6.045181745660306,"cycle":4.893641315873596,"orig":-1.1515404297867105,"zero":0},
{"x":61,"trend":-5.263519754089568,"cycle":2.3623001046186713,"orig":-2.901219649470897,"zero":0},
{"x":62,"trend":-5.554342503244206,"cycle":3.668216121988644,"orig":-1.8861263812555622,"zero":0},
{"x":63,"trend":-6.664052688473287,"cycle":4.661651174295951,"orig":-2.0024015141773357,"zero":0},
{"x":64,"trend":-4.509605310429299,"cycle":1.647903674335374,"orig":-2.8617016360939247,"zero":0},
{"x":65,"trend":-5.702799643139929,"cycle":3.09350105690088,"orig":-2.6092985862390488,"zero":0},
{"x":66,"trend":-5.071355932883361,"cycle":3.0665098077217197,"orig":-2.0048461251616416,"zero":0},
{"x":67,"trend":-4.401583412015409,"cycle":1.3439597158413772,"orig":-3.0576236961740317,"zero":0},
{"x":68,"trend":-3.1207686424060554,"cycle":-1.5661971548350078,"orig":-4.686965797241063,"zero":0},
{"x":69,"trend":-4.778734342808436,"cycle":-1.580820426012619,"orig":-6.359554768821055,"zero":0},
{"x":70,"trend":-3.743283572809495,"cycle":-2.6640585325543613,"orig":-6.407342105363856,"zero":0},
{"x":71,"trend":-3.3612517011388254,"cycle":-0.9009431605261238,"orig":-4.262194861664949,"zero":0},
{"x":72,"trend":-4.6647612699058625,"cycle":-1.009614939462387,"orig":-5.6743762093682495,"zero":0},
{"x":73,"trend":-4.05778016608896,"cycle":-2.234684350190258,"orig":-6.292464516279217,"zero":0},
{"x":74,"trend":-3.4661496129897333,"cycle":-3.4424368908976852,"orig":-6.908586503887419,"zero":0},
{"x":75,"trend":-4.755271693103017,"cycle":-3.8658350330078957,"orig":-8.621106726110913,"zero":0},
{"x":76,"trend":-6.120277840939827,"cycle":-3.473097811710157,"orig":-9.593375652649984,"zero":0},
{"x":77,"trend":-7.1753794977865715,"cycle":-3.466304663892285,"orig":-10.641684161678857,"zero":0},
{"x":78,"trend":-7.048812067181508,"cycle":-3.8226255785419827,"orig":-10.871437645723491,"zero":0},
{"x":79,"trend":-5.2564522317571765,"cycle":-6.230359240018435,"orig":-11.486811471775612,"zero":0},
{"x":80,"trend":-7.253668136744453,"cycle":-5.048871992195126,"orig":-12.30254012893958,"zero":0},
{"x":81,"trend":-7.876372107093946,"cycle":-4.7019920178273225,"orig":-12.578364124921269,"zero":0},
{"x":82,"trend":-7.694912673808306,"cycle":-4.5352365852725764,"orig":-12.230149259080882,"zero":0},
{"x":83,"trend":-9.454022633757937,"cycle":-2.7262480366614508,"orig":-12.180270670419388,"zero":0},
{"x":84,"trend":-10.187077093869302,"cycle":0.07474377086619555,"orig":-10.112333323003106,"zero":0},
{"x":85,"trend":-10.97198744949386,"cycle":0.4731943559154761,"orig":-10.498793093578383,"zero":0},
{"x":86,"trend":-11.330829763387662,"cycle":0.05291840708095563,"orig":-11.277911356306706,"zero":0},
{"x":87,"trend":-11.978871789843343,"cycle":-0.526553974305779,"orig":-12.505425764149122,"zero":0},
{"x":88,"trend":-12.86701592697634,"cycle":0.20660599892285347,"orig":-12.660409928053486,"zero":0},
{"x":89,"trend":-12.991857670953841,"cycle":0.426660624353957,"orig":-12.565197046599884,"zero":0},
{"x":90,"trend":-12.68480367016964,"cycle":-0.9563274986622421,"orig":-13.641131168831881,"zero":0},
{"x":91,"trend":-12.849314696373353,"cycle":-0.13206314170603584,"orig":-12.98137783807939,"zero":0},
{"x":92,"trend":-11.0492302273537,"cycle":-2.1333288192435838,"orig":-13.182559046597284,"zero":0},
{"x":93,"trend":-11.622360662440425,"cycle":-1.8240846712253926,"orig":-13.446445333665817,"zero":0},
{"x":94,"trend":-12.507291914388786,"cycle":-1.6814120207135677,"orig":-14.188703935102353,"zero":0},
{"x":95,"trend":-13.00100640690308,"cycle":-2.0047129887665704,"orig":-15.00571939566965,"zero":0},
{"x":96,"trend":-12.974546826855518,"cycle":-3.430587043026863,"orig":-16.40513386988238,"zero":0},
{"x":97,"trend":-12.910916004318988,"cycle":-2.889944616672416,"orig":-15.800860620991404,"zero":0},
{"x":98,"trend":-14.190613561080646,"cycle":-1.551870715297369,"orig":-15.742484276378015,"zero":0},
{"x":99,"trend":-13.475910053914522,"cycle":-1.0911883821150212,"orig":-14.567098436029543,"zero":0},
{"x":100,"trend":-13.612348162177188,"cycle":-3.633111579672054,"orig":-17.245459741849242,"zero":0},
{"x":101,"trend":-14.155093128372195,"cycle":-3.898920952491638,"orig":-18.054014080863833,"zero":0},
{"x":102,"trend":-14.62576660973154,"cycle":-3.7636224470277693,"orig":-18.38938905675931,"zero":0},
{"x":103,"trend":-15.293724979206871,"cycle":-3.9859599983559413,"orig":-19.279684977562813,"zero":0},
{"x":104,"trend":-16.450599881339066,"cycle":-2.6646115597370432,"orig":-19.11521144107611,"zero":0},
{"x":105,"trend":-15.777761531867469,"cycle":-2.799999721947973,"orig":-18.577761253815442,"zero":0},
{"x":106,"trend":-15.845251689438992,"cycle":-1.3748587218651487,"orig":-17.22011041130414,"zero":0},
{"x":107,"trend":-15.164618986552822,"cycle":-4.007891682667081,"orig":-19.172510669219903,"zero":0},
{"x":108,"trend":-17.67019508186337,"cycle":-1.084276352634312,"orig":-18.75447143449768,"zero":0},
{"x":109,"trend":-18.156357592205598,"cycle":0.45220105653644893,"orig":-17.70415653566915,"zero":0},
{"x":110,"trend":-17.775385090841578,"cycle":0.8834075956480198,"orig":-16.891977495193558,"zero":0},
{"x":111,"trend":-19.091391557727,"cycle":1.795881881880657,"orig":-17.295509675846343,"zero":0},
{"x":112,"trend":-18.966492790625523,"cycle":0.4432169144721705,"orig":-18.523275876153352,"zero":0},
{"x":113,"trend":-18.472507316656117,"cycle":-0.576571379358569,"orig":-19.049078696014686,"zero":0},
{"x":114,"trend":-17.522025638618597,"cycle":-2.0671501294816466,"orig":-19.589175768100244,"zero":0},
{"x":115,"trend":-19.53970256140226,"cycle":0.2739203228315681,"orig":-19.265782238570694,"zero":0},
{"x":116,"trend":-18.902479319450805,"cycle":-0.15230318433892265,"orig":-19.054782503789728,"zero":0},
{"x":117,"trend":-17.452649416214538,"cycle":-2.2537088313692344,"orig":-19.706358247583772,"zero":0},
{"x":118,"trend":-17.357428494755,"cycle":-3.3812139300644724,"orig":-20.73864242481947,"zero":0},
{"x":119,"trend":-17.864196819391825,"cycle":-2.2245224699301964,"orig":-20.08871928932202,"zero":0},
{"x":120,"trend":-18.785126274629608,"cycle":-2.563396696071319,"orig":-21.348522970700927,"zero":0},
{"x":121,"trend":-18.860895031666328,"cycle":-1.5827671295104935,"orig":-20.44366216117682,"zero":0},
{"x":122,"trend":-19.24341370627912,"cycle":-2.3490240554564323,"orig":-21.592437761735553,"zero":0},
{"x":123,"trend":-19.09865531587178,"cycle":-2.767368166459203,"orig":-21.866023482330984,"zero":0},
{"x":124,"trend":-19.012878172917667,"cycle":-4.256084208798985,"orig":-23.26896238171665,"zero":0},
{"x":125,"trend":-19.808311867898023,"cycle":-3.7260159271188797,"orig":-23.534327795016903,"zero":0},
{"x":126,"trend":-20.61754782077423,"cycle":-3.8833802565568334,"orig":-24.500928077331064,"zero":0},
{"x":127,"trend":-19.748328613414564,"cycle":-4.434333593763117,"orig":-24.182662207177682,"zero":0},
{"x":128,"trend":-21.042553582016414,"cycle":-3.234996150129138,"orig":-24.277549732145552,"zero":0},
{"x":129,"trend":-20.3441019877234,"cycle":-4.198004374267974,"orig":-24.542106361991372,"zero":0},
{"x":130,"trend":-21.23964667510826,"cycle":-3.2452501095605406,"orig":-24.484896784668802,"zero":0},
{"x":131,"trend":-21.728086276923197,"cycle":-1.832163642310963,"orig":-23.56024991923416,"zero":0},
{"x":132,"trend":-22.64420263598381,"cycle":0.5856723416967071,"orig":-22.058530294287102,"zero":0},
{"x":133,"trend":-22.931118802308443,"cycle":2.040396592166722,"orig":-20.89072221014172,"zero":0},
{"x":134,"trend":-23.694407761346184,"cycle":3.248887870707307,"orig":-20.445519890638877,"zero":0},
{"x":135,"trend":-23.56447929788333,"cycle":3.401313061373468,"orig":-20.163166236509863,"zero":0},
{"x":136,"trend":-23.651586280540904,"cycle":2.6269387060144815,"orig":-21.024647574526423,"zero":0},
{"x":137,"trend":-24.146021963659447,"cycle":3.9142002847227353,"orig":-20.23182167893671,"zero":0},
{"x":138,"trend":-23.97012869985241,"cycle":2.8166415049351237,"orig":-21.153487194917286,"zero":0},
{"x":139,"trend":-23.116473381694902,"cycle":2.683688574708576,"orig":-20.432784806986326,"zero":0},
{"x":140,"trend":-21.92816535730968,"cycle":1.4610537243577788,"orig":-20.4671116329519,"zero":0},
{"x":141,"trend":-21.15126485816802,"cycle":0.5192347784767541,"orig":-20.632030079691265,"zero":0},
{"x":142,"trend":-20.855089634967996,"cycle":-0.5955353187731482,"orig":-21.450624953741144,"zero":0},
{"x":143,"trend":-20.43388792173305,"cycle":-2.2820028884214665,"orig":-22.715890810154516,"zero":0},
{"x":144,"trend":-21.0445810540483,"cycle":-2.4184912419397264,"orig":-23.463072295988027,"zero":0},
{"x":145,"trend":-20.116736154495083,"cycle":-3.8752908915231323,"orig":-23.992027046018215,"zero":0},
{"x":146,"trend":-20.917720722551955,"cycle":-2.3256130375955877,"orig":-23.243333760147543,"zero":0},
{"x":147,"trend":-20.41301779400915,"cycle":-3.6740636479272766,"orig":-24.087081441936427,"zero":0},
{"x":148,"trend":-20.256751864725558,"cycle":-3.5720024102473644,"orig":-23.828754274972923,"zero":0},
{"x":149,"trend":-20.702099672772977,"cycle":-3.521556511301437,"orig":-24.223656184074414,"zero":0},
{"x":150,"trend":-21.261618164609747,"cycle":-3.7502450789831485,"orig":-25.011863243592895,"zero":0},
{"x":151,"trend":-22.304784899684456,"cycle":-3.2054564355577284,"orig":-25.510241335242185,"zero":0},
{"x":152,"trend":-22.76364659062984,"cycle":-1.92263791003705,"orig":-24.68628450066689,"zero":0},
{"x":153,"trend":-23.19816823256736,"cycle":0.3115834895899354,"orig":-22.886584742977426,"zero":0},
{"x":154,"trend":-22.646018132645807,"cycle":0.26496499987496946,"orig":-22.381053132770838,"zero":0},
{"x":155,"trend":-23.6485435791149,"cycle":1.905505972439574,"orig":-21.743037606675326,"zero":0},
{"x":156,"trend":-23.49887254781627,"cycle":2.536685367946376,"orig":-20.962187179869893,"zero":0},
{"x":157,"trend":-23.629555902168637,"cycle":3.206115384894222,"orig":-20.423440517274415,"zero":0},
{"x":158,"trend":-24.52984061295444,"cycle":3.8377532439433573,"orig":-20.692087369011084,"zero":0},
{"x":159,"trend":-24.77390096499036,"cycle":2.215469073988423,"orig":-22.558431891001938,"zero":0},
{"x":160,"trend":-23.94684358320206,"cycle":0.9623482076268743,"orig":-22.984495375575186,"zero":0},
{"x":161,"trend":-22.53016001217049,"cycle":-1.2260920351113533,"orig":-23.756252047281844,"zero":0},
{"x":162,"trend":-22.527095959678544,"cycle":-0.9449867421355727,"orig":-23.472082701814116,"zero":0},
{"x":163,"trend":-22.01612854752505,"cycle":-0.840031139842111,"orig":-22.85615968736716,"zero":0},
{"x":164,"trend":-21.017213797022563,"cycle":-3.0693935193033077,"orig":-24.08660731632587,"zero":0},
{"x":165,"trend":-20.58200946358442,"cycle":-3.4800728201009647,"orig":-24.062082283685385,"zero":0},
{"x":166,"trend":-20.84347769083312,"cycle":-2.687067431033821,"orig":-23.53054512186694,"zero":0},
{"x":167,"trend":-22.40653418662616,"cycle":1.7999781873162952,"orig":-20.606555999309865,"zero":0},
{"x":168,"trend":-22.37933683139735,"cycle":1.949690473125024,"orig":-20.429646358272326,"zero":0},
{"x":169,"trend":-22.88683477696368,"cycle":1.562773773381302,"orig":-21.32406100358238,"zero":0},
{"x":170,"trend":-22.907190950874774,"cycle":0.6905283649567018,"orig":-22.216662585918073,"zero":0},
{"x":171,"trend":-22.392241730128795,"cycle":-0.07357964118619975,"orig":-22.465821371314995,"zero":0},
{"x":172,"trend":-23.830104795581597,"cycle":2.195531126264374,"orig":-21.634573669317223,"zero":0},
{"x":173,"trend":-23.63536164977838,"cycle":0.6668763386132497,"orig":-22.96848531116513,"zero":0},
{"x":174,"trend":-22.86484104181032,"cycle":1.0684594707987394,"orig":-21.79638157101158,"zero":0},
{"x":175,"trend":-20.53048947567078,"cycle":-0.6509513613110514,"orig":-21.18144083698183,"zero":0},
{"x":176,"trend":-20.834198943654496,"cycle":-0.35157700977168815,"orig":-21.185775953426184,"zero":0},
{"x":177,"trend":-21.887616950825855,"cycle":0.5612797509888949,"orig":-21.32633719983696,"zero":0},
{"x":178,"trend":-21.916818935126287,"cycle":1.2538407867944024,"orig":-20.662978148331884,"zero":0},
{"x":179,"trend":-21.87910931277649,"cycle":1.689390201933687,"orig":-20.189719110842802,"zero":0},
{"x":180,"trend":-21.186584597333542,"cycle":2.263390661728401,"orig":-18.92319393560514,"zero":0},
{"x":181,"trend":-22.71933362429663,"cycle":4.179689521042384,"orig":-18.539644103254247,"zero":0},
{"x":182,"trend":-21.599180466952614,"cycle":3.3925259661347447,"orig":-18.20665450081787,"zero":0},
{"x":183,"trend":-20.85156634447415,"cycle":2.193441039521044,"orig":-18.658125304953106,"zero":0},
{"x":184,"trend":-21.387965831038933,"cycle":4.087834467726633,"orig":-17.3001313633123,"zero":0},
{"x":185,"trend":-21.309850981025228,"cycle":3.2297450931418616,"orig":-18.080105887883366,"zero":0},
{"x":186,"trend":-20.531543243700227,"cycle":3.451965564905283,"orig":-17.079577678794944,"zero":0},
{"x":187,"trend":-20.173294517924298,"cycle":1.392982456480226,"orig":-18.78031206144407,"zero":0},
{"x":188,"trend":-19.177089926044978,"cycle":0.040886700730382586,"orig":-19.136203225314595,"zero":0},
{"x":189,"trend":-18.898377631817645,"cycle":1.2686434501329273,"orig":-17.629734181684718,"zero":0},
{"x":190,"trend":-18.6750447126865,"cycle":0.1775374015694844,"orig":-18.497507311117015,"zero":0},
{"x":191,"trend":-18.883830458299425,"cycle":1.4221249942832621,"orig":-17.461705464016163,"zero":0},
{"x":192,"trend":-17.511862692029396,"cycle":-1.0571811583007467,"orig":-18.569043850330143,"zero":0},
{"x":193,"trend":-18.295763707853492,"cycle":0.3839013513214482,"orig":-17.911862356532044,"zero":0},
{"x":194,"trend":-17.519104934678058,"cycle":1.2442509290963635,"orig":-16.274854005581695,"zero":0},
{"x":195,"trend":-18.825099008267493,"cycle":4.201980751005291,"orig":-14.623118257262202,"zero":0},
{"x":196,"trend":-19.209177923499368,"cycle":4.421885487878917,"orig":-14.78729243562045,"zero":0},
{"x":197,"trend":-17.340642601024662,"cycle":2.1049631467610066,"orig":-15.235679454263655,"zero":0},
{"x":198,"trend":-18.71658741378982,"cycle":2.2277072619476392,"orig":-16.48888015184218,"zero":0},
{"x":199,"trend":-17.889000120552275,"cycle":1.6887890107188888,"orig":-16.200211109833386,"zero":0},
{"x":200,"trend":-18.606789262702648,"cycle":3.793604776199004,"orig":-14.813184486503644,"zero":0}];
    const series = [{"name":"Original","color":"#1f77b4","key":"orig","dash":""},{"name":"Trend","color":"#ff7f0e","key":"trend","dash":"6,3"}];
    const bands = [];
    const refLines = [];

    const container = d3.select('#filt_tc_63');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Value') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Value');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

(function() {
    const data = [{"x":12,"trend":-2.046137208214088,"cycle":-4.808210132679751,"orig":-6.854347340893839,"zero":0},
{"x":13,"trend":-3.4371388488252697,"cycle":-3.3471549106420673,"orig":-6.784293759467337,"zero":0},
{"x":14,"trend":-2.977740289654821,"cycle":-2.514353782381283,"orig":-5.492094072036104,"zero":0},
{"x":15,"trend":-2.426431138701507,"cycle":-3.5538497094862587,"orig":-5.980280848187766,"zero":0},
{"x":16,"trend":-1.9449679683260586,"cycle":-2.5219687541807367,"orig":-4.466936722506795,"zero":0},
{"x":17,"trend":-4.122062338491474,"cycle":0.937954513454327,"orig":-3.1841078250371466,"zero":0},
{"x":18,"trend":-6.009437519892993,"cycle":4.618218081911035,"orig":-1.3912194379819582,"zero":0},
{"x":19,"trend":-5.129230512905011,"cycle":4.321730241792905,"orig":-0.807500271112105,"zero":0},
{"x":20,"trend":-7.533092365721369,"cycle":7.538157726467184,"orig":0.005065360745815428,"zero":0},
{"x":21,"trend":-7.717634162303835,"cycle":8.963552850566963,"orig":1.2459186882631283,"zero":0},
{"x":22,"trend":-6.254063242297415,"cycle":6.577207735373318,"orig":0.32314449307590254,"zero":0},
{"x":23,"trend":-7.436857239577793,"cycle":7.149858499847097,"orig":-0.2869987397306958,"zero":0},
{"x":24,"trend":-6.097296941447319,"cycle":6.947310993746429,"orig":0.8500140522991101,"zero":0},
{"x":25,"trend":-4.766699694834152,"cycle":5.841957641685612,"orig":1.0752579468514596,"zero":0},
{"x":26,"trend":-3.5755404361987586,"cycle":4.8031192248143615,"orig":1.2275787886156024,"zero":0},
{"x":27,"trend":-3.076554052360618,"cycle":4.181108739934858,"orig":1.1045546875742405,"zero":0},
{"x":28,"trend":-2.3064458878900593,"cycle":2.4758950211956887,"orig":0.1694491333056295,"zero":0},
{"x":29,"trend":-0.9174562691488322,"cycle":1.3921628968103195,"orig":0.47470662766148725,"zero":0},
{"x":30,"trend":-1.899072330085128,"cycle":2.0834186127264984,"orig":0.18434628264137032,"zero":0},
{"x":31,"trend":-2.279765595398481,"cycle":2.614501546302275,"orig":0.33473595090379393,"zero":0},
{"x":32,"trend":-0.7470986722105124,"cycle":0.9154704201180239,"orig":0.16837174790751147,"zero":0},
{"x":33,"trend":-0.8489278943506613,"cycle":1.9102977140802855,"orig":1.0613698197296242,"zero":0},
{"x":34,"trend":-1.0109714023270815,"cycle":2.1046732286749816,"orig":1.0937018263479001,"zero":0},
{"x":35,"trend":-0.9034820631680927,"cycle":2.364528558830213,"orig":1.4610464956621207,"zero":0},
{"x":36,"trend":-1.7142239922914055,"cycle":3.6487747234626124,"orig":1.934550731171207,"zero":0},
{"x":37,"trend":-1.2502207344083032,"cycle":0.9834032576854,"orig":-0.2668174767229031,"zero":0},
{"x":38,"trend":-1.486116567046378,"cycle":0.3991125436234866,"orig":-1.0870040234228915,"zero":0},
{"x":39,"trend":-1.5605589845186973,"cycle":-0.6679684549208507,"orig":-2.228527439439548,"zero":0},
{"x":40,"trend":-1.6311644827113805,"cycle":-0.8082562172125496,"orig":-2.43942069992393,"zero":0},
{"x":41,"trend":-0.8676142814357761,"cycle":-2.2541532837312523,"orig":-3.1217675651670285,"zero":0},
{"x":42,"trend":-0.9099796955313452,"cycle":-3.5347150366962046,"orig":-4.44469473222755,"zero":0},
{"x":43,"trend":-0.7141618398066909,"cycle":-5.557386128596613,"orig":-6.271547968403303,"zero":0},
{"x":44,"trend":-0.12172005483444398,"cycle":-6.158367847190892,"orig":-6.280087902025336,"zero":0},
{"x":45,"trend":-2.25655030446181,"cycle":-2.7563379490134827,"orig":-5.0128882534752925,"zero":0},
{"x":46,"trend":-2.6696056376492003,"cycle":-1.8081529480294418,"orig":-4.477758585678642,"zero":0},
{"x":47,"trend":-3.250733101148423,"cycle":-0.6587565323882623,"orig":-3.909489633536685,"zero":0},
{"x":48,"trend":-3.7111641233718533,"cycle":-0.05654358171934337,"orig":-3.7677077050911967,"zero":0},
{"x":49,"trend":-4.377503763627205,"cycle":0.0824293300612462,"orig":-4.295074433565959,"zero":0},
{"x":50,"trend":-5.748977839372993,"cycle":1.3658213759259326,"orig":-4.383156463447061,"zero":0},
{"x":51,"trend":-7.223536664576737,"cycle":1.655387033394966,"orig":-5.568149631181771,"zero":0},
{"x":52,"trend":-6.98587113815989,"cycle":2.1379346397209353,"orig":-4.847936498438955,"zero":0},
{"x":53,"trend":-5.9209588301119425,"cycle":1.9080825689465675,"orig":-4.012876261165375,"zero":0},
{"x":54,"trend":-6.035145716146556,"cycle":2.2246850743419744,"orig":-3.810460641804582,"zero":0},
{"x":55,"trend":-5.729420417256779,"cycle":0.6665845905678225,"orig":-5.062835826688956,"zero":0},
{"x":56,"trend":-5.440022774113597,"cycle":2.328391531593655,"orig":-3.111631242519942,"zero":0},
{"x":57,"trend":-5.884910799384697,"cycle":1.5775500406567646,"orig":-4.307360758727932,"zero":0},
{"x":58,"trend":-5.773685311122062,"cycle":2.522107676235985,"orig":-3.2515776348860768,"zero":0},
{"x":59,"trend":-6.763939734798807,"cycle":3.7564368149834206,"orig":-3.0075029198153866,"zero":0},
{"x":60,"trend":-6.045181745660306,"cycle":4.893641315873596,"orig":-1.1515404297867105,"zero":0},
{"x":61,"trend":-5.263519754089568,"cycle":2.3623001046186713,"orig":-2.901219649470897,"zero":0},
{"x":62,"trend":-5.554342503244206,"cycle":3.668216121988644,"orig":-1.8861263812555622,"zero":0},
{"x":63,"trend":-6.664052688473287,"cycle":4.661651174295951,"orig":-2.0024015141773357,"zero":0},
{"x":64,"trend":-4.509605310429299,"cycle":1.647903674335374,"orig":-2.8617016360939247,"zero":0},
{"x":65,"trend":-5.702799643139929,"cycle":3.09350105690088,"orig":-2.6092985862390488,"zero":0},
{"x":66,"trend":-5.071355932883361,"cycle":3.0665098077217197,"orig":-2.0048461251616416,"zero":0},
{"x":67,"trend":-4.401583412015409,"cycle":1.3439597158413772,"orig":-3.0576236961740317,"zero":0},
{"x":68,"trend":-3.1207686424060554,"cycle":-1.5661971548350078,"orig":-4.686965797241063,"zero":0},
{"x":69,"trend":-4.778734342808436,"cycle":-1.580820426012619,"orig":-6.359554768821055,"zero":0},
{"x":70,"trend":-3.743283572809495,"cycle":-2.6640585325543613,"orig":-6.407342105363856,"zero":0},
{"x":71,"trend":-3.3612517011388254,"cycle":-0.9009431605261238,"orig":-4.262194861664949,"zero":0},
{"x":72,"trend":-4.6647612699058625,"cycle":-1.009614939462387,"orig":-5.6743762093682495,"zero":0},
{"x":73,"trend":-4.05778016608896,"cycle":-2.234684350190258,"orig":-6.292464516279217,"zero":0},
{"x":74,"trend":-3.4661496129897333,"cycle":-3.4424368908976852,"orig":-6.908586503887419,"zero":0},
{"x":75,"trend":-4.755271693103017,"cycle":-3.8658350330078957,"orig":-8.621106726110913,"zero":0},
{"x":76,"trend":-6.120277840939827,"cycle":-3.473097811710157,"orig":-9.593375652649984,"zero":0},
{"x":77,"trend":-7.1753794977865715,"cycle":-3.466304663892285,"orig":-10.641684161678857,"zero":0},
{"x":78,"trend":-7.048812067181508,"cycle":-3.8226255785419827,"orig":-10.871437645723491,"zero":0},
{"x":79,"trend":-5.2564522317571765,"cycle":-6.230359240018435,"orig":-11.486811471775612,"zero":0},
{"x":80,"trend":-7.253668136744453,"cycle":-5.048871992195126,"orig":-12.30254012893958,"zero":0},
{"x":81,"trend":-7.876372107093946,"cycle":-4.7019920178273225,"orig":-12.578364124921269,"zero":0},
{"x":82,"trend":-7.694912673808306,"cycle":-4.5352365852725764,"orig":-12.230149259080882,"zero":0},
{"x":83,"trend":-9.454022633757937,"cycle":-2.7262480366614508,"orig":-12.180270670419388,"zero":0},
{"x":84,"trend":-10.187077093869302,"cycle":0.07474377086619555,"orig":-10.112333323003106,"zero":0},
{"x":85,"trend":-10.97198744949386,"cycle":0.4731943559154761,"orig":-10.498793093578383,"zero":0},
{"x":86,"trend":-11.330829763387662,"cycle":0.05291840708095563,"orig":-11.277911356306706,"zero":0},
{"x":87,"trend":-11.978871789843343,"cycle":-0.526553974305779,"orig":-12.505425764149122,"zero":0},
{"x":88,"trend":-12.86701592697634,"cycle":0.20660599892285347,"orig":-12.660409928053486,"zero":0},
{"x":89,"trend":-12.991857670953841,"cycle":0.426660624353957,"orig":-12.565197046599884,"zero":0},
{"x":90,"trend":-12.68480367016964,"cycle":-0.9563274986622421,"orig":-13.641131168831881,"zero":0},
{"x":91,"trend":-12.849314696373353,"cycle":-0.13206314170603584,"orig":-12.98137783807939,"zero":0},
{"x":92,"trend":-11.0492302273537,"cycle":-2.1333288192435838,"orig":-13.182559046597284,"zero":0},
{"x":93,"trend":-11.622360662440425,"cycle":-1.8240846712253926,"orig":-13.446445333665817,"zero":0},
{"x":94,"trend":-12.507291914388786,"cycle":-1.6814120207135677,"orig":-14.188703935102353,"zero":0},
{"x":95,"trend":-13.00100640690308,"cycle":-2.0047129887665704,"orig":-15.00571939566965,"zero":0},
{"x":96,"trend":-12.974546826855518,"cycle":-3.430587043026863,"orig":-16.40513386988238,"zero":0},
{"x":97,"trend":-12.910916004318988,"cycle":-2.889944616672416,"orig":-15.800860620991404,"zero":0},
{"x":98,"trend":-14.190613561080646,"cycle":-1.551870715297369,"orig":-15.742484276378015,"zero":0},
{"x":99,"trend":-13.475910053914522,"cycle":-1.0911883821150212,"orig":-14.567098436029543,"zero":0},
{"x":100,"trend":-13.612348162177188,"cycle":-3.633111579672054,"orig":-17.245459741849242,"zero":0},
{"x":101,"trend":-14.155093128372195,"cycle":-3.898920952491638,"orig":-18.054014080863833,"zero":0},
{"x":102,"trend":-14.62576660973154,"cycle":-3.7636224470277693,"orig":-18.38938905675931,"zero":0},
{"x":103,"trend":-15.293724979206871,"cycle":-3.9859599983559413,"orig":-19.279684977562813,"zero":0},
{"x":104,"trend":-16.450599881339066,"cycle":-2.6646115597370432,"orig":-19.11521144107611,"zero":0},
{"x":105,"trend":-15.777761531867469,"cycle":-2.799999721947973,"orig":-18.577761253815442,"zero":0},
{"x":106,"trend":-15.845251689438992,"cycle":-1.3748587218651487,"orig":-17.22011041130414,"zero":0},
{"x":107,"trend":-15.164618986552822,"cycle":-4.007891682667081,"orig":-19.172510669219903,"zero":0},
{"x":108,"trend":-17.67019508186337,"cycle":-1.084276352634312,"orig":-18.75447143449768,"zero":0},
{"x":109,"trend":-18.156357592205598,"cycle":0.45220105653644893,"orig":-17.70415653566915,"zero":0},
{"x":110,"trend":-17.775385090841578,"cycle":0.8834075956480198,"orig":-16.891977495193558,"zero":0},
{"x":111,"trend":-19.091391557727,"cycle":1.795881881880657,"orig":-17.295509675846343,"zero":0},
{"x":112,"trend":-18.966492790625523,"cycle":0.4432169144721705,"orig":-18.523275876153352,"zero":0},
{"x":113,"trend":-18.472507316656117,"cycle":-0.576571379358569,"orig":-19.049078696014686,"zero":0},
{"x":114,"trend":-17.522025638618597,"cycle":-2.0671501294816466,"orig":-19.589175768100244,"zero":0},
{"x":115,"trend":-19.53970256140226,"cycle":0.2739203228315681,"orig":-19.265782238570694,"zero":0},
{"x":116,"trend":-18.902479319450805,"cycle":-0.15230318433892265,"orig":-19.054782503789728,"zero":0},
{"x":117,"trend":-17.452649416214538,"cycle":-2.2537088313692344,"orig":-19.706358247583772,"zero":0},
{"x":118,"trend":-17.357428494755,"cycle":-3.3812139300644724,"orig":-20.73864242481947,"zero":0},
{"x":119,"trend":-17.864196819391825,"cycle":-2.2245224699301964,"orig":-20.08871928932202,"zero":0},
{"x":120,"trend":-18.785126274629608,"cycle":-2.563396696071319,"orig":-21.348522970700927,"zero":0},
{"x":121,"trend":-18.860895031666328,"cycle":-1.5827671295104935,"orig":-20.44366216117682,"zero":0},
{"x":122,"trend":-19.24341370627912,"cycle":-2.3490240554564323,"orig":-21.592437761735553,"zero":0},
{"x":123,"trend":-19.09865531587178,"cycle":-2.767368166459203,"orig":-21.866023482330984,"zero":0},
{"x":124,"trend":-19.012878172917667,"cycle":-4.256084208798985,"orig":-23.26896238171665,"zero":0},
{"x":125,"trend":-19.808311867898023,"cycle":-3.7260159271188797,"orig":-23.534327795016903,"zero":0},
{"x":126,"trend":-20.61754782077423,"cycle":-3.8833802565568334,"orig":-24.500928077331064,"zero":0},
{"x":127,"trend":-19.748328613414564,"cycle":-4.434333593763117,"orig":-24.182662207177682,"zero":0},
{"x":128,"trend":-21.042553582016414,"cycle":-3.234996150129138,"orig":-24.277549732145552,"zero":0},
{"x":129,"trend":-20.3441019877234,"cycle":-4.198004374267974,"orig":-24.542106361991372,"zero":0},
{"x":130,"trend":-21.23964667510826,"cycle":-3.2452501095605406,"orig":-24.484896784668802,"zero":0},
{"x":131,"trend":-21.728086276923197,"cycle":-1.832163642310963,"orig":-23.56024991923416,"zero":0},
{"x":132,"trend":-22.64420263598381,"cycle":0.5856723416967071,"orig":-22.058530294287102,"zero":0},
{"x":133,"trend":-22.931118802308443,"cycle":2.040396592166722,"orig":-20.89072221014172,"zero":0},
{"x":134,"trend":-23.694407761346184,"cycle":3.248887870707307,"orig":-20.445519890638877,"zero":0},
{"x":135,"trend":-23.56447929788333,"cycle":3.401313061373468,"orig":-20.163166236509863,"zero":0},
{"x":136,"trend":-23.651586280540904,"cycle":2.6269387060144815,"orig":-21.024647574526423,"zero":0},
{"x":137,"trend":-24.146021963659447,"cycle":3.9142002847227353,"orig":-20.23182167893671,"zero":0},
{"x":138,"trend":-23.97012869985241,"cycle":2.8166415049351237,"orig":-21.153487194917286,"zero":0},
{"x":139,"trend":-23.116473381694902,"cycle":2.683688574708576,"orig":-20.432784806986326,"zero":0},
{"x":140,"trend":-21.92816535730968,"cycle":1.4610537243577788,"orig":-20.4671116329519,"zero":0},
{"x":141,"trend":-21.15126485816802,"cycle":0.5192347784767541,"orig":-20.632030079691265,"zero":0},
{"x":142,"trend":-20.855089634967996,"cycle":-0.5955353187731482,"orig":-21.450624953741144,"zero":0},
{"x":143,"trend":-20.43388792173305,"cycle":-2.2820028884214665,"orig":-22.715890810154516,"zero":0},
{"x":144,"trend":-21.0445810540483,"cycle":-2.4184912419397264,"orig":-23.463072295988027,"zero":0},
{"x":145,"trend":-20.116736154495083,"cycle":-3.8752908915231323,"orig":-23.992027046018215,"zero":0},
{"x":146,"trend":-20.917720722551955,"cycle":-2.3256130375955877,"orig":-23.243333760147543,"zero":0},
{"x":147,"trend":-20.41301779400915,"cycle":-3.6740636479272766,"orig":-24.087081441936427,"zero":0},
{"x":148,"trend":-20.256751864725558,"cycle":-3.5720024102473644,"orig":-23.828754274972923,"zero":0},
{"x":149,"trend":-20.702099672772977,"cycle":-3.521556511301437,"orig":-24.223656184074414,"zero":0},
{"x":150,"trend":-21.261618164609747,"cycle":-3.7502450789831485,"orig":-25.011863243592895,"zero":0},
{"x":151,"trend":-22.304784899684456,"cycle":-3.2054564355577284,"orig":-25.510241335242185,"zero":0},
{"x":152,"trend":-22.76364659062984,"cycle":-1.92263791003705,"orig":-24.68628450066689,"zero":0},
{"x":153,"trend":-23.19816823256736,"cycle":0.3115834895899354,"orig":-22.886584742977426,"zero":0},
{"x":154,"trend":-22.646018132645807,"cycle":0.26496499987496946,"orig":-22.381053132770838,"zero":0},
{"x":155,"trend":-23.6485435791149,"cycle":1.905505972439574,"orig":-21.743037606675326,"zero":0},
{"x":156,"trend":-23.49887254781627,"cycle":2.536685367946376,"orig":-20.962187179869893,"zero":0},
{"x":157,"trend":-23.629555902168637,"cycle":3.206115384894222,"orig":-20.423440517274415,"zero":0},
{"x":158,"trend":-24.52984061295444,"cycle":3.8377532439433573,"orig":-20.692087369011084,"zero":0},
{"x":159,"trend":-24.77390096499036,"cycle":2.215469073988423,"orig":-22.558431891001938,"zero":0},
{"x":160,"trend":-23.94684358320206,"cycle":0.9623482076268743,"orig":-22.984495375575186,"zero":0},
{"x":161,"trend":-22.53016001217049,"cycle":-1.2260920351113533,"orig":-23.756252047281844,"zero":0},
{"x":162,"trend":-22.527095959678544,"cycle":-0.9449867421355727,"orig":-23.472082701814116,"zero":0},
{"x":163,"trend":-22.01612854752505,"cycle":-0.840031139842111,"orig":-22.85615968736716,"zero":0},
{"x":164,"trend":-21.017213797022563,"cycle":-3.0693935193033077,"orig":-24.08660731632587,"zero":0},
{"x":165,"trend":-20.58200946358442,"cycle":-3.4800728201009647,"orig":-24.062082283685385,"zero":0},
{"x":166,"trend":-20.84347769083312,"cycle":-2.687067431033821,"orig":-23.53054512186694,"zero":0},
{"x":167,"trend":-22.40653418662616,"cycle":1.7999781873162952,"orig":-20.606555999309865,"zero":0},
{"x":168,"trend":-22.37933683139735,"cycle":1.949690473125024,"orig":-20.429646358272326,"zero":0},
{"x":169,"trend":-22.88683477696368,"cycle":1.562773773381302,"orig":-21.32406100358238,"zero":0},
{"x":170,"trend":-22.907190950874774,"cycle":0.6905283649567018,"orig":-22.216662585918073,"zero":0},
{"x":171,"trend":-22.392241730128795,"cycle":-0.07357964118619975,"orig":-22.465821371314995,"zero":0},
{"x":172,"trend":-23.830104795581597,"cycle":2.195531126264374,"orig":-21.634573669317223,"zero":0},
{"x":173,"trend":-23.63536164977838,"cycle":0.6668763386132497,"orig":-22.96848531116513,"zero":0},
{"x":174,"trend":-22.86484104181032,"cycle":1.0684594707987394,"orig":-21.79638157101158,"zero":0},
{"x":175,"trend":-20.53048947567078,"cycle":-0.6509513613110514,"orig":-21.18144083698183,"zero":0},
{"x":176,"trend":-20.834198943654496,"cycle":-0.35157700977168815,"orig":-21.185775953426184,"zero":0},
{"x":177,"trend":-21.887616950825855,"cycle":0.5612797509888949,"orig":-21.32633719983696,"zero":0},
{"x":178,"trend":-21.916818935126287,"cycle":1.2538407867944024,"orig":-20.662978148331884,"zero":0},
{"x":179,"trend":-21.87910931277649,"cycle":1.689390201933687,"orig":-20.189719110842802,"zero":0},
{"x":180,"trend":-21.186584597333542,"cycle":2.263390661728401,"orig":-18.92319393560514,"zero":0},
{"x":181,"trend":-22.71933362429663,"cycle":4.179689521042384,"orig":-18.539644103254247,"zero":0},
{"x":182,"trend":-21.599180466952614,"cycle":3.3925259661347447,"orig":-18.20665450081787,"zero":0},
{"x":183,"trend":-20.85156634447415,"cycle":2.193441039521044,"orig":-18.658125304953106,"zero":0},
{"x":184,"trend":-21.387965831038933,"cycle":4.087834467726633,"orig":-17.3001313633123,"zero":0},
{"x":185,"trend":-21.309850981025228,"cycle":3.2297450931418616,"orig":-18.080105887883366,"zero":0},
{"x":186,"trend":-20.531543243700227,"cycle":3.451965564905283,"orig":-17.079577678794944,"zero":0},
{"x":187,"trend":-20.173294517924298,"cycle":1.392982456480226,"orig":-18.78031206144407,"zero":0},
{"x":188,"trend":-19.177089926044978,"cycle":0.040886700730382586,"orig":-19.136203225314595,"zero":0},
{"x":189,"trend":-18.898377631817645,"cycle":1.2686434501329273,"orig":-17.629734181684718,"zero":0},
{"x":190,"trend":-18.6750447126865,"cycle":0.1775374015694844,"orig":-18.497507311117015,"zero":0},
{"x":191,"trend":-18.883830458299425,"cycle":1.4221249942832621,"orig":-17.461705464016163,"zero":0},
{"x":192,"trend":-17.511862692029396,"cycle":-1.0571811583007467,"orig":-18.569043850330143,"zero":0},
{"x":193,"trend":-18.295763707853492,"cycle":0.3839013513214482,"orig":-17.911862356532044,"zero":0},
{"x":194,"trend":-17.519104934678058,"cycle":1.2442509290963635,"orig":-16.274854005581695,"zero":0},
{"x":195,"trend":-18.825099008267493,"cycle":4.201980751005291,"orig":-14.623118257262202,"zero":0},
{"x":196,"trend":-19.209177923499368,"cycle":4.421885487878917,"orig":-14.78729243562045,"zero":0},
{"x":197,"trend":-17.340642601024662,"cycle":2.1049631467610066,"orig":-15.235679454263655,"zero":0},
{"x":198,"trend":-18.71658741378982,"cycle":2.2277072619476392,"orig":-16.48888015184218,"zero":0},
{"x":199,"trend":-17.889000120552275,"cycle":1.6887890107188888,"orig":-16.200211109833386,"zero":0},
{"x":200,"trend":-18.606789262702648,"cycle":3.793604776199004,"orig":-14.813184486503644,"zero":0}];
    const series = [{"name":"Cycle","color":"#2ca02c","key":"cycle","dash":""}];
    const bands = [];
    const refLines = [{"value":0,"color":"#999","dash":"4,3"}];

    const container = d3.select('#filt_cy_64');
    const W = Math.max(container.node().clientWidth - 24, 280);
    const margin = {top:10, right:15, bottom:35, left:55};
    const w = W - margin.left - margin.right;
    const h = Math.min(w * 0.6, 250);

    const svg = container.append('svg').attr('width', W).attr('height', h + margin.top + margin.bottom);
    const g = svg.append('g').attr('transform', 'translate('+margin.left+','+margin.top+')');

    // Compute domains
    const xVals = data.map(d => d.x);
    const allYVals = [];
    series.forEach(s => data.forEach(d => { if(d[s.key]!==null) allYVals.push(d[s.key]); }));
    bands.forEach(b => data.forEach(d => {
        if(d[b.lo_key]!==null) allYVals.push(d[b.lo_key]);
        if(d[b.hi_key]!==null) allYVals.push(d[b.hi_key]);
    }));
    refLines.forEach(r => allYVals.push(r.value));

    const x = d3.scaleLinear().domain(d3.extent(xVals)).range([0,w]);
    const yExt = d3.extent(allYVals);
    const yPad = (yExt[1]-yExt[0])*0.08 || 1;
    const y = d3.scaleLinear().domain([yExt[0]-yPad, yExt[1]+yPad]).range([h,0]);

    // Grid
    g.append('g').attr('class','grid').call(d3.axisLeft(y).tickSize(-w).tickFormat(''));

    // Bands
    bands.forEach(b => {
        const area = d3.area()
            .x(d => x(d.x))
            .y0(d => y(d[b.lo_key]!==null ? d[b.lo_key] : 0))
            .y1(d => y(d[b.hi_key]!==null ? d[b.hi_key] : 0))
            .defined(d => d[b.lo_key]!==null && d[b.hi_key]!==null);
        g.append('path').datum(data).attr('d',area)
            .attr('fill',b.color).attr('opacity',b.alpha||0.15);
    });

    // Reference lines
    refLines.forEach(r => {
        g.append('line').attr('x1',0).attr('x2',w)
            .attr('y1',y(r.value)).attr('y2',y(r.value))
            .attr('stroke',r.color||'#999').attr('stroke-width',1)
            .attr('stroke-dasharray',r.dash||'4,3');
    });

    // Lines
    series.forEach(s => {
        const line = d3.line().x(d=>x(d.x)).y(d=>y(d[s.key]))
            .defined(d=>d[s.key]!==null);
        g.append('path').datum(data).attr('d',line)
            .attr('fill','none').attr('stroke',s.color).attr('stroke-width',1.8)
            .attr('stroke-dasharray',s.dash||'');
    });

    // Axes
    g.append('g').attr('class','axis').attr('transform','translate(0,'+h+')')
        .call(d3.axisBottom(x).ticks(Math.min(xVals.length,8)));
    g.append('g').attr('class','axis').call(d3.axisLeft(y).ticks(6));

    if('Period') g.append('text').attr('x',w/2).attr('y',h+30).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Period');
    if('Cycle') g.append('text').attr('transform','rotate(-90)')
        .attr('x',-h/2).attr('y',-42).attr('text-anchor','middle')
        .attr('font-size','11px').attr('fill','#666').text('Cycle');

    // Legend
    if(series.length > 1) {
        const leg = g.append('g').attr('class','legend').attr('transform','translate(5,-5)');
        series.forEach((s,i) => {
            const gi = leg.append('g').attr('transform','translate('+(i*100)+',0)');
            gi.append('line').attr('x1',0).attr('x2',16).attr('y1',0).attr('y2',0)
                .attr('stroke',s.color).attr('stroke-width',2)
                .attr('stroke-dasharray',s.dash||'');
            gi.append('text').attr('x',20).attr('y',4).attr('font-size','10px')
                .attr('fill','#555').text(s.name);
        });
    }

    // Tooltip overlay
    svg.append('rect').attr('width',W).attr('height',h+margin.top+margin.bottom)
        .attr('fill','none').attr('pointer-events','all')
        .on('mousemove', function(evt) {
            const [mx] = d3.pointer(evt, g.node());
            const x0 = x.invert(mx);
            const idx = d3.minIndex(data, d => Math.abs(d.x - x0));
            const d = data[idx];
            let html = '<b>x='+fmt(d.x)+'</b>';
            series.forEach(s => { if(d[s.key]!==null) html += '<br>'+s.name+': '+fmt(d[s.key]); });
            showTip(evt, html);
        })
        .on('mouseout', hideTip);
})();

</script>
</body>
</html>